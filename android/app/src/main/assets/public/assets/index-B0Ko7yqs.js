function pp(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Xe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mp(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function gp(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var r=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(n){var s=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return t[n]}})}),r}var od={exports:{}},Wi={},ld={exports:{}},K={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bs=Symbol.for("react.element"),yp=Symbol.for("react.portal"),xp=Symbol.for("react.fragment"),vp=Symbol.for("react.strict_mode"),wp=Symbol.for("react.profiler"),bp=Symbol.for("react.provider"),_p=Symbol.for("react.context"),jp=Symbol.for("react.forward_ref"),kp=Symbol.for("react.suspense"),Np=Symbol.for("react.memo"),Sp=Symbol.for("react.lazy"),xc=Symbol.iterator;function Ep(t){return t===null||typeof t!="object"?null:(t=xc&&t[xc]||t["@@iterator"],typeof t=="function"?t:null)}var cd={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ud=Object.assign,dd={};function wn(t,e,r){this.props=t,this.context=e,this.refs=dd,this.updater=r||cd}wn.prototype.isReactComponent={};wn.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};wn.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function hd(){}hd.prototype=wn.prototype;function ol(t,e,r){this.props=t,this.context=e,this.refs=dd,this.updater=r||cd}var ll=ol.prototype=new hd;ll.constructor=ol;ud(ll,wn.prototype);ll.isPureReactComponent=!0;var vc=Array.isArray,fd=Object.prototype.hasOwnProperty,cl={current:null},pd={key:!0,ref:!0,__self:!0,__source:!0};function md(t,e,r){var n,s={},a=null,o=null;if(e!=null)for(n in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(a=""+e.key),e)fd.call(e,n)&&!pd.hasOwnProperty(n)&&(s[n]=e[n]);var l=arguments.length-2;if(l===1)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(n in l=t.defaultProps,l)s[n]===void 0&&(s[n]=l[n]);return{$$typeof:bs,type:t,key:a,ref:o,props:s,_owner:cl.current}}function Cp(t,e){return{$$typeof:bs,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ul(t){return typeof t=="object"&&t!==null&&t.$$typeof===bs}function Pp(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var wc=/\/+/g;function ga(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Pp(""+t.key):e.toString(36)}function Ys(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case bs:case yp:o=!0}}if(o)return o=t,s=s(o),t=n===""?"."+ga(o,0):n,vc(s)?(r="",t!=null&&(r=t.replace(wc,"$&/")+"/"),Ys(s,e,r,"",function(u){return u})):s!=null&&(ul(s)&&(s=Cp(s,r+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(wc,"$&/")+"/")+t)),e.push(s)),1;if(o=0,n=n===""?".":n+":",vc(t))for(var l=0;l<t.length;l++){a=t[l];var c=n+ga(a,l);o+=Ys(a,e,r,c,s)}else if(c=Ep(t),typeof c=="function")for(t=c.call(t),l=0;!(a=t.next()).done;)a=a.value,c=n+ga(a,l++),o+=Ys(a,e,r,c,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ps(t,e,r){if(t==null)return t;var n=[],s=0;return Ys(t,n,"","",function(a){return e.call(r,a,s++)}),n}function Tp(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Te={current:null},Xs={transition:null},Rp={ReactCurrentDispatcher:Te,ReactCurrentBatchConfig:Xs,ReactCurrentOwner:cl};function gd(){throw Error("act(...) is not supported in production builds of React.")}K.Children={map:Ps,forEach:function(t,e,r){Ps(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Ps(t,function(){e++}),e},toArray:function(t){return Ps(t,function(e){return e})||[]},only:function(t){if(!ul(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};K.Component=wn;K.Fragment=xp;K.Profiler=wp;K.PureComponent=ol;K.StrictMode=vp;K.Suspense=kp;K.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Rp;K.act=gd;K.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=ud({},t.props),s=t.key,a=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,o=cl.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)fd.call(e,c)&&!pd.hasOwnProperty(c)&&(n[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:bs,type:t.type,key:s,ref:a,props:n,_owner:o}};K.createContext=function(t){return t={$$typeof:_p,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:bp,_context:t},t.Consumer=t};K.createElement=md;K.createFactory=function(t){var e=md.bind(null,t);return e.type=t,e};K.createRef=function(){return{current:null}};K.forwardRef=function(t){return{$$typeof:jp,render:t}};K.isValidElement=ul;K.lazy=function(t){return{$$typeof:Sp,_payload:{_status:-1,_result:t},_init:Tp}};K.memo=function(t,e){return{$$typeof:Np,type:t,compare:e===void 0?null:e}};K.startTransition=function(t){var e=Xs.transition;Xs.transition={};try{t()}finally{Xs.transition=e}};K.unstable_act=gd;K.useCallback=function(t,e){return Te.current.useCallback(t,e)};K.useContext=function(t){return Te.current.useContext(t)};K.useDebugValue=function(){};K.useDeferredValue=function(t){return Te.current.useDeferredValue(t)};K.useEffect=function(t,e){return Te.current.useEffect(t,e)};K.useId=function(){return Te.current.useId()};K.useImperativeHandle=function(t,e,r){return Te.current.useImperativeHandle(t,e,r)};K.useInsertionEffect=function(t,e){return Te.current.useInsertionEffect(t,e)};K.useLayoutEffect=function(t,e){return Te.current.useLayoutEffect(t,e)};K.useMemo=function(t,e){return Te.current.useMemo(t,e)};K.useReducer=function(t,e,r){return Te.current.useReducer(t,e,r)};K.useRef=function(t){return Te.current.useRef(t)};K.useState=function(t){return Te.current.useState(t)};K.useSyncExternalStore=function(t,e,r){return Te.current.useSyncExternalStore(t,e,r)};K.useTransition=function(){return Te.current.useTransition()};K.version="18.3.1";ld.exports=K;var b=ld.exports;const Op=mp(b),Ap=pp({__proto__:null,default:Op},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ip=b,Lp=Symbol.for("react.element"),$p=Symbol.for("react.fragment"),Dp=Object.prototype.hasOwnProperty,Up=Ip.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Mp={key:!0,ref:!0,__self:!0,__source:!0};function yd(t,e,r){var n,s={},a=null,o=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(o=e.ref);for(n in e)Dp.call(e,n)&&!Mp.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:Lp,type:t,key:a,ref:o,props:s,_owner:Up.current}}Wi.Fragment=$p;Wi.jsx=yd;Wi.jsxs=yd;od.exports=Wi;var i=od.exports,xd={exports:{}},We={},vd={exports:{}},wd={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(I,F){var W=I.length;I.push(F);e:for(;0<W;){var re=W-1>>>1,ue=I[re];if(0<s(ue,F))I[re]=F,I[W]=ue,W=re;else break e}}function r(I){return I.length===0?null:I[0]}function n(I){if(I.length===0)return null;var F=I[0],W=I.pop();if(W!==F){I[0]=W;e:for(var re=0,ue=I.length,L=ue>>>1;re<L;){var z=2*(re+1)-1,de=I[z],X=z+1,_e=I[X];if(0>s(de,W))X<ue&&0>s(_e,de)?(I[re]=_e,I[X]=W,re=X):(I[re]=de,I[z]=W,re=z);else if(X<ue&&0>s(_e,W))I[re]=_e,I[X]=W,re=X;else break e}}return F}function s(I,F){var W=I.sortIndex-F.sortIndex;return W!==0?W:I.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,d=null,f=3,x=!1,v=!1,_=!1,k=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(I){for(var F=r(u);F!==null;){if(F.callback===null)n(u);else if(F.startTime<=I)n(u),F.sortIndex=F.expirationTime,e(c,F);else break;F=r(u)}}function y(I){if(_=!1,m(I),!v)if(r(c)!==null)v=!0,P(E);else{var F=r(u);F!==null&&U(y,F.startTime-I)}}function E(I,F){v=!1,_&&(_=!1,g(C),C=-1),x=!0;var W=f;try{for(m(F),d=r(c);d!==null&&(!(d.expirationTime>F)||I&&!D());){var re=d.callback;if(typeof re=="function"){d.callback=null,f=d.priorityLevel;var ue=re(d.expirationTime<=F);F=t.unstable_now(),typeof ue=="function"?d.callback=ue:d===r(c)&&n(c),m(F)}else n(c);d=r(c)}if(d!==null)var L=!0;else{var z=r(u);z!==null&&U(y,z.startTime-F),L=!1}return L}finally{d=null,f=W,x=!1}}var w=!1,N=null,C=-1,T=5,S=-1;function D(){return!(t.unstable_now()-S<T)}function M(){if(N!==null){var I=t.unstable_now();S=I;var F=!0;try{F=N(!0,I)}finally{F?j():(w=!1,N=null)}}else w=!1}var j;if(typeof p=="function")j=function(){p(M)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,R=O.port2;O.port1.onmessage=M,j=function(){R.postMessage(null)}}else j=function(){k(M,0)};function P(I){N=I,w||(w=!0,j())}function U(I,F){C=k(function(){I(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(I){I.callback=null},t.unstable_continueExecution=function(){v||x||(v=!0,P(E))},t.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<I?Math.floor(1e3/I):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(I){switch(f){case 1:case 2:case 3:var F=3;break;default:F=f}var W=f;f=F;try{return I()}finally{f=W}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(I,F){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var W=f;f=I;try{return F()}finally{f=W}},t.unstable_scheduleCallback=function(I,F,W){var re=t.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?re+W:re):W=re,I){case 1:var ue=-1;break;case 2:ue=250;break;case 5:ue=1073741823;break;case 4:ue=1e4;break;default:ue=5e3}return ue=W+ue,I={id:h++,callback:F,priorityLevel:I,startTime:W,expirationTime:ue,sortIndex:-1},W>re?(I.sortIndex=W,e(u,I),r(c)===null&&I===r(u)&&(_?(g(C),C=-1):_=!0,U(y,W-re))):(I.sortIndex=ue,e(c,I),v||x||(v=!0,P(E))),I},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(I){var F=f;return function(){var W=f;f=F;try{return I.apply(this,arguments)}finally{f=W}}}})(wd);vd.exports=wd;var Fp=vd.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bp=b,qe=Fp;function $(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bd=new Set,Xn={};function Cr(t,e){cn(t,e),cn(t+"Capture",e)}function cn(t,e){for(Xn[t]=e,t=0;t<e.length;t++)bd.add(e[t])}var Pt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eo=Object.prototype.hasOwnProperty,zp=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bc={},_c={};function qp(t){return eo.call(_c,t)?!0:eo.call(bc,t)?!1:zp.test(t)?_c[t]=!0:(bc[t]=!0,!1)}function Wp(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Vp(t,e,r,n){if(e===null||typeof e>"u"||Wp(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Re(t,e,r,n,s,a,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=o}var be={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){be[t]=new Re(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];be[e]=new Re(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){be[t]=new Re(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){be[t]=new Re(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){be[t]=new Re(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){be[t]=new Re(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){be[t]=new Re(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){be[t]=new Re(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){be[t]=new Re(t,5,!1,t.toLowerCase(),null,!1,!1)});var dl=/[\-:]([a-z])/g;function hl(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(dl,hl);be[e]=new Re(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(dl,hl);be[e]=new Re(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(dl,hl);be[e]=new Re(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){be[t]=new Re(t,1,!1,t.toLowerCase(),null,!1,!1)});be.xlinkHref=new Re("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){be[t]=new Re(t,1,!1,t.toLowerCase(),null,!0,!0)});function fl(t,e,r,n){var s=be.hasOwnProperty(e)?be[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Vp(e,r,s,n)&&(r=null),n||s===null?qp(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var At=Bp.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ts=Symbol.for("react.element"),Wr=Symbol.for("react.portal"),Vr=Symbol.for("react.fragment"),pl=Symbol.for("react.strict_mode"),to=Symbol.for("react.profiler"),_d=Symbol.for("react.provider"),jd=Symbol.for("react.context"),ml=Symbol.for("react.forward_ref"),ro=Symbol.for("react.suspense"),no=Symbol.for("react.suspense_list"),gl=Symbol.for("react.memo"),Bt=Symbol.for("react.lazy"),kd=Symbol.for("react.offscreen"),jc=Symbol.iterator;function Sn(t){return t===null||typeof t!="object"?null:(t=jc&&t[jc]||t["@@iterator"],typeof t=="function"?t:null)}var ae=Object.assign,ya;function Ln(t){if(ya===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);ya=e&&e[1]||""}return`
`+ya+t}var xa=!1;function va(t,e){if(!t||xa)return"";xa=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),o=s.length-1,l=a.length-1;1<=o&&0<=l&&s[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==a[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{xa=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ln(t):""}function Hp(t){switch(t.tag){case 5:return Ln(t.type);case 16:return Ln("Lazy");case 13:return Ln("Suspense");case 19:return Ln("SuspenseList");case 0:case 2:case 15:return t=va(t.type,!1),t;case 11:return t=va(t.type.render,!1),t;case 1:return t=va(t.type,!0),t;default:return""}}function so(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Vr:return"Fragment";case Wr:return"Portal";case to:return"Profiler";case pl:return"StrictMode";case ro:return"Suspense";case no:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case jd:return(t.displayName||"Context")+".Consumer";case _d:return(t._context.displayName||"Context")+".Provider";case ml:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case gl:return e=t.displayName||null,e!==null?e:so(t.type)||"Memo";case Bt:e=t._payload,t=t._init;try{return so(t(e))}catch{}}return null}function Kp(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return so(e);case 8:return e===pl?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function sr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Nd(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Gp(t){var e=Nd(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Rs(t){t._valueTracker||(t._valueTracker=Gp(t))}function Sd(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Nd(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function ui(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function io(t,e){var r=e.checked;return ae({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function kc(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=sr(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Ed(t,e){e=e.checked,e!=null&&fl(t,"checked",e,!1)}function ao(t,e){Ed(t,e);var r=sr(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?oo(t,e.type,r):e.hasOwnProperty("defaultValue")&&oo(t,e.type,sr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Nc(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function oo(t,e,r){(e!=="number"||ui(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var $n=Array.isArray;function rn(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+sr(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function lo(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error($(91));return ae({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Sc(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error($(92));if($n(r)){if(1<r.length)throw Error($(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:sr(r)}}function Cd(t,e){var r=sr(e.value),n=sr(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function Ec(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Pd(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function co(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Pd(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Os,Td=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Os=Os||document.createElement("div"),Os.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Os.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Zn(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Fn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qp=["Webkit","ms","Moz","O"];Object.keys(Fn).forEach(function(t){Qp.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fn[e]=Fn[t]})});function Rd(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Fn.hasOwnProperty(t)&&Fn[t]?(""+e).trim():e+"px"}function Od(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=Rd(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var Jp=ae({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uo(t,e){if(e){if(Jp[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error($(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error($(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error($(61))}if(e.style!=null&&typeof e.style!="object")throw Error($(62))}}function ho(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var fo=null;function yl(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var po=null,nn=null,sn=null;function Cc(t){if(t=ks(t)){if(typeof po!="function")throw Error($(280));var e=t.stateNode;e&&(e=Qi(e),po(t.stateNode,t.type,e))}}function Ad(t){nn?sn?sn.push(t):sn=[t]:nn=t}function Id(){if(nn){var t=nn,e=sn;if(sn=nn=null,Cc(t),e)for(t=0;t<e.length;t++)Cc(e[t])}}function Ld(t,e){return t(e)}function $d(){}var wa=!1;function Dd(t,e,r){if(wa)return t(e,r);wa=!0;try{return Ld(t,e,r)}finally{wa=!1,(nn!==null||sn!==null)&&($d(),Id())}}function es(t,e){var r=t.stateNode;if(r===null)return null;var n=Qi(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error($(231,e,typeof r));return r}var mo=!1;if(Pt)try{var En={};Object.defineProperty(En,"passive",{get:function(){mo=!0}}),window.addEventListener("test",En,En),window.removeEventListener("test",En,En)}catch{mo=!1}function Yp(t,e,r,n,s,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(h){this.onError(h)}}var Bn=!1,di=null,hi=!1,go=null,Xp={onError:function(t){Bn=!0,di=t}};function Zp(t,e,r,n,s,a,o,l,c){Bn=!1,di=null,Yp.apply(Xp,arguments)}function em(t,e,r,n,s,a,o,l,c){if(Zp.apply(this,arguments),Bn){if(Bn){var u=di;Bn=!1,di=null}else throw Error($(198));hi||(hi=!0,go=u)}}function Pr(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function Ud(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Pc(t){if(Pr(t)!==t)throw Error($(188))}function tm(t){var e=t.alternate;if(!e){if(e=Pr(t),e===null)throw Error($(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return Pc(s),t;if(a===n)return Pc(s),e;a=a.sibling}throw Error($(188))}if(r.return!==n.return)r=s,n=a;else{for(var o=!1,l=s.child;l;){if(l===r){o=!0,r=s,n=a;break}if(l===n){o=!0,n=s,r=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===r){o=!0,r=a,n=s;break}if(l===n){o=!0,n=a,r=s;break}l=l.sibling}if(!o)throw Error($(189))}}if(r.alternate!==n)throw Error($(190))}if(r.tag!==3)throw Error($(188));return r.stateNode.current===r?t:e}function Md(t){return t=tm(t),t!==null?Fd(t):null}function Fd(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Fd(t);if(e!==null)return e;t=t.sibling}return null}var Bd=qe.unstable_scheduleCallback,Tc=qe.unstable_cancelCallback,rm=qe.unstable_shouldYield,nm=qe.unstable_requestPaint,ce=qe.unstable_now,sm=qe.unstable_getCurrentPriorityLevel,xl=qe.unstable_ImmediatePriority,zd=qe.unstable_UserBlockingPriority,fi=qe.unstable_NormalPriority,im=qe.unstable_LowPriority,qd=qe.unstable_IdlePriority,Vi=null,xt=null;function am(t){if(xt&&typeof xt.onCommitFiberRoot=="function")try{xt.onCommitFiberRoot(Vi,t,void 0,(t.current.flags&128)===128)}catch{}}var lt=Math.clz32?Math.clz32:cm,om=Math.log,lm=Math.LN2;function cm(t){return t>>>=0,t===0?32:31-(om(t)/lm|0)|0}var As=64,Is=4194304;function Dn(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function pi(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,o=r&268435455;if(o!==0){var l=o&~s;l!==0?n=Dn(l):(a&=o,a!==0&&(n=Dn(a)))}else o=r&~s,o!==0?n=Dn(o):a!==0&&(n=Dn(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-lt(e),s=1<<r,n|=t[r],e&=~s;return n}function um(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dm(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var o=31-lt(a),l=1<<o,c=s[o];c===-1?(!(l&r)||l&n)&&(s[o]=um(l,e)):c<=e&&(t.expiredLanes|=l),a&=~l}}function yo(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Wd(){var t=As;return As<<=1,!(As&4194240)&&(As=64),t}function ba(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function _s(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-lt(e),t[e]=r}function hm(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-lt(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function vl(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-lt(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Q=0;function Vd(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Hd,wl,Kd,Gd,Qd,xo=!1,Ls=[],Qt=null,Jt=null,Yt=null,ts=new Map,rs=new Map,qt=[],fm="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rc(t,e){switch(t){case"focusin":case"focusout":Qt=null;break;case"dragenter":case"dragleave":Jt=null;break;case"mouseover":case"mouseout":Yt=null;break;case"pointerover":case"pointerout":ts.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":rs.delete(e.pointerId)}}function Cn(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=ks(e),e!==null&&wl(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function pm(t,e,r,n,s){switch(e){case"focusin":return Qt=Cn(Qt,t,e,r,n,s),!0;case"dragenter":return Jt=Cn(Jt,t,e,r,n,s),!0;case"mouseover":return Yt=Cn(Yt,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return ts.set(a,Cn(ts.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,rs.set(a,Cn(rs.get(a)||null,t,e,r,n,s)),!0}return!1}function Jd(t){var e=gr(t.target);if(e!==null){var r=Pr(e);if(r!==null){if(e=r.tag,e===13){if(e=Ud(r),e!==null){t.blockedOn=e,Qd(t.priority,function(){Kd(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Zs(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=vo(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);fo=n,r.target.dispatchEvent(n),fo=null}else return e=ks(r),e!==null&&wl(e),t.blockedOn=r,!1;e.shift()}return!0}function Oc(t,e,r){Zs(t)&&r.delete(e)}function mm(){xo=!1,Qt!==null&&Zs(Qt)&&(Qt=null),Jt!==null&&Zs(Jt)&&(Jt=null),Yt!==null&&Zs(Yt)&&(Yt=null),ts.forEach(Oc),rs.forEach(Oc)}function Pn(t,e){t.blockedOn===e&&(t.blockedOn=null,xo||(xo=!0,qe.unstable_scheduleCallback(qe.unstable_NormalPriority,mm)))}function ns(t){function e(s){return Pn(s,t)}if(0<Ls.length){Pn(Ls[0],t);for(var r=1;r<Ls.length;r++){var n=Ls[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Qt!==null&&Pn(Qt,t),Jt!==null&&Pn(Jt,t),Yt!==null&&Pn(Yt,t),ts.forEach(e),rs.forEach(e),r=0;r<qt.length;r++)n=qt[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<qt.length&&(r=qt[0],r.blockedOn===null);)Jd(r),r.blockedOn===null&&qt.shift()}var an=At.ReactCurrentBatchConfig,mi=!0;function gm(t,e,r,n){var s=Q,a=an.transition;an.transition=null;try{Q=1,bl(t,e,r,n)}finally{Q=s,an.transition=a}}function ym(t,e,r,n){var s=Q,a=an.transition;an.transition=null;try{Q=4,bl(t,e,r,n)}finally{Q=s,an.transition=a}}function bl(t,e,r,n){if(mi){var s=vo(t,e,r,n);if(s===null)Ra(t,e,n,gi,r),Rc(t,n);else if(pm(s,t,e,r,n))n.stopPropagation();else if(Rc(t,n),e&4&&-1<fm.indexOf(t)){for(;s!==null;){var a=ks(s);if(a!==null&&Hd(a),a=vo(t,e,r,n),a===null&&Ra(t,e,n,gi,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else Ra(t,e,n,null,r)}}var gi=null;function vo(t,e,r,n){if(gi=null,t=yl(n),t=gr(t),t!==null)if(e=Pr(t),e===null)t=null;else if(r=e.tag,r===13){if(t=Ud(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return gi=t,null}function Yd(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sm()){case xl:return 1;case zd:return 4;case fi:case im:return 16;case qd:return 536870912;default:return 16}default:return 16}}var Ht=null,_l=null,ei=null;function Xd(){if(ei)return ei;var t,e=_l,r=e.length,n,s="value"in Ht?Ht.value:Ht.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var o=r-t;for(n=1;n<=o&&e[r-n]===s[a-n];n++);return ei=s.slice(t,1<n?1-n:void 0)}function ti(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function $s(){return!0}function Ac(){return!1}function Ve(t){function e(r,n,s,a,o){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(r=t[l],this[l]=r?r(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?$s:Ac,this.isPropagationStopped=Ac,this}return ae(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=$s)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=$s)},persist:function(){},isPersistent:$s}),e}var bn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jl=Ve(bn),js=ae({},bn,{view:0,detail:0}),xm=Ve(js),_a,ja,Tn,Hi=ae({},js,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kl,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Tn&&(Tn&&t.type==="mousemove"?(_a=t.screenX-Tn.screenX,ja=t.screenY-Tn.screenY):ja=_a=0,Tn=t),_a)},movementY:function(t){return"movementY"in t?t.movementY:ja}}),Ic=Ve(Hi),vm=ae({},Hi,{dataTransfer:0}),wm=Ve(vm),bm=ae({},js,{relatedTarget:0}),ka=Ve(bm),_m=ae({},bn,{animationName:0,elapsedTime:0,pseudoElement:0}),jm=Ve(_m),km=ae({},bn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Nm=Ve(km),Sm=ae({},bn,{data:0}),Lc=Ve(Sm),Em={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Cm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tm(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Pm[t])?!!e[t]:!1}function kl(){return Tm}var Rm=ae({},js,{key:function(t){if(t.key){var e=Em[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ti(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Cm[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kl,charCode:function(t){return t.type==="keypress"?ti(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ti(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Om=Ve(Rm),Am=ae({},Hi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$c=Ve(Am),Im=ae({},js,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kl}),Lm=Ve(Im),$m=ae({},bn,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dm=Ve($m),Um=ae({},Hi,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Mm=Ve(Um),Fm=[9,13,27,32],Nl=Pt&&"CompositionEvent"in window,zn=null;Pt&&"documentMode"in document&&(zn=document.documentMode);var Bm=Pt&&"TextEvent"in window&&!zn,Zd=Pt&&(!Nl||zn&&8<zn&&11>=zn),Dc=" ",Uc=!1;function eh(t,e){switch(t){case"keyup":return Fm.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function th(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Hr=!1;function zm(t,e){switch(t){case"compositionend":return th(e);case"keypress":return e.which!==32?null:(Uc=!0,Dc);case"textInput":return t=e.data,t===Dc&&Uc?null:t;default:return null}}function qm(t,e){if(Hr)return t==="compositionend"||!Nl&&eh(t,e)?(t=Xd(),ei=_l=Ht=null,Hr=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Zd&&e.locale!=="ko"?null:e.data;default:return null}}var Wm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Wm[t.type]:e==="textarea"}function rh(t,e,r,n){Ad(n),e=yi(e,"onChange"),0<e.length&&(r=new jl("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var qn=null,ss=null;function Vm(t){fh(t,0)}function Ki(t){var e=Qr(t);if(Sd(e))return t}function Hm(t,e){if(t==="change")return e}var nh=!1;if(Pt){var Na;if(Pt){var Sa="oninput"in document;if(!Sa){var Fc=document.createElement("div");Fc.setAttribute("oninput","return;"),Sa=typeof Fc.oninput=="function"}Na=Sa}else Na=!1;nh=Na&&(!document.documentMode||9<document.documentMode)}function Bc(){qn&&(qn.detachEvent("onpropertychange",sh),ss=qn=null)}function sh(t){if(t.propertyName==="value"&&Ki(ss)){var e=[];rh(e,ss,t,yl(t)),Dd(Vm,e)}}function Km(t,e,r){t==="focusin"?(Bc(),qn=e,ss=r,qn.attachEvent("onpropertychange",sh)):t==="focusout"&&Bc()}function Gm(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ki(ss)}function Qm(t,e){if(t==="click")return Ki(e)}function Jm(t,e){if(t==="input"||t==="change")return Ki(e)}function Ym(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ut=typeof Object.is=="function"?Object.is:Ym;function is(t,e){if(ut(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!eo.call(e,s)||!ut(t[s],e[s]))return!1}return!0}function zc(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function qc(t,e){var r=zc(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=zc(r)}}function ih(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ih(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ah(){for(var t=window,e=ui();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=ui(t.document)}return e}function Sl(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Xm(t){var e=ah(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&ih(r.ownerDocument.documentElement,r)){if(n!==null&&Sl(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=qc(r,a);var o=qc(r,n);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Zm=Pt&&"documentMode"in document&&11>=document.documentMode,Kr=null,wo=null,Wn=null,bo=!1;function Wc(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;bo||Kr==null||Kr!==ui(n)||(n=Kr,"selectionStart"in n&&Sl(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Wn&&is(Wn,n)||(Wn=n,n=yi(wo,"onSelect"),0<n.length&&(e=new jl("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=Kr)))}function Ds(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var Gr={animationend:Ds("Animation","AnimationEnd"),animationiteration:Ds("Animation","AnimationIteration"),animationstart:Ds("Animation","AnimationStart"),transitionend:Ds("Transition","TransitionEnd")},Ea={},oh={};Pt&&(oh=document.createElement("div").style,"AnimationEvent"in window||(delete Gr.animationend.animation,delete Gr.animationiteration.animation,delete Gr.animationstart.animation),"TransitionEvent"in window||delete Gr.transitionend.transition);function Gi(t){if(Ea[t])return Ea[t];if(!Gr[t])return t;var e=Gr[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in oh)return Ea[t]=e[r];return t}var lh=Gi("animationend"),ch=Gi("animationiteration"),uh=Gi("animationstart"),dh=Gi("transitionend"),hh=new Map,Vc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ar(t,e){hh.set(t,e),Cr(e,[t])}for(var Ca=0;Ca<Vc.length;Ca++){var Pa=Vc[Ca],eg=Pa.toLowerCase(),tg=Pa[0].toUpperCase()+Pa.slice(1);ar(eg,"on"+tg)}ar(lh,"onAnimationEnd");ar(ch,"onAnimationIteration");ar(uh,"onAnimationStart");ar("dblclick","onDoubleClick");ar("focusin","onFocus");ar("focusout","onBlur");ar(dh,"onTransitionEnd");cn("onMouseEnter",["mouseout","mouseover"]);cn("onMouseLeave",["mouseout","mouseover"]);cn("onPointerEnter",["pointerout","pointerover"]);cn("onPointerLeave",["pointerout","pointerover"]);Cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Un="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),rg=new Set("cancel close invalid load scroll toggle".split(" ").concat(Un));function Hc(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,em(n,e,void 0,t),t.currentTarget=null}function fh(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;Hc(s,l,u),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;Hc(s,l,u),a=c}}}if(hi)throw t=go,hi=!1,go=null,t}function Z(t,e){var r=e[So];r===void 0&&(r=e[So]=new Set);var n=t+"__bubble";r.has(n)||(ph(e,t,2,!1),r.add(n))}function Ta(t,e,r){var n=0;e&&(n|=4),ph(r,t,n,e)}var Us="_reactListening"+Math.random().toString(36).slice(2);function as(t){if(!t[Us]){t[Us]=!0,bd.forEach(function(r){r!=="selectionchange"&&(rg.has(r)||Ta(r,!1,t),Ta(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Us]||(e[Us]=!0,Ta("selectionchange",!1,e))}}function ph(t,e,r,n){switch(Yd(e)){case 1:var s=gm;break;case 4:s=ym;break;default:s=bl}r=s.bind(null,e,r,t),s=void 0,!mo||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function Ra(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=gr(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}Dd(function(){var u=a,h=yl(r),d=[];e:{var f=hh.get(t);if(f!==void 0){var x=jl,v=t;switch(t){case"keypress":if(ti(r)===0)break e;case"keydown":case"keyup":x=Om;break;case"focusin":v="focus",x=ka;break;case"focusout":v="blur",x=ka;break;case"beforeblur":case"afterblur":x=ka;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Ic;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=wm;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=Lm;break;case lh:case ch:case uh:x=jm;break;case dh:x=Dm;break;case"scroll":x=xm;break;case"wheel":x=Mm;break;case"copy":case"cut":case"paste":x=Nm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=$c}var _=(e&4)!==0,k=!_&&t==="scroll",g=_?f!==null?f+"Capture":null:f;_=[];for(var p=u,m;p!==null;){m=p;var y=m.stateNode;if(m.tag===5&&y!==null&&(m=y,g!==null&&(y=es(p,g),y!=null&&_.push(os(p,y,m)))),k)break;p=p.return}0<_.length&&(f=new x(f,v,null,r,h),d.push({event:f,listeners:_}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",f&&r!==fo&&(v=r.relatedTarget||r.fromElement)&&(gr(v)||v[Tt]))break e;if((x||f)&&(f=h.window===h?h:(f=h.ownerDocument)?f.defaultView||f.parentWindow:window,x?(v=r.relatedTarget||r.toElement,x=u,v=v?gr(v):null,v!==null&&(k=Pr(v),v!==k||v.tag!==5&&v.tag!==6)&&(v=null)):(x=null,v=u),x!==v)){if(_=Ic,y="onMouseLeave",g="onMouseEnter",p="mouse",(t==="pointerout"||t==="pointerover")&&(_=$c,y="onPointerLeave",g="onPointerEnter",p="pointer"),k=x==null?f:Qr(x),m=v==null?f:Qr(v),f=new _(y,p+"leave",x,r,h),f.target=k,f.relatedTarget=m,y=null,gr(h)===u&&(_=new _(g,p+"enter",v,r,h),_.target=m,_.relatedTarget=k,y=_),k=y,x&&v)t:{for(_=x,g=v,p=0,m=_;m;m=Ir(m))p++;for(m=0,y=g;y;y=Ir(y))m++;for(;0<p-m;)_=Ir(_),p--;for(;0<m-p;)g=Ir(g),m--;for(;p--;){if(_===g||g!==null&&_===g.alternate)break t;_=Ir(_),g=Ir(g)}_=null}else _=null;x!==null&&Kc(d,f,x,_,!1),v!==null&&k!==null&&Kc(d,k,v,_,!0)}}e:{if(f=u?Qr(u):window,x=f.nodeName&&f.nodeName.toLowerCase(),x==="select"||x==="input"&&f.type==="file")var E=Hm;else if(Mc(f))if(nh)E=Jm;else{E=Gm;var w=Km}else(x=f.nodeName)&&x.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(E=Qm);if(E&&(E=E(t,u))){rh(d,E,r,h);break e}w&&w(t,f,u),t==="focusout"&&(w=f._wrapperState)&&w.controlled&&f.type==="number"&&oo(f,"number",f.value)}switch(w=u?Qr(u):window,t){case"focusin":(Mc(w)||w.contentEditable==="true")&&(Kr=w,wo=u,Wn=null);break;case"focusout":Wn=wo=Kr=null;break;case"mousedown":bo=!0;break;case"contextmenu":case"mouseup":case"dragend":bo=!1,Wc(d,r,h);break;case"selectionchange":if(Zm)break;case"keydown":case"keyup":Wc(d,r,h)}var N;if(Nl)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Hr?eh(t,r)&&(C="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(Zd&&r.locale!=="ko"&&(Hr||C!=="onCompositionStart"?C==="onCompositionEnd"&&Hr&&(N=Xd()):(Ht=h,_l="value"in Ht?Ht.value:Ht.textContent,Hr=!0)),w=yi(u,C),0<w.length&&(C=new Lc(C,t,null,r,h),d.push({event:C,listeners:w}),N?C.data=N:(N=th(r),N!==null&&(C.data=N)))),(N=Bm?zm(t,r):qm(t,r))&&(u=yi(u,"onBeforeInput"),0<u.length&&(h=new Lc("onBeforeInput","beforeinput",null,r,h),d.push({event:h,listeners:u}),h.data=N))}fh(d,e)})}function os(t,e,r){return{instance:t,listener:e,currentTarget:r}}function yi(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=es(t,r),a!=null&&n.unshift(os(t,a,s)),a=es(t,e),a!=null&&n.push(os(t,a,s))),t=t.return}return n}function Ir(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Kc(t,e,r,n,s){for(var a=e._reactName,o=[];r!==null&&r!==n;){var l=r,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,s?(c=es(r,a),c!=null&&o.unshift(os(r,c,l))):s||(c=es(r,a),c!=null&&o.push(os(r,c,l)))),r=r.return}o.length!==0&&t.push({event:e,listeners:o})}var ng=/\r\n?/g,sg=/\u0000|\uFFFD/g;function Gc(t){return(typeof t=="string"?t:""+t).replace(ng,`
`).replace(sg,"")}function Ms(t,e,r){if(e=Gc(e),Gc(t)!==e&&r)throw Error($(425))}function xi(){}var _o=null,jo=null;function ko(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var No=typeof setTimeout=="function"?setTimeout:void 0,ig=typeof clearTimeout=="function"?clearTimeout:void 0,Qc=typeof Promise=="function"?Promise:void 0,ag=typeof queueMicrotask=="function"?queueMicrotask:typeof Qc<"u"?function(t){return Qc.resolve(null).then(t).catch(og)}:No;function og(t){setTimeout(function(){throw t})}function Oa(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),ns(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);ns(e)}function Xt(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Jc(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var _n=Math.random().toString(36).slice(2),gt="__reactFiber$"+_n,ls="__reactProps$"+_n,Tt="__reactContainer$"+_n,So="__reactEvents$"+_n,lg="__reactListeners$"+_n,cg="__reactHandles$"+_n;function gr(t){var e=t[gt];if(e)return e;for(var r=t.parentNode;r;){if(e=r[Tt]||r[gt]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Jc(t);t!==null;){if(r=t[gt])return r;t=Jc(t)}return e}t=r,r=t.parentNode}return null}function ks(t){return t=t[gt]||t[Tt],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Qr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error($(33))}function Qi(t){return t[ls]||null}var Eo=[],Jr=-1;function or(t){return{current:t}}function ee(t){0>Jr||(t.current=Eo[Jr],Eo[Jr]=null,Jr--)}function Y(t,e){Jr++,Eo[Jr]=t.current,t.current=e}var ir={},Se=or(ir),$e=or(!1),br=ir;function un(t,e){var r=t.type.contextTypes;if(!r)return ir;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function De(t){return t=t.childContextTypes,t!=null}function vi(){ee($e),ee(Se)}function Yc(t,e,r){if(Se.current!==ir)throw Error($(168));Y(Se,e),Y($e,r)}function mh(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error($(108,Kp(t)||"Unknown",s));return ae({},r,n)}function wi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ir,br=Se.current,Y(Se,t),Y($e,$e.current),!0}function Xc(t,e,r){var n=t.stateNode;if(!n)throw Error($(169));r?(t=mh(t,e,br),n.__reactInternalMemoizedMergedChildContext=t,ee($e),ee(Se),Y(Se,t)):ee($e),Y($e,r)}var kt=null,Ji=!1,Aa=!1;function gh(t){kt===null?kt=[t]:kt.push(t)}function ug(t){Ji=!0,gh(t)}function lr(){if(!Aa&&kt!==null){Aa=!0;var t=0,e=Q;try{var r=kt;for(Q=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}kt=null,Ji=!1}catch(s){throw kt!==null&&(kt=kt.slice(t+1)),Bd(xl,lr),s}finally{Q=e,Aa=!1}}return null}var Yr=[],Xr=0,bi=null,_i=0,He=[],Ke=0,_r=null,Nt=1,St="";function hr(t,e){Yr[Xr++]=_i,Yr[Xr++]=bi,bi=t,_i=e}function yh(t,e,r){He[Ke++]=Nt,He[Ke++]=St,He[Ke++]=_r,_r=t;var n=Nt;t=St;var s=32-lt(n)-1;n&=~(1<<s),r+=1;var a=32-lt(e)+s;if(30<a){var o=s-s%5;a=(n&(1<<o)-1).toString(32),n>>=o,s-=o,Nt=1<<32-lt(e)+s|r<<s|n,St=a+t}else Nt=1<<a|r<<s|n,St=t}function El(t){t.return!==null&&(hr(t,1),yh(t,1,0))}function Cl(t){for(;t===bi;)bi=Yr[--Xr],Yr[Xr]=null,_i=Yr[--Xr],Yr[Xr]=null;for(;t===_r;)_r=He[--Ke],He[Ke]=null,St=He[--Ke],He[Ke]=null,Nt=He[--Ke],He[Ke]=null}var ze=null,Be=null,te=!1,at=null;function xh(t,e){var r=Qe(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Zc(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,ze=t,Be=Xt(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,ze=t,Be=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=_r!==null?{id:Nt,overflow:St}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Qe(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,ze=t,Be=null,!0):!1;default:return!1}}function Co(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Po(t){if(te){var e=Be;if(e){var r=e;if(!Zc(t,e)){if(Co(t))throw Error($(418));e=Xt(r.nextSibling);var n=ze;e&&Zc(t,e)?xh(n,r):(t.flags=t.flags&-4097|2,te=!1,ze=t)}}else{if(Co(t))throw Error($(418));t.flags=t.flags&-4097|2,te=!1,ze=t}}}function eu(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;ze=t}function Fs(t){if(t!==ze)return!1;if(!te)return eu(t),te=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ko(t.type,t.memoizedProps)),e&&(e=Be)){if(Co(t))throw vh(),Error($(418));for(;e;)xh(t,e),e=Xt(e.nextSibling)}if(eu(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error($(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){Be=Xt(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}Be=null}}else Be=ze?Xt(t.stateNode.nextSibling):null;return!0}function vh(){for(var t=Be;t;)t=Xt(t.nextSibling)}function dn(){Be=ze=null,te=!1}function Pl(t){at===null?at=[t]:at.push(t)}var dg=At.ReactCurrentBatchConfig;function Rn(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error($(309));var n=r.stateNode}if(!n)throw Error($(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(o){var l=s.refs;o===null?delete l[a]:l[a]=o},e._stringRef=a,e)}if(typeof t!="string")throw Error($(284));if(!r._owner)throw Error($(290,t))}return t}function Bs(t,e){throw t=Object.prototype.toString.call(e),Error($(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function tu(t){var e=t._init;return e(t._payload)}function wh(t){function e(g,p){if(t){var m=g.deletions;m===null?(g.deletions=[p],g.flags|=16):m.push(p)}}function r(g,p){if(!t)return null;for(;p!==null;)e(g,p),p=p.sibling;return null}function n(g,p){for(g=new Map;p!==null;)p.key!==null?g.set(p.key,p):g.set(p.index,p),p=p.sibling;return g}function s(g,p){return g=rr(g,p),g.index=0,g.sibling=null,g}function a(g,p,m){return g.index=m,t?(m=g.alternate,m!==null?(m=m.index,m<p?(g.flags|=2,p):m):(g.flags|=2,p)):(g.flags|=1048576,p)}function o(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,p,m,y){return p===null||p.tag!==6?(p=Fa(m,g.mode,y),p.return=g,p):(p=s(p,m),p.return=g,p)}function c(g,p,m,y){var E=m.type;return E===Vr?h(g,p,m.props.children,y,m.key):p!==null&&(p.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Bt&&tu(E)===p.type)?(y=s(p,m.props),y.ref=Rn(g,p,m),y.return=g,y):(y=li(m.type,m.key,m.props,null,g.mode,y),y.ref=Rn(g,p,m),y.return=g,y)}function u(g,p,m,y){return p===null||p.tag!==4||p.stateNode.containerInfo!==m.containerInfo||p.stateNode.implementation!==m.implementation?(p=Ba(m,g.mode,y),p.return=g,p):(p=s(p,m.children||[]),p.return=g,p)}function h(g,p,m,y,E){return p===null||p.tag!==7?(p=wr(m,g.mode,y,E),p.return=g,p):(p=s(p,m),p.return=g,p)}function d(g,p,m){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Fa(""+p,g.mode,m),p.return=g,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Ts:return m=li(p.type,p.key,p.props,null,g.mode,m),m.ref=Rn(g,null,p),m.return=g,m;case Wr:return p=Ba(p,g.mode,m),p.return=g,p;case Bt:var y=p._init;return d(g,y(p._payload),m)}if($n(p)||Sn(p))return p=wr(p,g.mode,m,null),p.return=g,p;Bs(g,p)}return null}function f(g,p,m,y){var E=p!==null?p.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return E!==null?null:l(g,p,""+m,y);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Ts:return m.key===E?c(g,p,m,y):null;case Wr:return m.key===E?u(g,p,m,y):null;case Bt:return E=m._init,f(g,p,E(m._payload),y)}if($n(m)||Sn(m))return E!==null?null:h(g,p,m,y,null);Bs(g,m)}return null}function x(g,p,m,y,E){if(typeof y=="string"&&y!==""||typeof y=="number")return g=g.get(m)||null,l(p,g,""+y,E);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ts:return g=g.get(y.key===null?m:y.key)||null,c(p,g,y,E);case Wr:return g=g.get(y.key===null?m:y.key)||null,u(p,g,y,E);case Bt:var w=y._init;return x(g,p,m,w(y._payload),E)}if($n(y)||Sn(y))return g=g.get(m)||null,h(p,g,y,E,null);Bs(p,y)}return null}function v(g,p,m,y){for(var E=null,w=null,N=p,C=p=0,T=null;N!==null&&C<m.length;C++){N.index>C?(T=N,N=null):T=N.sibling;var S=f(g,N,m[C],y);if(S===null){N===null&&(N=T);break}t&&N&&S.alternate===null&&e(g,N),p=a(S,p,C),w===null?E=S:w.sibling=S,w=S,N=T}if(C===m.length)return r(g,N),te&&hr(g,C),E;if(N===null){for(;C<m.length;C++)N=d(g,m[C],y),N!==null&&(p=a(N,p,C),w===null?E=N:w.sibling=N,w=N);return te&&hr(g,C),E}for(N=n(g,N);C<m.length;C++)T=x(N,g,C,m[C],y),T!==null&&(t&&T.alternate!==null&&N.delete(T.key===null?C:T.key),p=a(T,p,C),w===null?E=T:w.sibling=T,w=T);return t&&N.forEach(function(D){return e(g,D)}),te&&hr(g,C),E}function _(g,p,m,y){var E=Sn(m);if(typeof E!="function")throw Error($(150));if(m=E.call(m),m==null)throw Error($(151));for(var w=E=null,N=p,C=p=0,T=null,S=m.next();N!==null&&!S.done;C++,S=m.next()){N.index>C?(T=N,N=null):T=N.sibling;var D=f(g,N,S.value,y);if(D===null){N===null&&(N=T);break}t&&N&&D.alternate===null&&e(g,N),p=a(D,p,C),w===null?E=D:w.sibling=D,w=D,N=T}if(S.done)return r(g,N),te&&hr(g,C),E;if(N===null){for(;!S.done;C++,S=m.next())S=d(g,S.value,y),S!==null&&(p=a(S,p,C),w===null?E=S:w.sibling=S,w=S);return te&&hr(g,C),E}for(N=n(g,N);!S.done;C++,S=m.next())S=x(N,g,C,S.value,y),S!==null&&(t&&S.alternate!==null&&N.delete(S.key===null?C:S.key),p=a(S,p,C),w===null?E=S:w.sibling=S,w=S);return t&&N.forEach(function(M){return e(g,M)}),te&&hr(g,C),E}function k(g,p,m,y){if(typeof m=="object"&&m!==null&&m.type===Vr&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Ts:e:{for(var E=m.key,w=p;w!==null;){if(w.key===E){if(E=m.type,E===Vr){if(w.tag===7){r(g,w.sibling),p=s(w,m.props.children),p.return=g,g=p;break e}}else if(w.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Bt&&tu(E)===w.type){r(g,w.sibling),p=s(w,m.props),p.ref=Rn(g,w,m),p.return=g,g=p;break e}r(g,w);break}else e(g,w);w=w.sibling}m.type===Vr?(p=wr(m.props.children,g.mode,y,m.key),p.return=g,g=p):(y=li(m.type,m.key,m.props,null,g.mode,y),y.ref=Rn(g,p,m),y.return=g,g=y)}return o(g);case Wr:e:{for(w=m.key;p!==null;){if(p.key===w)if(p.tag===4&&p.stateNode.containerInfo===m.containerInfo&&p.stateNode.implementation===m.implementation){r(g,p.sibling),p=s(p,m.children||[]),p.return=g,g=p;break e}else{r(g,p);break}else e(g,p);p=p.sibling}p=Ba(m,g.mode,y),p.return=g,g=p}return o(g);case Bt:return w=m._init,k(g,p,w(m._payload),y)}if($n(m))return v(g,p,m,y);if(Sn(m))return _(g,p,m,y);Bs(g,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,p!==null&&p.tag===6?(r(g,p.sibling),p=s(p,m),p.return=g,g=p):(r(g,p),p=Fa(m,g.mode,y),p.return=g,g=p),o(g)):r(g,p)}return k}var hn=wh(!0),bh=wh(!1),ji=or(null),ki=null,Zr=null,Tl=null;function Rl(){Tl=Zr=ki=null}function Ol(t){var e=ji.current;ee(ji),t._currentValue=e}function To(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function on(t,e){ki=t,Tl=Zr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Le=!0),t.firstContext=null)}function Ze(t){var e=t._currentValue;if(Tl!==t)if(t={context:t,memoizedValue:e,next:null},Zr===null){if(ki===null)throw Error($(308));Zr=t,ki.dependencies={lanes:0,firstContext:t}}else Zr=Zr.next=t;return e}var yr=null;function Al(t){yr===null?yr=[t]:yr.push(t)}function _h(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,Al(e)):(r.next=s.next,s.next=r),e.interleaved=r,Rt(t,n)}function Rt(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var zt=!1;function Il(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function jh(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ct(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Zt(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,G&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,Rt(t,r)}return s=n.interleaved,s===null?(e.next=e,Al(n)):(e.next=s.next,s.next=e),n.interleaved=e,Rt(t,r)}function ri(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,vl(t,r)}}function ru(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var o={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=o:a=a.next=o,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Ni(t,e,r,n){var s=t.updateQueue;zt=!1;var a=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(a!==null){var d=s.baseState;o=0,h=u=c=null,l=a;do{var f=l.lane,x=l.eventTime;if((n&f)===f){h!==null&&(h=h.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=t,_=l;switch(f=e,x=r,_.tag){case 1:if(v=_.payload,typeof v=="function"){d=v.call(x,d,f);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=_.payload,f=typeof v=="function"?v.call(x,d,f):v,f==null)break e;d=ae({},d,f);break e;case 2:zt=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else x={eventTime:x,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=x,c=d):h=h.next=x,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(h===null&&(c=d),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);kr|=o,t.lanes=o,t.memoizedState=d}}function nu(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error($(191,s));s.call(n)}}}var Ns={},vt=or(Ns),cs=or(Ns),us=or(Ns);function xr(t){if(t===Ns)throw Error($(174));return t}function Ll(t,e){switch(Y(us,e),Y(cs,t),Y(vt,Ns),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:co(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=co(e,t)}ee(vt),Y(vt,e)}function fn(){ee(vt),ee(cs),ee(us)}function kh(t){xr(us.current);var e=xr(vt.current),r=co(e,t.type);e!==r&&(Y(cs,t),Y(vt,r))}function $l(t){cs.current===t&&(ee(vt),ee(cs))}var ne=or(0);function Si(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Ia=[];function Dl(){for(var t=0;t<Ia.length;t++)Ia[t]._workInProgressVersionPrimary=null;Ia.length=0}var ni=At.ReactCurrentDispatcher,La=At.ReactCurrentBatchConfig,jr=0,se=null,me=null,ye=null,Ei=!1,Vn=!1,ds=0,hg=0;function je(){throw Error($(321))}function Ul(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!ut(t[r],e[r]))return!1;return!0}function Ml(t,e,r,n,s,a){if(jr=a,se=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,ni.current=t===null||t.memoizedState===null?gg:yg,t=r(n,s),Vn){a=0;do{if(Vn=!1,ds=0,25<=a)throw Error($(301));a+=1,ye=me=null,e.updateQueue=null,ni.current=xg,t=r(n,s)}while(Vn)}if(ni.current=Ci,e=me!==null&&me.next!==null,jr=0,ye=me=se=null,Ei=!1,e)throw Error($(300));return t}function Fl(){var t=ds!==0;return ds=0,t}function pt(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ye===null?se.memoizedState=ye=t:ye=ye.next=t,ye}function et(){if(me===null){var t=se.alternate;t=t!==null?t.memoizedState:null}else t=me.next;var e=ye===null?se.memoizedState:ye.next;if(e!==null)ye=e,me=t;else{if(t===null)throw Error($(310));me=t,t={memoizedState:me.memoizedState,baseState:me.baseState,baseQueue:me.baseQueue,queue:me.queue,next:null},ye===null?se.memoizedState=ye=t:ye=ye.next=t}return ye}function hs(t,e){return typeof e=="function"?e(t):e}function $a(t){var e=et(),r=e.queue;if(r===null)throw Error($(311));r.lastRenderedReducer=t;var n=me,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var o=s.next;s.next=a.next,a.next=o}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var l=o=null,c=null,u=a;do{var h=u.lane;if((jr&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=d,o=n):c=c.next=d,se.lanes|=h,kr|=h}u=u.next}while(u!==null&&u!==a);c===null?o=n:c.next=l,ut(n,e.memoizedState)||(Le=!0),e.memoizedState=n,e.baseState=o,e.baseQueue=c,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,se.lanes|=a,kr|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Da(t){var e=et(),r=e.queue;if(r===null)throw Error($(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var o=s=s.next;do a=t(a,o.action),o=o.next;while(o!==s);ut(a,e.memoizedState)||(Le=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function Nh(){}function Sh(t,e){var r=se,n=et(),s=e(),a=!ut(n.memoizedState,s);if(a&&(n.memoizedState=s,Le=!0),n=n.queue,Bl(Ph.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||ye!==null&&ye.memoizedState.tag&1){if(r.flags|=2048,fs(9,Ch.bind(null,r,n,s,e),void 0,null),xe===null)throw Error($(349));jr&30||Eh(r,e,s)}return s}function Eh(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=se.updateQueue,e===null?(e={lastEffect:null,stores:null},se.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function Ch(t,e,r,n){e.value=r,e.getSnapshot=n,Th(e)&&Rh(t)}function Ph(t,e,r){return r(function(){Th(e)&&Rh(t)})}function Th(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!ut(t,r)}catch{return!0}}function Rh(t){var e=Rt(t,1);e!==null&&ct(e,t,1,-1)}function su(t){var e=pt();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hs,lastRenderedState:t},e.queue=t,t=t.dispatch=mg.bind(null,se,t),[e.memoizedState,t]}function fs(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=se.updateQueue,e===null?(e={lastEffect:null,stores:null},se.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function Oh(){return et().memoizedState}function si(t,e,r,n){var s=pt();se.flags|=t,s.memoizedState=fs(1|e,r,void 0,n===void 0?null:n)}function Yi(t,e,r,n){var s=et();n=n===void 0?null:n;var a=void 0;if(me!==null){var o=me.memoizedState;if(a=o.destroy,n!==null&&Ul(n,o.deps)){s.memoizedState=fs(e,r,a,n);return}}se.flags|=t,s.memoizedState=fs(1|e,r,a,n)}function iu(t,e){return si(8390656,8,t,e)}function Bl(t,e){return Yi(2048,8,t,e)}function Ah(t,e){return Yi(4,2,t,e)}function Ih(t,e){return Yi(4,4,t,e)}function Lh(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function $h(t,e,r){return r=r!=null?r.concat([t]):null,Yi(4,4,Lh.bind(null,e,t),r)}function zl(){}function Dh(t,e){var r=et();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Ul(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function Uh(t,e){var r=et();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Ul(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function Mh(t,e,r){return jr&21?(ut(r,e)||(r=Wd(),se.lanes|=r,kr|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Le=!0),t.memoizedState=r)}function fg(t,e){var r=Q;Q=r!==0&&4>r?r:4,t(!0);var n=La.transition;La.transition={};try{t(!1),e()}finally{Q=r,La.transition=n}}function Fh(){return et().memoizedState}function pg(t,e,r){var n=tr(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Bh(t))zh(e,r);else if(r=_h(t,e,r,n),r!==null){var s=Pe();ct(r,t,n,s),qh(r,e,n)}}function mg(t,e,r){var n=tr(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Bh(t))zh(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var o=e.lastRenderedState,l=a(o,r);if(s.hasEagerState=!0,s.eagerState=l,ut(l,o)){var c=e.interleaved;c===null?(s.next=s,Al(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}r=_h(t,e,s,n),r!==null&&(s=Pe(),ct(r,t,n,s),qh(r,e,n))}}function Bh(t){var e=t.alternate;return t===se||e!==null&&e===se}function zh(t,e){Vn=Ei=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function qh(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,vl(t,r)}}var Ci={readContext:Ze,useCallback:je,useContext:je,useEffect:je,useImperativeHandle:je,useInsertionEffect:je,useLayoutEffect:je,useMemo:je,useReducer:je,useRef:je,useState:je,useDebugValue:je,useDeferredValue:je,useTransition:je,useMutableSource:je,useSyncExternalStore:je,useId:je,unstable_isNewReconciler:!1},gg={readContext:Ze,useCallback:function(t,e){return pt().memoizedState=[t,e===void 0?null:e],t},useContext:Ze,useEffect:iu,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,si(4194308,4,Lh.bind(null,e,t),r)},useLayoutEffect:function(t,e){return si(4194308,4,t,e)},useInsertionEffect:function(t,e){return si(4,2,t,e)},useMemo:function(t,e){var r=pt();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=pt();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=pg.bind(null,se,t),[n.memoizedState,t]},useRef:function(t){var e=pt();return t={current:t},e.memoizedState=t},useState:su,useDebugValue:zl,useDeferredValue:function(t){return pt().memoizedState=t},useTransition:function(){var t=su(!1),e=t[0];return t=fg.bind(null,t[1]),pt().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=se,s=pt();if(te){if(r===void 0)throw Error($(407));r=r()}else{if(r=e(),xe===null)throw Error($(349));jr&30||Eh(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,iu(Ph.bind(null,n,a,t),[t]),n.flags|=2048,fs(9,Ch.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=pt(),e=xe.identifierPrefix;if(te){var r=St,n=Nt;r=(n&~(1<<32-lt(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=ds++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=hg++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},yg={readContext:Ze,useCallback:Dh,useContext:Ze,useEffect:Bl,useImperativeHandle:$h,useInsertionEffect:Ah,useLayoutEffect:Ih,useMemo:Uh,useReducer:$a,useRef:Oh,useState:function(){return $a(hs)},useDebugValue:zl,useDeferredValue:function(t){var e=et();return Mh(e,me.memoizedState,t)},useTransition:function(){var t=$a(hs)[0],e=et().memoizedState;return[t,e]},useMutableSource:Nh,useSyncExternalStore:Sh,useId:Fh,unstable_isNewReconciler:!1},xg={readContext:Ze,useCallback:Dh,useContext:Ze,useEffect:Bl,useImperativeHandle:$h,useInsertionEffect:Ah,useLayoutEffect:Ih,useMemo:Uh,useReducer:Da,useRef:Oh,useState:function(){return Da(hs)},useDebugValue:zl,useDeferredValue:function(t){var e=et();return me===null?e.memoizedState=t:Mh(e,me.memoizedState,t)},useTransition:function(){var t=Da(hs)[0],e=et().memoizedState;return[t,e]},useMutableSource:Nh,useSyncExternalStore:Sh,useId:Fh,unstable_isNewReconciler:!1};function nt(t,e){if(t&&t.defaultProps){e=ae({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Ro(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:ae({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Xi={isMounted:function(t){return(t=t._reactInternals)?Pr(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Pe(),s=tr(t),a=Ct(n,s);a.payload=e,r!=null&&(a.callback=r),e=Zt(t,a,s),e!==null&&(ct(e,t,s,n),ri(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Pe(),s=tr(t),a=Ct(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=Zt(t,a,s),e!==null&&(ct(e,t,s,n),ri(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Pe(),n=tr(t),s=Ct(r,n);s.tag=2,e!=null&&(s.callback=e),e=Zt(t,s,n),e!==null&&(ct(e,t,n,r),ri(e,t,n))}};function au(t,e,r,n,s,a,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,o):e.prototype&&e.prototype.isPureReactComponent?!is(r,n)||!is(s,a):!0}function Wh(t,e,r){var n=!1,s=ir,a=e.contextType;return typeof a=="object"&&a!==null?a=Ze(a):(s=De(e)?br:Se.current,n=e.contextTypes,a=(n=n!=null)?un(t,s):ir),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Xi,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function ou(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Xi.enqueueReplaceState(e,e.state,null)}function Oo(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Il(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=Ze(a):(a=De(e)?br:Se.current,s.context=un(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(Ro(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Xi.enqueueReplaceState(s,s.state,null),Ni(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function pn(t,e){try{var r="",n=e;do r+=Hp(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function Ua(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function Ao(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var vg=typeof WeakMap=="function"?WeakMap:Map;function Vh(t,e,r){r=Ct(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){Ti||(Ti=!0,qo=n),Ao(t,e)},r}function Hh(t,e,r){r=Ct(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){Ao(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Ao(t,e),typeof n!="function"&&(er===null?er=new Set([this]):er.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),r}function lu(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new vg;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=Ag.bind(null,t,e,r),e.then(t,t))}function cu(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function uu(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Ct(-1,1),e.tag=2,Zt(r,e,1))),r.lanes|=1),t)}var wg=At.ReactCurrentOwner,Le=!1;function Ce(t,e,r,n){e.child=t===null?bh(e,null,r,n):hn(e,t.child,r,n)}function du(t,e,r,n,s){r=r.render;var a=e.ref;return on(e,s),n=Ml(t,e,r,n,a,s),r=Fl(),t!==null&&!Le?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ot(t,e,s)):(te&&r&&El(e),e.flags|=1,Ce(t,e,n,s),e.child)}function hu(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!Jl(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,Kh(t,e,a,n,s)):(t=li(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var o=a.memoizedProps;if(r=r.compare,r=r!==null?r:is,r(o,n)&&t.ref===e.ref)return Ot(t,e,s)}return e.flags|=1,t=rr(a,n),t.ref=e.ref,t.return=e,e.child=t}function Kh(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(is(a,n)&&t.ref===e.ref)if(Le=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(Le=!0);else return e.lanes=t.lanes,Ot(t,e,s)}return Io(t,e,r,n,s)}function Gh(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Y(tn,Fe),Fe|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Y(tn,Fe),Fe|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Y(tn,Fe),Fe|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,Y(tn,Fe),Fe|=n;return Ce(t,e,s,r),e.child}function Qh(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Io(t,e,r,n,s){var a=De(r)?br:Se.current;return a=un(e,a),on(e,s),r=Ml(t,e,r,n,a,s),n=Fl(),t!==null&&!Le?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Ot(t,e,s)):(te&&n&&El(e),e.flags|=1,Ce(t,e,r,s),e.child)}function fu(t,e,r,n,s){if(De(r)){var a=!0;wi(e)}else a=!1;if(on(e,s),e.stateNode===null)ii(t,e),Wh(e,r,n),Oo(e,r,n,s),n=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=r.contextType;typeof u=="object"&&u!==null?u=Ze(u):(u=De(r)?br:Se.current,u=un(e,u));var h=r.getDerivedStateFromProps,d=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";d||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&ou(e,o,n,u),zt=!1;var f=e.memoizedState;o.state=f,Ni(e,n,o,s),c=e.memoizedState,l!==n||f!==c||$e.current||zt?(typeof h=="function"&&(Ro(e,r,h,n),c=e.memoizedState),(l=zt||au(e,r,l,n,f,c,u))?(d||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{o=e.stateNode,jh(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:nt(e.type,l),o.props=u,d=e.pendingProps,f=o.context,c=r.contextType,typeof c=="object"&&c!==null?c=Ze(c):(c=De(r)?br:Se.current,c=un(e,c));var x=r.getDerivedStateFromProps;(h=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==d||f!==c)&&ou(e,o,n,c),zt=!1,f=e.memoizedState,o.state=f,Ni(e,n,o,s);var v=e.memoizedState;l!==d||f!==v||$e.current||zt?(typeof x=="function"&&(Ro(e,r,x,n),v=e.memoizedState),(u=zt||au(e,r,u,n,f,v,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,v,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=v),o.props=n,o.state=v,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),n=!1)}return Lo(t,e,r,n,a,s)}function Lo(t,e,r,n,s,a){Qh(t,e);var o=(e.flags&128)!==0;if(!n&&!o)return s&&Xc(e,r,!1),Ot(t,e,a);n=e.stateNode,wg.current=e;var l=o&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&o?(e.child=hn(e,t.child,null,a),e.child=hn(e,null,l,a)):Ce(t,e,l,a),e.memoizedState=n.state,s&&Xc(e,r,!0),e.child}function Jh(t){var e=t.stateNode;e.pendingContext?Yc(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Yc(t,e.context,!1),Ll(t,e.containerInfo)}function pu(t,e,r,n,s){return dn(),Pl(s),e.flags|=256,Ce(t,e,r,n),e.child}var $o={dehydrated:null,treeContext:null,retryLane:0};function Do(t){return{baseLanes:t,cachePool:null,transitions:null}}function Yh(t,e,r){var n=e.pendingProps,s=ne.current,a=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Y(ne,s&1),t===null)return Po(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=n.children,t=n.fallback,a?(n=e.mode,a=e.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=ta(o,n,0,null),t=wr(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Do(r),e.memoizedState=$o,t):ql(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return bg(t,e,o,n,l,s,r);if(a){a=n.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=c,e.deletions=null):(n=rr(s,c),n.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=rr(l,a):(a=wr(a,o,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,o=t.child.memoizedState,o=o===null?Do(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=t.childLanes&~r,e.memoizedState=$o,n}return a=t.child,t=a.sibling,n=rr(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function ql(t,e){return e=ta({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function zs(t,e,r,n){return n!==null&&Pl(n),hn(e,t.child,null,r),t=ql(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function bg(t,e,r,n,s,a,o){if(r)return e.flags&256?(e.flags&=-257,n=Ua(Error($(422))),zs(t,e,o,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=ta({mode:"visible",children:n.children},s,0,null),a=wr(a,s,o,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&hn(e,t.child,null,o),e.child.memoizedState=Do(o),e.memoizedState=$o,a);if(!(e.mode&1))return zs(t,e,o,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error($(419)),n=Ua(a,n,void 0),zs(t,e,o,n)}if(l=(o&t.childLanes)!==0,Le||l){if(n=xe,n!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|o)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Rt(t,s),ct(n,t,s,-1))}return Ql(),n=Ua(Error($(421))),zs(t,e,o,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=Ig.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,Be=Xt(s.nextSibling),ze=e,te=!0,at=null,t!==null&&(He[Ke++]=Nt,He[Ke++]=St,He[Ke++]=_r,Nt=t.id,St=t.overflow,_r=e),e=ql(e,n.children),e.flags|=4096,e)}function mu(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),To(t.return,e,r)}function Ma(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function Xh(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(Ce(t,e,n.children,r),n=ne.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&mu(t,r,e);else if(t.tag===19)mu(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Y(ne,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&Si(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),Ma(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Si(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}Ma(e,!0,r,null,a);break;case"together":Ma(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function ii(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Ot(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),kr|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error($(153));if(e.child!==null){for(t=e.child,r=rr(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=rr(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function _g(t,e,r){switch(e.tag){case 3:Jh(e),dn();break;case 5:kh(e);break;case 1:De(e.type)&&wi(e);break;case 4:Ll(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Y(ji,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Y(ne,ne.current&1),e.flags|=128,null):r&e.child.childLanes?Yh(t,e,r):(Y(ne,ne.current&1),t=Ot(t,e,r),t!==null?t.sibling:null);Y(ne,ne.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return Xh(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Y(ne,ne.current),n)break;return null;case 22:case 23:return e.lanes=0,Gh(t,e,r)}return Ot(t,e,r)}var Zh,Uo,ef,tf;Zh=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Uo=function(){};ef=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,xr(vt.current);var a=null;switch(r){case"input":s=io(t,s),n=io(t,n),a=[];break;case"select":s=ae({},s,{value:void 0}),n=ae({},n,{value:void 0}),a=[];break;case"textarea":s=lo(t,s),n=lo(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=xi)}uo(r,n);var o;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Xn.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Xn.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Z("scroll",t),a||l===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};tf=function(t,e,r,n){r!==n&&(e.flags|=4)};function On(t,e){if(!te)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function ke(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function jg(t,e,r){var n=e.pendingProps;switch(Cl(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ke(e),null;case 1:return De(e.type)&&vi(),ke(e),null;case 3:return n=e.stateNode,fn(),ee($e),ee(Se),Dl(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Fs(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,at!==null&&(Ho(at),at=null))),Uo(t,e),ke(e),null;case 5:$l(e);var s=xr(us.current);if(r=e.type,t!==null&&e.stateNode!=null)ef(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error($(166));return ke(e),null}if(t=xr(vt.current),Fs(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[gt]=e,n[ls]=a,t=(e.mode&1)!==0,r){case"dialog":Z("cancel",n),Z("close",n);break;case"iframe":case"object":case"embed":Z("load",n);break;case"video":case"audio":for(s=0;s<Un.length;s++)Z(Un[s],n);break;case"source":Z("error",n);break;case"img":case"image":case"link":Z("error",n),Z("load",n);break;case"details":Z("toggle",n);break;case"input":kc(n,a),Z("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Z("invalid",n);break;case"textarea":Sc(n,a),Z("invalid",n)}uo(r,a),s=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&Ms(n.textContent,l,t),s=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Ms(n.textContent,l,t),s=["children",""+l]):Xn.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Z("scroll",n)}switch(r){case"input":Rs(n),Nc(n,a,!0);break;case"textarea":Rs(n),Ec(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=xi)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Pd(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=o.createElement(r,{is:n.is}):(t=o.createElement(r),r==="select"&&(o=t,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):t=o.createElementNS(t,r),t[gt]=e,t[ls]=n,Zh(t,e,!1,!1),e.stateNode=t;e:{switch(o=ho(r,n),r){case"dialog":Z("cancel",t),Z("close",t),s=n;break;case"iframe":case"object":case"embed":Z("load",t),s=n;break;case"video":case"audio":for(s=0;s<Un.length;s++)Z(Un[s],t);s=n;break;case"source":Z("error",t),s=n;break;case"img":case"image":case"link":Z("error",t),Z("load",t),s=n;break;case"details":Z("toggle",t),s=n;break;case"input":kc(t,n),s=io(t,n),Z("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=ae({},n,{value:void 0}),Z("invalid",t);break;case"textarea":Sc(t,n),s=lo(t,n),Z("invalid",t);break;default:s=n}uo(r,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?Od(t,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Td(t,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&Zn(t,c):typeof c=="number"&&Zn(t,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Xn.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Z("scroll",t):c!=null&&fl(t,a,c,o))}switch(r){case"input":Rs(t),Nc(t,n,!1);break;case"textarea":Rs(t),Ec(t);break;case"option":n.value!=null&&t.setAttribute("value",""+sr(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?rn(t,!!n.multiple,a,!1):n.defaultValue!=null&&rn(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=xi)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ke(e),null;case 6:if(t&&e.stateNode!=null)tf(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error($(166));if(r=xr(us.current),xr(vt.current),Fs(e)){if(n=e.stateNode,r=e.memoizedProps,n[gt]=e,(a=n.nodeValue!==r)&&(t=ze,t!==null))switch(t.tag){case 3:Ms(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ms(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[gt]=e,e.stateNode=n}return ke(e),null;case 13:if(ee(ne),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(te&&Be!==null&&e.mode&1&&!(e.flags&128))vh(),dn(),e.flags|=98560,a=!1;else if(a=Fs(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error($(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error($(317));a[gt]=e}else dn(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ke(e),a=!1}else at!==null&&(Ho(at),at=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||ne.current&1?ge===0&&(ge=3):Ql())),e.updateQueue!==null&&(e.flags|=4),ke(e),null);case 4:return fn(),Uo(t,e),t===null&&as(e.stateNode.containerInfo),ke(e),null;case 10:return Ol(e.type._context),ke(e),null;case 17:return De(e.type)&&vi(),ke(e),null;case 19:if(ee(ne),a=e.memoizedState,a===null)return ke(e),null;if(n=(e.flags&128)!==0,o=a.rendering,o===null)if(n)On(a,!1);else{if(ge!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Si(t),o!==null){for(e.flags|=128,On(a,!1),n=o.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,t=o.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Y(ne,ne.current&1|2),e.child}t=t.sibling}a.tail!==null&&ce()>mn&&(e.flags|=128,n=!0,On(a,!1),e.lanes=4194304)}else{if(!n)if(t=Si(o),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),On(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!te)return ke(e),null}else 2*ce()-a.renderingStartTime>mn&&r!==1073741824&&(e.flags|=128,n=!0,On(a,!1),e.lanes=4194304);a.isBackwards?(o.sibling=e.child,e.child=o):(r=a.last,r!==null?r.sibling=o:e.child=o,a.last=o)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=ce(),e.sibling=null,r=ne.current,Y(ne,n?r&1|2:r&1),e):(ke(e),null);case 22:case 23:return Gl(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Fe&1073741824&&(ke(e),e.subtreeFlags&6&&(e.flags|=8192)):ke(e),null;case 24:return null;case 25:return null}throw Error($(156,e.tag))}function kg(t,e){switch(Cl(e),e.tag){case 1:return De(e.type)&&vi(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return fn(),ee($e),ee(Se),Dl(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return $l(e),null;case 13:if(ee(ne),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error($(340));dn()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ee(ne),null;case 4:return fn(),null;case 10:return Ol(e.type._context),null;case 22:case 23:return Gl(),null;case 24:return null;default:return null}}var qs=!1,Ne=!1,Ng=typeof WeakSet=="function"?WeakSet:Set,B=null;function en(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){oe(t,e,n)}else r.current=null}function Mo(t,e,r){try{r()}catch(n){oe(t,e,n)}}var gu=!1;function Sg(t,e){if(_o=mi,t=ah(),Sl(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var o=0,l=-1,c=-1,u=0,h=0,d=t,f=null;t:for(;;){for(var x;d!==r||s!==0&&d.nodeType!==3||(l=o+s),d!==a||n!==0&&d.nodeType!==3||(c=o+n),d.nodeType===3&&(o+=d.nodeValue.length),(x=d.firstChild)!==null;)f=d,d=x;for(;;){if(d===t)break t;if(f===r&&++u===s&&(l=o),f===a&&++h===n&&(c=o),(x=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=x}r=l===-1||c===-1?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(jo={focusedElem:t,selectionRange:r},mi=!1,B=e;B!==null;)if(e=B,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,B=t;else for(;B!==null;){e=B;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var _=v.memoizedProps,k=v.memoizedState,g=e.stateNode,p=g.getSnapshotBeforeUpdate(e.elementType===e.type?_:nt(e.type,_),k);g.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error($(163))}}catch(y){oe(e,e.return,y)}if(t=e.sibling,t!==null){t.return=e.return,B=t;break}B=e.return}return v=gu,gu=!1,v}function Hn(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&Mo(e,r,a)}s=s.next}while(s!==n)}}function Zi(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Fo(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function rf(t){var e=t.alternate;e!==null&&(t.alternate=null,rf(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[gt],delete e[ls],delete e[So],delete e[lg],delete e[cg])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function nf(t){return t.tag===5||t.tag===3||t.tag===4}function yu(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||nf(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Bo(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=xi));else if(n!==4&&(t=t.child,t!==null))for(Bo(t,e,r),t=t.sibling;t!==null;)Bo(t,e,r),t=t.sibling}function zo(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(zo(t,e,r),t=t.sibling;t!==null;)zo(t,e,r),t=t.sibling}var ve=null,st=!1;function $t(t,e,r){for(r=r.child;r!==null;)sf(t,e,r),r=r.sibling}function sf(t,e,r){if(xt&&typeof xt.onCommitFiberUnmount=="function")try{xt.onCommitFiberUnmount(Vi,r)}catch{}switch(r.tag){case 5:Ne||en(r,e);case 6:var n=ve,s=st;ve=null,$t(t,e,r),ve=n,st=s,ve!==null&&(st?(t=ve,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):ve.removeChild(r.stateNode));break;case 18:ve!==null&&(st?(t=ve,r=r.stateNode,t.nodeType===8?Oa(t.parentNode,r):t.nodeType===1&&Oa(t,r),ns(t)):Oa(ve,r.stateNode));break;case 4:n=ve,s=st,ve=r.stateNode.containerInfo,st=!0,$t(t,e,r),ve=n,st=s;break;case 0:case 11:case 14:case 15:if(!Ne&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&Mo(r,e,o),s=s.next}while(s!==n)}$t(t,e,r);break;case 1:if(!Ne&&(en(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(l){oe(r,e,l)}$t(t,e,r);break;case 21:$t(t,e,r);break;case 22:r.mode&1?(Ne=(n=Ne)||r.memoizedState!==null,$t(t,e,r),Ne=n):$t(t,e,r);break;default:$t(t,e,r)}}function xu(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Ng),e.forEach(function(n){var s=Lg.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function tt(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:ve=l.stateNode,st=!1;break e;case 3:ve=l.stateNode.containerInfo,st=!0;break e;case 4:ve=l.stateNode.containerInfo,st=!0;break e}l=l.return}if(ve===null)throw Error($(160));sf(a,o,s),ve=null,st=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){oe(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)af(e,t),e=e.sibling}function af(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(tt(e,t),ft(t),n&4){try{Hn(3,t,t.return),Zi(3,t)}catch(_){oe(t,t.return,_)}try{Hn(5,t,t.return)}catch(_){oe(t,t.return,_)}}break;case 1:tt(e,t),ft(t),n&512&&r!==null&&en(r,r.return);break;case 5:if(tt(e,t),ft(t),n&512&&r!==null&&en(r,r.return),t.flags&32){var s=t.stateNode;try{Zn(s,"")}catch(_){oe(t,t.return,_)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,o=r!==null?r.memoizedProps:a,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&Ed(s,a),ho(l,o);var u=ho(l,a);for(o=0;o<c.length;o+=2){var h=c[o],d=c[o+1];h==="style"?Od(s,d):h==="dangerouslySetInnerHTML"?Td(s,d):h==="children"?Zn(s,d):fl(s,h,d,u)}switch(l){case"input":ao(s,a);break;case"textarea":Cd(s,a);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var x=a.value;x!=null?rn(s,!!a.multiple,x,!1):f!==!!a.multiple&&(a.defaultValue!=null?rn(s,!!a.multiple,a.defaultValue,!0):rn(s,!!a.multiple,a.multiple?[]:"",!1))}s[ls]=a}catch(_){oe(t,t.return,_)}}break;case 6:if(tt(e,t),ft(t),n&4){if(t.stateNode===null)throw Error($(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(_){oe(t,t.return,_)}}break;case 3:if(tt(e,t),ft(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ns(e.containerInfo)}catch(_){oe(t,t.return,_)}break;case 4:tt(e,t),ft(t);break;case 13:tt(e,t),ft(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Hl=ce())),n&4&&xu(t);break;case 22:if(h=r!==null&&r.memoizedState!==null,t.mode&1?(Ne=(u=Ne)||h,tt(e,t),Ne=u):tt(e,t),ft(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(B=t,h=t.child;h!==null;){for(d=B=h;B!==null;){switch(f=B,x=f.child,f.tag){case 0:case 11:case 14:case 15:Hn(4,f,f.return);break;case 1:en(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){n=f,r=f.return;try{e=n,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(_){oe(n,r,_)}}break;case 5:en(f,f.return);break;case 22:if(f.memoizedState!==null){wu(d);continue}}x!==null?(x.return=f,B=x):wu(d)}h=h.sibling}e:for(h=null,d=t;;){if(d.tag===5){if(h===null){h=d;try{s=d.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=d.stateNode,c=d.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Rd("display",o))}catch(_){oe(t,t.return,_)}}}else if(d.tag===6){if(h===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(_){oe(t,t.return,_)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:tt(e,t),ft(t),n&4&&xu(t);break;case 21:break;default:tt(e,t),ft(t)}}function ft(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(nf(r)){var n=r;break e}r=r.return}throw Error($(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(Zn(s,""),n.flags&=-33);var a=yu(t);zo(t,a,s);break;case 3:case 4:var o=n.stateNode.containerInfo,l=yu(t);Bo(t,l,o);break;default:throw Error($(161))}}catch(c){oe(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Eg(t,e,r){B=t,of(t)}function of(t,e,r){for(var n=(t.mode&1)!==0;B!==null;){var s=B,a=s.child;if(s.tag===22&&n){var o=s.memoizedState!==null||qs;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||Ne;l=qs;var u=Ne;if(qs=o,(Ne=c)&&!u)for(B=s;B!==null;)o=B,c=o.child,o.tag===22&&o.memoizedState!==null?bu(s):c!==null?(c.return=o,B=c):bu(s);for(;a!==null;)B=a,of(a),a=a.sibling;B=s,qs=l,Ne=u}vu(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,B=a):vu(t)}}function vu(t){for(;B!==null;){var e=B;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ne||Zi(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Ne)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:nt(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&nu(e,a,n);break;case 3:var o=e.updateQueue;if(o!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}nu(e,o,r)}break;case 5:var l=e.stateNode;if(r===null&&e.flags&4){r=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var d=h.dehydrated;d!==null&&ns(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error($(163))}Ne||e.flags&512&&Fo(e)}catch(f){oe(e,e.return,f)}}if(e===t){B=null;break}if(r=e.sibling,r!==null){r.return=e.return,B=r;break}B=e.return}}function wu(t){for(;B!==null;){var e=B;if(e===t){B=null;break}var r=e.sibling;if(r!==null){r.return=e.return,B=r;break}B=e.return}}function bu(t){for(;B!==null;){var e=B;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Zi(4,e)}catch(c){oe(e,r,c)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(c){oe(e,s,c)}}var a=e.return;try{Fo(e)}catch(c){oe(e,a,c)}break;case 5:var o=e.return;try{Fo(e)}catch(c){oe(e,o,c)}}}catch(c){oe(e,e.return,c)}if(e===t){B=null;break}var l=e.sibling;if(l!==null){l.return=e.return,B=l;break}B=e.return}}var Cg=Math.ceil,Pi=At.ReactCurrentDispatcher,Wl=At.ReactCurrentOwner,Je=At.ReactCurrentBatchConfig,G=0,xe=null,he=null,we=0,Fe=0,tn=or(0),ge=0,ps=null,kr=0,ea=0,Vl=0,Kn=null,Ae=null,Hl=0,mn=1/0,_t=null,Ti=!1,qo=null,er=null,Ws=!1,Kt=null,Ri=0,Gn=0,Wo=null,ai=-1,oi=0;function Pe(){return G&6?ce():ai!==-1?ai:ai=ce()}function tr(t){return t.mode&1?G&2&&we!==0?we&-we:dg.transition!==null?(oi===0&&(oi=Wd()),oi):(t=Q,t!==0||(t=window.event,t=t===void 0?16:Yd(t.type)),t):1}function ct(t,e,r,n){if(50<Gn)throw Gn=0,Wo=null,Error($(185));_s(t,r,n),(!(G&2)||t!==xe)&&(t===xe&&(!(G&2)&&(ea|=r),ge===4&&Wt(t,we)),Ue(t,n),r===1&&G===0&&!(e.mode&1)&&(mn=ce()+500,Ji&&lr()))}function Ue(t,e){var r=t.callbackNode;dm(t,e);var n=pi(t,t===xe?we:0);if(n===0)r!==null&&Tc(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&Tc(r),e===1)t.tag===0?ug(_u.bind(null,t)):gh(_u.bind(null,t)),ag(function(){!(G&6)&&lr()}),r=null;else{switch(Vd(n)){case 1:r=xl;break;case 4:r=zd;break;case 16:r=fi;break;case 536870912:r=qd;break;default:r=fi}r=mf(r,lf.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function lf(t,e){if(ai=-1,oi=0,G&6)throw Error($(327));var r=t.callbackNode;if(ln()&&t.callbackNode!==r)return null;var n=pi(t,t===xe?we:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=Oi(t,n);else{e=n;var s=G;G|=2;var a=uf();(xe!==t||we!==e)&&(_t=null,mn=ce()+500,vr(t,e));do try{Rg();break}catch(l){cf(t,l)}while(!0);Rl(),Pi.current=a,G=s,he!==null?e=0:(xe=null,we=0,e=ge)}if(e!==0){if(e===2&&(s=yo(t),s!==0&&(n=s,e=Vo(t,s))),e===1)throw r=ps,vr(t,0),Wt(t,n),Ue(t,ce()),r;if(e===6)Wt(t,n);else{if(s=t.current.alternate,!(n&30)&&!Pg(s)&&(e=Oi(t,n),e===2&&(a=yo(t),a!==0&&(n=a,e=Vo(t,a))),e===1))throw r=ps,vr(t,0),Wt(t,n),Ue(t,ce()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error($(345));case 2:fr(t,Ae,_t);break;case 3:if(Wt(t,n),(n&130023424)===n&&(e=Hl+500-ce(),10<e)){if(pi(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){Pe(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=No(fr.bind(null,t,Ae,_t),e);break}fr(t,Ae,_t);break;case 4:if(Wt(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var o=31-lt(n);a=1<<o,o=e[o],o>s&&(s=o),n&=~a}if(n=s,n=ce()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Cg(n/1960))-n,10<n){t.timeoutHandle=No(fr.bind(null,t,Ae,_t),n);break}fr(t,Ae,_t);break;case 5:fr(t,Ae,_t);break;default:throw Error($(329))}}}return Ue(t,ce()),t.callbackNode===r?lf.bind(null,t):null}function Vo(t,e){var r=Kn;return t.current.memoizedState.isDehydrated&&(vr(t,e).flags|=256),t=Oi(t,e),t!==2&&(e=Ae,Ae=r,e!==null&&Ho(e)),t}function Ho(t){Ae===null?Ae=t:Ae.push.apply(Ae,t)}function Pg(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!ut(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Wt(t,e){for(e&=~Vl,e&=~ea,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-lt(e),n=1<<r;t[r]=-1,e&=~n}}function _u(t){if(G&6)throw Error($(327));ln();var e=pi(t,0);if(!(e&1))return Ue(t,ce()),null;var r=Oi(t,e);if(t.tag!==0&&r===2){var n=yo(t);n!==0&&(e=n,r=Vo(t,n))}if(r===1)throw r=ps,vr(t,0),Wt(t,e),Ue(t,ce()),r;if(r===6)throw Error($(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fr(t,Ae,_t),Ue(t,ce()),null}function Kl(t,e){var r=G;G|=1;try{return t(e)}finally{G=r,G===0&&(mn=ce()+500,Ji&&lr())}}function Nr(t){Kt!==null&&Kt.tag===0&&!(G&6)&&ln();var e=G;G|=1;var r=Je.transition,n=Q;try{if(Je.transition=null,Q=1,t)return t()}finally{Q=n,Je.transition=r,G=e,!(G&6)&&lr()}}function Gl(){Fe=tn.current,ee(tn)}function vr(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,ig(r)),he!==null)for(r=he.return;r!==null;){var n=r;switch(Cl(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&vi();break;case 3:fn(),ee($e),ee(Se),Dl();break;case 5:$l(n);break;case 4:fn();break;case 13:ee(ne);break;case 19:ee(ne);break;case 10:Ol(n.type._context);break;case 22:case 23:Gl()}r=r.return}if(xe=t,he=t=rr(t.current,null),we=Fe=e,ge=0,ps=null,Vl=ea=kr=0,Ae=Kn=null,yr!==null){for(e=0;e<yr.length;e++)if(r=yr[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var o=a.next;a.next=s,n.next=o}r.pending=n}yr=null}return t}function cf(t,e){do{var r=he;try{if(Rl(),ni.current=Ci,Ei){for(var n=se.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ei=!1}if(jr=0,ye=me=se=null,Vn=!1,ds=0,Wl.current=null,r===null||r.return===null){ge=1,ps=e,he=null;break}e:{var a=t,o=r.return,l=r,c=e;if(e=we,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,d=h.tag;if(!(h.mode&1)&&(d===0||d===11||d===15)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var x=cu(o);if(x!==null){x.flags&=-257,uu(x,o,l,a,e),x.mode&1&&lu(a,u,e),e=x,c=u;var v=e.updateQueue;if(v===null){var _=new Set;_.add(c),e.updateQueue=_}else v.add(c);break e}else{if(!(e&1)){lu(a,u,e),Ql();break e}c=Error($(426))}}else if(te&&l.mode&1){var k=cu(o);if(k!==null){!(k.flags&65536)&&(k.flags|=256),uu(k,o,l,a,e),Pl(pn(c,l));break e}}a=c=pn(c,l),ge!==4&&(ge=2),Kn===null?Kn=[a]:Kn.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var g=Vh(a,c,e);ru(a,g);break e;case 1:l=c;var p=a.type,m=a.stateNode;if(!(a.flags&128)&&(typeof p.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(er===null||!er.has(m)))){a.flags|=65536,e&=-e,a.lanes|=e;var y=Hh(a,l,e);ru(a,y);break e}}a=a.return}while(a!==null)}hf(r)}catch(E){e=E,he===r&&r!==null&&(he=r=r.return);continue}break}while(!0)}function uf(){var t=Pi.current;return Pi.current=Ci,t===null?Ci:t}function Ql(){(ge===0||ge===3||ge===2)&&(ge=4),xe===null||!(kr&268435455)&&!(ea&268435455)||Wt(xe,we)}function Oi(t,e){var r=G;G|=2;var n=uf();(xe!==t||we!==e)&&(_t=null,vr(t,e));do try{Tg();break}catch(s){cf(t,s)}while(!0);if(Rl(),G=r,Pi.current=n,he!==null)throw Error($(261));return xe=null,we=0,ge}function Tg(){for(;he!==null;)df(he)}function Rg(){for(;he!==null&&!rm();)df(he)}function df(t){var e=pf(t.alternate,t,Fe);t.memoizedProps=t.pendingProps,e===null?hf(t):he=e,Wl.current=null}function hf(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=kg(r,e),r!==null){r.flags&=32767,he=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ge=6,he=null;return}}else if(r=jg(r,e,Fe),r!==null){he=r;return}if(e=e.sibling,e!==null){he=e;return}he=e=t}while(e!==null);ge===0&&(ge=5)}function fr(t,e,r){var n=Q,s=Je.transition;try{Je.transition=null,Q=1,Og(t,e,r,n)}finally{Je.transition=s,Q=n}return null}function Og(t,e,r,n){do ln();while(Kt!==null);if(G&6)throw Error($(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error($(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(hm(t,a),t===xe&&(he=xe=null,we=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ws||(Ws=!0,mf(fi,function(){return ln(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Je.transition,Je.transition=null;var o=Q;Q=1;var l=G;G|=4,Wl.current=null,Sg(t,r),af(r,t),Xm(jo),mi=!!_o,jo=_o=null,t.current=r,Eg(r),nm(),G=l,Q=o,Je.transition=a}else t.current=r;if(Ws&&(Ws=!1,Kt=t,Ri=s),a=t.pendingLanes,a===0&&(er=null),am(r.stateNode),Ue(t,ce()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(Ti)throw Ti=!1,t=qo,qo=null,t;return Ri&1&&t.tag!==0&&ln(),a=t.pendingLanes,a&1?t===Wo?Gn++:(Gn=0,Wo=t):Gn=0,lr(),null}function ln(){if(Kt!==null){var t=Vd(Ri),e=Je.transition,r=Q;try{if(Je.transition=null,Q=16>t?16:t,Kt===null)var n=!1;else{if(t=Kt,Kt=null,Ri=0,G&6)throw Error($(331));var s=G;for(G|=4,B=t.current;B!==null;){var a=B,o=a.child;if(B.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(B=u;B!==null;){var h=B;switch(h.tag){case 0:case 11:case 15:Hn(8,h,a)}var d=h.child;if(d!==null)d.return=h,B=d;else for(;B!==null;){h=B;var f=h.sibling,x=h.return;if(rf(h),h===u){B=null;break}if(f!==null){f.return=x,B=f;break}B=x}}}var v=a.alternate;if(v!==null){var _=v.child;if(_!==null){v.child=null;do{var k=_.sibling;_.sibling=null,_=k}while(_!==null)}}B=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,B=o;else e:for(;B!==null;){if(a=B,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Hn(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,B=g;break e}B=a.return}}var p=t.current;for(B=p;B!==null;){o=B;var m=o.child;if(o.subtreeFlags&2064&&m!==null)m.return=o,B=m;else e:for(o=p;B!==null;){if(l=B,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Zi(9,l)}}catch(E){oe(l,l.return,E)}if(l===o){B=null;break e}var y=l.sibling;if(y!==null){y.return=l.return,B=y;break e}B=l.return}}if(G=s,lr(),xt&&typeof xt.onPostCommitFiberRoot=="function")try{xt.onPostCommitFiberRoot(Vi,t)}catch{}n=!0}return n}finally{Q=r,Je.transition=e}}return!1}function ju(t,e,r){e=pn(r,e),e=Vh(t,e,1),t=Zt(t,e,1),e=Pe(),t!==null&&(_s(t,1,e),Ue(t,e))}function oe(t,e,r){if(t.tag===3)ju(t,t,r);else for(;e!==null;){if(e.tag===3){ju(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(er===null||!er.has(n))){t=pn(r,t),t=Hh(e,t,1),e=Zt(e,t,1),t=Pe(),e!==null&&(_s(e,1,t),Ue(e,t));break}}e=e.return}}function Ag(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Pe(),t.pingedLanes|=t.suspendedLanes&r,xe===t&&(we&r)===r&&(ge===4||ge===3&&(we&130023424)===we&&500>ce()-Hl?vr(t,0):Vl|=r),Ue(t,e)}function ff(t,e){e===0&&(t.mode&1?(e=Is,Is<<=1,!(Is&130023424)&&(Is=4194304)):e=1);var r=Pe();t=Rt(t,e),t!==null&&(_s(t,e,r),Ue(t,r))}function Ig(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),ff(t,r)}function Lg(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error($(314))}n!==null&&n.delete(e),ff(t,r)}var pf;pf=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||$e.current)Le=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return Le=!1,_g(t,e,r);Le=!!(t.flags&131072)}else Le=!1,te&&e.flags&1048576&&yh(e,_i,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;ii(t,e),t=e.pendingProps;var s=un(e,Se.current);on(e,r),s=Ml(null,e,n,t,s,r);var a=Fl();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,De(n)?(a=!0,wi(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Il(e),s.updater=Xi,e.stateNode=s,s._reactInternals=e,Oo(e,n,t,r),e=Lo(null,e,n,!0,a,r)):(e.tag=0,te&&a&&El(e),Ce(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(ii(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=Dg(n),t=nt(n,t),s){case 0:e=Io(null,e,n,t,r);break e;case 1:e=fu(null,e,n,t,r);break e;case 11:e=du(null,e,n,t,r);break e;case 14:e=hu(null,e,n,nt(n.type,t),r);break e}throw Error($(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:nt(n,s),Io(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:nt(n,s),fu(t,e,n,s,r);case 3:e:{if(Jh(e),t===null)throw Error($(387));n=e.pendingProps,a=e.memoizedState,s=a.element,jh(t,e),Ni(e,n,null,r);var o=e.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=pn(Error($(423)),e),e=pu(t,e,n,r,s);break e}else if(n!==s){s=pn(Error($(424)),e),e=pu(t,e,n,r,s);break e}else for(Be=Xt(e.stateNode.containerInfo.firstChild),ze=e,te=!0,at=null,r=bh(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(dn(),n===s){e=Ot(t,e,r);break e}Ce(t,e,n,r)}e=e.child}return e;case 5:return kh(e),t===null&&Po(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,o=s.children,ko(n,s)?o=null:a!==null&&ko(n,a)&&(e.flags|=32),Qh(t,e),Ce(t,e,o,r),e.child;case 6:return t===null&&Po(e),null;case 13:return Yh(t,e,r);case 4:return Ll(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=hn(e,null,n,r):Ce(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:nt(n,s),du(t,e,n,s,r);case 7:return Ce(t,e,e.pendingProps,r),e.child;case 8:return Ce(t,e,e.pendingProps.children,r),e.child;case 12:return Ce(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,o=s.value,Y(ji,n._currentValue),n._currentValue=o,a!==null)if(ut(a.value,o)){if(a.children===s.children&&!$e.current){e=Ot(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=Ct(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),To(a.return,r,e),l.lanes|=r;break}c=c.next}}else if(a.tag===10)o=a.type===e.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error($(341));o.lanes|=r,l=o.alternate,l!==null&&(l.lanes|=r),To(o,r,e),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===e){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}Ce(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,on(e,r),s=Ze(s),n=n(s),e.flags|=1,Ce(t,e,n,r),e.child;case 14:return n=e.type,s=nt(n,e.pendingProps),s=nt(n.type,s),hu(t,e,n,s,r);case 15:return Kh(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:nt(n,s),ii(t,e),e.tag=1,De(n)?(t=!0,wi(e)):t=!1,on(e,r),Wh(e,n,s),Oo(e,n,s,r),Lo(null,e,n,!0,t,r);case 19:return Xh(t,e,r);case 22:return Gh(t,e,r)}throw Error($(156,e.tag))};function mf(t,e){return Bd(t,e)}function $g(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qe(t,e,r,n){return new $g(t,e,r,n)}function Jl(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Dg(t){if(typeof t=="function")return Jl(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ml)return 11;if(t===gl)return 14}return 2}function rr(t,e){var r=t.alternate;return r===null?(r=Qe(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function li(t,e,r,n,s,a){var o=2;if(n=t,typeof t=="function")Jl(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Vr:return wr(r.children,s,a,e);case pl:o=8,s|=8;break;case to:return t=Qe(12,r,e,s|2),t.elementType=to,t.lanes=a,t;case ro:return t=Qe(13,r,e,s),t.elementType=ro,t.lanes=a,t;case no:return t=Qe(19,r,e,s),t.elementType=no,t.lanes=a,t;case kd:return ta(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _d:o=10;break e;case jd:o=9;break e;case ml:o=11;break e;case gl:o=14;break e;case Bt:o=16,n=null;break e}throw Error($(130,t==null?t:typeof t,""))}return e=Qe(o,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function wr(t,e,r,n){return t=Qe(7,t,n,e),t.lanes=r,t}function ta(t,e,r,n){return t=Qe(22,t,n,e),t.elementType=kd,t.lanes=r,t.stateNode={isHidden:!1},t}function Fa(t,e,r){return t=Qe(6,t,null,e),t.lanes=r,t}function Ba(t,e,r){return e=Qe(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ug(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ba(0),this.expirationTimes=ba(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ba(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Yl(t,e,r,n,s,a,o,l,c){return t=new Ug(t,e,r,l,c),e===1?(e=1,a===!0&&(e|=8)):e=0,a=Qe(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Il(a),t}function Mg(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wr,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function gf(t){if(!t)return ir;t=t._reactInternals;e:{if(Pr(t)!==t||t.tag!==1)throw Error($(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(De(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error($(171))}if(t.tag===1){var r=t.type;if(De(r))return mh(t,r,e)}return e}function yf(t,e,r,n,s,a,o,l,c){return t=Yl(r,n,!0,t,s,a,o,l,c),t.context=gf(null),r=t.current,n=Pe(),s=tr(r),a=Ct(n,s),a.callback=e??null,Zt(r,a,s),t.current.lanes=s,_s(t,s,n),Ue(t,n),t}function ra(t,e,r,n){var s=e.current,a=Pe(),o=tr(s);return r=gf(r),e.context===null?e.context=r:e.pendingContext=r,e=Ct(a,o),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=Zt(s,e,o),t!==null&&(ct(t,s,o,a),ri(t,s,o)),o}function Ai(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ku(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Xl(t,e){ku(t,e),(t=t.alternate)&&ku(t,e)}function Fg(){return null}var xf=typeof reportError=="function"?reportError:function(t){console.error(t)};function Zl(t){this._internalRoot=t}na.prototype.render=Zl.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error($(409));ra(t,e,null,null)};na.prototype.unmount=Zl.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Nr(function(){ra(null,t,null,null)}),e[Tt]=null}};function na(t){this._internalRoot=t}na.prototype.unstable_scheduleHydration=function(t){if(t){var e=Gd();t={blockedOn:null,target:t,priority:e};for(var r=0;r<qt.length&&e!==0&&e<qt[r].priority;r++);qt.splice(r,0,t),r===0&&Jd(t)}};function ec(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function sa(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Nu(){}function Bg(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=Ai(o);a.call(u)}}var o=yf(e,n,t,0,null,!1,!1,"",Nu);return t._reactRootContainer=o,t[Tt]=o.current,as(t.nodeType===8?t.parentNode:t),Nr(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var l=n;n=function(){var u=Ai(c);l.call(u)}}var c=Yl(t,0,!1,null,null,!1,!1,"",Nu);return t._reactRootContainer=c,t[Tt]=c.current,as(t.nodeType===8?t.parentNode:t),Nr(function(){ra(e,c,r,n)}),c}function ia(t,e,r,n,s){var a=r._reactRootContainer;if(a){var o=a;if(typeof s=="function"){var l=s;s=function(){var c=Ai(o);l.call(c)}}ra(e,o,t,s)}else o=Bg(r,e,t,s,n);return Ai(o)}Hd=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Dn(e.pendingLanes);r!==0&&(vl(e,r|1),Ue(e,ce()),!(G&6)&&(mn=ce()+500,lr()))}break;case 13:Nr(function(){var n=Rt(t,1);if(n!==null){var s=Pe();ct(n,t,1,s)}}),Xl(t,1)}};wl=function(t){if(t.tag===13){var e=Rt(t,134217728);if(e!==null){var r=Pe();ct(e,t,134217728,r)}Xl(t,134217728)}};Kd=function(t){if(t.tag===13){var e=tr(t),r=Rt(t,e);if(r!==null){var n=Pe();ct(r,t,e,n)}Xl(t,e)}};Gd=function(){return Q};Qd=function(t,e){var r=Q;try{return Q=t,e()}finally{Q=r}};po=function(t,e,r){switch(e){case"input":if(ao(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=Qi(n);if(!s)throw Error($(90));Sd(n),ao(n,s)}}}break;case"textarea":Cd(t,r);break;case"select":e=r.value,e!=null&&rn(t,!!r.multiple,e,!1)}};Ld=Kl;$d=Nr;var zg={usingClientEntryPoint:!1,Events:[ks,Qr,Qi,Ad,Id,Kl]},An={findFiberByHostInstance:gr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qg={bundleType:An.bundleType,version:An.version,rendererPackageName:An.rendererPackageName,rendererConfig:An.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:At.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Md(t),t===null?null:t.stateNode},findFiberByHostInstance:An.findFiberByHostInstance||Fg,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vs=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vs.isDisabled&&Vs.supportsFiber)try{Vi=Vs.inject(qg),xt=Vs}catch{}}We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zg;We.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ec(e))throw Error($(200));return Mg(t,e,null,r)};We.createRoot=function(t,e){if(!ec(t))throw Error($(299));var r=!1,n="",s=xf;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Yl(t,1,!1,null,null,r,!1,n,s),t[Tt]=e.current,as(t.nodeType===8?t.parentNode:t),new Zl(e)};We.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error($(188)):(t=Object.keys(t).join(","),Error($(268,t)));return t=Md(e),t=t===null?null:t.stateNode,t};We.flushSync=function(t){return Nr(t)};We.hydrate=function(t,e,r){if(!sa(e))throw Error($(200));return ia(null,t,e,!0,r)};We.hydrateRoot=function(t,e,r){if(!ec(t))throw Error($(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",o=xf;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(o=r.onRecoverableError)),e=yf(e,null,t,1,r??null,s,!1,a,o),t[Tt]=e.current,as(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new na(e)};We.render=function(t,e,r){if(!sa(e))throw Error($(200));return ia(null,t,e,!1,r)};We.unmountComponentAtNode=function(t){if(!sa(t))throw Error($(40));return t._reactRootContainer?(Nr(function(){ia(null,null,t,!1,function(){t._reactRootContainer=null,t[Tt]=null})}),!0):!1};We.unstable_batchedUpdates=Kl;We.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!sa(r))throw Error($(200));if(t==null||t._reactInternals===void 0)throw Error($(38));return ia(t,e,r,!1,n)};We.version="18.3.1-next-f1338f8080-20240426";function vf(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(vf)}catch(t){console.error(t)}}vf(),xd.exports=We;var Wg=xd.exports,wf,Su=Wg;wf=Su.createRoot,Su.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ms(){return ms=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ms.apply(this,arguments)}var Gt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Gt||(Gt={}));const Eu="popstate";function Vg(t){t===void 0&&(t={});function e(n,s){let{pathname:a,search:o,hash:l}=n.location;return Ii("",{pathname:a,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:gs(s)}return bf(e,r,null,t)}function Hg(t){t===void 0&&(t={});function e(s,a){let{pathname:o="/",search:l="",hash:c=""}=Tr(s.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),Ii("",{pathname:o,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(s,a){let o=s.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=s.location.href,u=c.indexOf("#");l=u===-1?c:c.slice(0,u)}return l+"#"+(typeof a=="string"?a:gs(a))}function n(s,a){tc(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(a)+")")}return bf(e,r,n,t)}function ie(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function tc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Kg(){return Math.random().toString(36).substr(2,8)}function Cu(t,e){return{usr:t.state,key:t.key,idx:e}}function Ii(t,e,r,n){return r===void 0&&(r=null),ms({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Tr(e):e,{state:r,key:e&&e.key||n||Kg()})}function gs(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Tr(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function bf(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,o=s.history,l=Gt.Pop,c=null,u=h();u==null&&(u=0,o.replaceState(ms({},o.state,{idx:u}),""));function h(){return(o.state||{idx:null}).idx}function d(){l=Gt.Pop;let k=h(),g=k==null?null:k-u;u=k,c&&c({action:l,location:_.location,delta:g})}function f(k,g){l=Gt.Push;let p=Ii(_.location,k,g);r&&r(p,k),u=h()+1;let m=Cu(p,u),y=_.createHref(p);try{o.pushState(m,"",y)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(y)}a&&c&&c({action:l,location:_.location,delta:1})}function x(k,g){l=Gt.Replace;let p=Ii(_.location,k,g);r&&r(p,k),u=h();let m=Cu(p,u),y=_.createHref(p);o.replaceState(m,"",y),a&&c&&c({action:l,location:_.location,delta:0})}function v(k){let g=s.location.origin!=="null"?s.location.origin:s.location.href,p=typeof k=="string"?k:gs(k);return p=p.replace(/ $/,"%20"),ie(g,"No window.location.(origin|href) available to create URL for href: "+p),new URL(p,g)}let _={get action(){return l},get location(){return t(s,o)},listen(k){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Eu,d),c=k,()=>{s.removeEventListener(Eu,d),c=null}},createHref(k){return e(s,k)},createURL:v,encodeLocation(k){let g=v(k);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:x,go(k){return o.go(k)}};return _}var Pu;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Pu||(Pu={}));function Gg(t,e,r){return r===void 0&&(r="/"),Qg(t,e,r,!1)}function Qg(t,e,r,n){let s=typeof e=="string"?Tr(e):e,a=gn(s.pathname||"/",r);if(a==null)return null;let o=_f(t);Jg(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=o0(a);l=i0(o[c],u,n)}return l}function _f(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(ie(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=nr([n,c.relativePath]),h=r.concat(c);a.children&&a.children.length>0&&(ie(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),_f(a.children,e,h,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:n0(u,a.index),routesMeta:h})};return t.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,o);else for(let c of jf(a.path))s(a,o,c)}),e}function jf(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let o=jf(n.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function Jg(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:s0(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Yg=/^:[\w-]+$/,Xg=3,Zg=2,e0=1,t0=10,r0=-2,Tu=t=>t==="*";function n0(t,e){let r=t.split("/"),n=r.length;return r.some(Tu)&&(n+=r0),e&&(n+=Zg),r.filter(s=>!Tu(s)).reduce((s,a)=>s+(Yg.test(a)?Xg:a===""?e0:t0),n)}function s0(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function i0(t,e,r){let{routesMeta:n}=t,s={},a="/",o=[];for(let l=0;l<n.length;++l){let c=n[l],u=l===n.length-1,h=a==="/"?e:e.slice(a.length)||"/",d=Li({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),f=c.route;if(!d&&u&&r&&!n[n.length-1].route.index&&(d=Li({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!d)return null;Object.assign(s,d.params),o.push({params:s,pathname:nr([a,d.pathname]),pathnameBase:d0(nr([a,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(a=nr([a,d.pathnameBase]))}return o}function Li(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=a0(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:n.reduce((u,h,d)=>{let{paramName:f,isOptional:x}=h;if(f==="*"){let _=l[d]||"";o=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const v=l[d];return x&&!v?u[f]=void 0:u[f]=(v||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:o,pattern:t}}function a0(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),tc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(n.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function o0(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return tc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function gn(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function l0(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?Tr(t):t;return{pathname:r?r.startsWith("/")?r:c0(r,e):e,search:h0(n),hash:f0(s)}}function c0(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function za(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function u0(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function rc(t,e){let r=u0(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function nc(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=Tr(t):(s=ms({},t),ie(!s.pathname||!s.pathname.includes("?"),za("?","pathname","search",s)),ie(!s.pathname||!s.pathname.includes("#"),za("#","pathname","hash",s)),ie(!s.search||!s.search.includes("#"),za("#","search","hash",s)));let a=t===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=r;else{let d=e.length-1;if(!n&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),d-=1;s.pathname=f.join("/")}l=d>=0?e[d]:"/"}let c=l0(s,l),u=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const nr=t=>t.join("/").replace(/\/\/+/g,"/"),d0=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),h0=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,f0=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function p0(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const kf=["post","put","patch","delete"];new Set(kf);const m0=["get",...kf];new Set(m0);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ys(){return ys=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ys.apply(this,arguments)}const aa=b.createContext(null),Nf=b.createContext(null),It=b.createContext(null),oa=b.createContext(null),Lt=b.createContext({outlet:null,matches:[],isDataRoute:!1}),Sf=b.createContext(null);function g0(t,e){let{relative:r}=e===void 0?{}:e;jn()||ie(!1);let{basename:n,navigator:s}=b.useContext(It),{hash:a,pathname:o,search:l}=la(t,{relative:r}),c=o;return n!=="/"&&(c=o==="/"?n:nr([n,o])),s.createHref({pathname:c,search:l,hash:a})}function jn(){return b.useContext(oa)!=null}function Rr(){return jn()||ie(!1),b.useContext(oa).location}function Ef(t){b.useContext(It).static||b.useLayoutEffect(t)}function dt(){let{isDataRoute:t}=b.useContext(Lt);return t?P0():y0()}function y0(){jn()||ie(!1);let t=b.useContext(aa),{basename:e,future:r,navigator:n}=b.useContext(It),{matches:s}=b.useContext(Lt),{pathname:a}=Rr(),o=JSON.stringify(rc(s,r.v7_relativeSplatPath)),l=b.useRef(!1);return Ef(()=>{l.current=!0}),b.useCallback(function(u,h){if(h===void 0&&(h={}),!l.current)return;if(typeof u=="number"){n.go(u);return}let d=nc(u,JSON.parse(o),a,h.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:nr([e,d.pathname])),(h.replace?n.replace:n.push)(d,h.state,h)},[e,n,o,a,t])}function Cf(){let{matches:t}=b.useContext(Lt),e=t[t.length-1];return e?e.params:{}}function la(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=b.useContext(It),{matches:s}=b.useContext(Lt),{pathname:a}=Rr(),o=JSON.stringify(rc(s,n.v7_relativeSplatPath));return b.useMemo(()=>nc(t,JSON.parse(o),a,r==="path"),[t,o,a,r])}function x0(t,e){return v0(t,e)}function v0(t,e,r,n){jn()||ie(!1);let{navigator:s}=b.useContext(It),{matches:a}=b.useContext(Lt),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Rr(),h;if(e){var d;let k=typeof e=="string"?Tr(e):e;c==="/"||(d=k.pathname)!=null&&d.startsWith(c)||ie(!1),h=k}else h=u;let f=h.pathname||"/",x=f;if(c!=="/"){let k=c.replace(/^\//,"").split("/");x="/"+f.replace(/^\//,"").split("/").slice(k.length).join("/")}let v=Gg(t,{pathname:x}),_=k0(v&&v.map(k=>Object.assign({},k,{params:Object.assign({},l,k.params),pathname:nr([c,s.encodeLocation?s.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?c:nr([c,s.encodeLocation?s.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),a,r,n);return e&&_?b.createElement(oa.Provider,{value:{location:ys({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Gt.Pop}},_):_}function w0(){let t=C0(),e=p0(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),r?b.createElement("pre",{style:s},r):null,null)}const b0=b.createElement(w0,null);class _0 extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?b.createElement(Lt.Provider,{value:this.props.routeContext},b.createElement(Sf.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function j0(t){let{routeContext:e,match:r,children:n}=t,s=b.useContext(aa);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),b.createElement(Lt.Provider,{value:e},n)}function k0(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,l=(s=r)==null?void 0:s.errors;if(l!=null){let h=o.findIndex(d=>d.route.id&&(l==null?void 0:l[d.route.id])!==void 0);h>=0||ie(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let h=0;h<o.length;h++){let d=o[h];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=h),d.route.id){let{loaderData:f,errors:x}=r,v=d.route.loader&&f[d.route.id]===void 0&&(!x||x[d.route.id]===void 0);if(d.route.lazy||v){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((h,d,f)=>{let x,v=!1,_=null,k=null;r&&(x=l&&d.route.id?l[d.route.id]:void 0,_=d.route.errorElement||b0,c&&(u<0&&f===0?(v=!0,k=null):u===f&&(v=!0,k=d.route.hydrateFallbackElement||null)));let g=e.concat(o.slice(0,f+1)),p=()=>{let m;return x?m=_:v?m=k:d.route.Component?m=b.createElement(d.route.Component,null):d.route.element?m=d.route.element:m=h,b.createElement(j0,{match:d,routeContext:{outlet:h,matches:g,isDataRoute:r!=null},children:m})};return r&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?b.createElement(_0,{location:r.location,revalidation:r.revalidation,component:_,error:x,children:p(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):p()},null)}var Pf=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Pf||{}),$i=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}($i||{});function N0(t){let e=b.useContext(aa);return e||ie(!1),e}function S0(t){let e=b.useContext(Nf);return e||ie(!1),e}function E0(t){let e=b.useContext(Lt);return e||ie(!1),e}function Tf(t){let e=E0(),r=e.matches[e.matches.length-1];return r.route.id||ie(!1),r.route.id}function C0(){var t;let e=b.useContext(Sf),r=S0($i.UseRouteError),n=Tf($i.UseRouteError);return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function P0(){let{router:t}=N0(Pf.UseNavigateStable),e=Tf($i.UseNavigateStable),r=b.useRef(!1);return Ef(()=>{r.current=!0}),b.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,ys({fromRouteId:e},a)))},[t,e])}function Rf(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Of(t){let{to:e,replace:r,state:n,relative:s}=t;jn()||ie(!1);let{future:a,static:o}=b.useContext(It),{matches:l}=b.useContext(Lt),{pathname:c}=Rr(),u=dt(),h=nc(e,rc(l,a.v7_relativeSplatPath),c,s==="path"),d=JSON.stringify(h);return b.useEffect(()=>u(JSON.parse(d),{replace:r,state:n,relative:s}),[u,d,s,r,n]),null}function Me(t){ie(!1)}function Af(t){let{basename:e="/",children:r=null,location:n,navigationType:s=Gt.Pop,navigator:a,static:o=!1,future:l}=t;jn()&&ie(!1);let c=e.replace(/^\/*/,"/"),u=b.useMemo(()=>({basename:c,navigator:a,static:o,future:ys({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof n=="string"&&(n=Tr(n));let{pathname:h="/",search:d="",hash:f="",state:x=null,key:v="default"}=n,_=b.useMemo(()=>{let k=gn(h,c);return k==null?null:{location:{pathname:k,search:d,hash:f,state:x,key:v},navigationType:s}},[c,h,d,f,x,v,s]);return _==null?null:b.createElement(It.Provider,{value:u},b.createElement(oa.Provider,{children:r,value:_}))}function T0(t){let{children:e,location:r}=t;return x0(Ko(e),r)}new Promise(()=>{});function Ko(t,e){e===void 0&&(e=[]);let r=[];return b.Children.forEach(t,(n,s)=>{if(!b.isValidElement(n))return;let a=[...e,s];if(n.type===b.Fragment){r.push.apply(r,Ko(n.props.children,a));return}n.type!==Me&&ie(!1),!n.props.index||!n.props.children||ie(!1);let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=Ko(n.props.children,a)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Di(){return Di=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Di.apply(this,arguments)}function If(t,e){if(t==null)return{};var r={},n=Object.keys(t),s,a;for(a=0;a<n.length;a++)s=n[a],!(e.indexOf(s)>=0)&&(r[s]=t[s]);return r}function R0(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function O0(t,e){return t.button===0&&(!e||e==="_self")&&!R0(t)}const A0=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],I0=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],L0="6";try{window.__reactRouterVersion=L0}catch{}const $0=b.createContext({isTransitioning:!1}),D0="startTransition",Ui=Ap[D0];function U0(t){let{basename:e,children:r,future:n,window:s}=t,a=b.useRef();a.current==null&&(a.current=Vg({window:s,v5Compat:!0}));let o=a.current,[l,c]=b.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},h=b.useCallback(d=>{u&&Ui?Ui(()=>c(d)):c(d)},[c,u]);return b.useLayoutEffect(()=>o.listen(h),[o,h]),b.useEffect(()=>Rf(n),[n]),b.createElement(Af,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}function M0(t){let{basename:e,children:r,future:n,window:s}=t,a=b.useRef();a.current==null&&(a.current=Hg({window:s,v5Compat:!0}));let o=a.current,[l,c]=b.useState({action:o.action,location:o.location}),{v7_startTransition:u}=n||{},h=b.useCallback(d=>{u&&Ui?Ui(()=>c(d)):c(d)},[c,u]);return b.useLayoutEffect(()=>o.listen(h),[o,h]),b.useEffect(()=>Rf(n),[n]),b.createElement(Af,{basename:e,children:r,location:l.location,navigationType:l.action,navigator:o,future:n})}const F0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",B0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sc=b.forwardRef(function(e,r){let{onClick:n,relative:s,reloadDocument:a,replace:o,state:l,target:c,to:u,preventScrollReset:h,viewTransition:d}=e,f=If(e,A0),{basename:x}=b.useContext(It),v,_=!1;if(typeof u=="string"&&B0.test(u)&&(v=u,F0))try{let m=new URL(window.location.href),y=u.startsWith("//")?new URL(m.protocol+u):new URL(u),E=gn(y.pathname,x);y.origin===m.origin&&E!=null?u=E+y.search+y.hash:_=!0}catch{}let k=g0(u,{relative:s}),g=q0(u,{replace:o,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:d});function p(m){n&&n(m),m.defaultPrevented||g(m)}return b.createElement("a",Di({},f,{href:v||k,onClick:_||a?n:p,ref:r,target:c}))}),Ru=b.forwardRef(function(e,r){let{"aria-current":n="page",caseSensitive:s=!1,className:a="",end:o=!1,style:l,to:c,viewTransition:u,children:h}=e,d=If(e,I0),f=la(c,{relative:d.relative}),x=Rr(),v=b.useContext(Nf),{navigator:_,basename:k}=b.useContext(It),g=v!=null&&W0(f)&&u===!0,p=_.encodeLocation?_.encodeLocation(f).pathname:f.pathname,m=x.pathname,y=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;s||(m=m.toLowerCase(),y=y?y.toLowerCase():null,p=p.toLowerCase()),y&&k&&(y=gn(y,k)||y);const E=p!=="/"&&p.endsWith("/")?p.length-1:p.length;let w=m===p||!o&&m.startsWith(p)&&m.charAt(E)==="/",N=y!=null&&(y===p||!o&&y.startsWith(p)&&y.charAt(p.length)==="/"),C={isActive:w,isPending:N,isTransitioning:g},T=w?n:void 0,S;typeof a=="function"?S=a(C):S=[a,w?"active":null,N?"pending":null,g?"transitioning":null].filter(Boolean).join(" ");let D=typeof l=="function"?l(C):l;return b.createElement(sc,Di({},d,{"aria-current":T,className:S,ref:r,style:D,to:c,viewTransition:u}),typeof h=="function"?h(C):h)});var Go;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Go||(Go={}));var Ou;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Ou||(Ou={}));function z0(t){let e=b.useContext(aa);return e||ie(!1),e}function q0(t,e){let{target:r,replace:n,state:s,preventScrollReset:a,relative:o,viewTransition:l}=e===void 0?{}:e,c=dt(),u=Rr(),h=la(t,{relative:o});return b.useCallback(d=>{if(O0(d,r)){d.preventDefault();let f=n!==void 0?n:gs(u)===gs(h);c(t,{replace:f,state:s,preventScrollReset:a,relative:o,viewTransition:l})}},[u,c,h,n,s,r,t,a,o,l])}function W0(t,e){e===void 0&&(e={});let r=b.useContext($0);r==null&&ie(!1);let{basename:n}=z0(Go.useViewTransitionState),s=la(t,{relative:e.relative});if(!r.isTransitioning)return!1;let a=gn(r.currentLocation.pathname,n)||r.currentLocation.pathname,o=gn(r.nextLocation.pathname,n)||r.nextLocation.pathname;return Li(s.pathname,o)!=null||Li(s.pathname,a)!=null}/*! Capacitor: https://capacitorjs.com/ - MIT License */var yn;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(yn||(yn={}));class qa extends Error{constructor(e,r,n){super(e),this.message=e,this.code=r,this.data=n}}const V0=t=>{var e,r;return t!=null&&t.androidBridge?"android":!((r=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||r===void 0)&&r.bridge?"ios":"web"},H0=t=>{const e=t.CapacitorCustomPlatform||null,r=t.Capacitor||{},n=r.Plugins=r.Plugins||{},s=()=>e!==null?e.name:V0(t),a=()=>s()!=="web",o=d=>{const f=u.get(d);return!!(f!=null&&f.platforms.has(s())||l(d))},l=d=>{var f;return(f=r.PluginHeaders)===null||f===void 0?void 0:f.find(x=>x.name===d)},c=d=>t.console.error(d),u=new Map,h=(d,f={})=>{const x=u.get(d);if(x)return console.warn(`Capacitor plugin "${d}" already registered. Cannot register plugins twice.`),x.proxy;const v=s(),_=l(d);let k;const g=async()=>(!k&&v in f?k=typeof f[v]=="function"?k=await f[v]():k=f[v]:e!==null&&!k&&"web"in f&&(k=typeof f.web=="function"?k=await f.web():k=f.web),k),p=(C,T)=>{var S,D;if(_){const M=_==null?void 0:_.methods.find(j=>T===j.name);if(M)return M.rtype==="promise"?j=>r.nativePromise(d,T.toString(),j):(j,O)=>r.nativeCallback(d,T.toString(),j,O);if(C)return(S=C[T])===null||S===void 0?void 0:S.bind(C)}else{if(C)return(D=C[T])===null||D===void 0?void 0:D.bind(C);throw new qa(`"${d}" plugin is not implemented on ${v}`,yn.Unimplemented)}},m=C=>{let T;const S=(...D)=>{const M=g().then(j=>{const O=p(j,C);if(O){const R=O(...D);return T=R==null?void 0:R.remove,R}else throw new qa(`"${d}.${C}()" is not implemented on ${v}`,yn.Unimplemented)});return C==="addListener"&&(M.remove=async()=>T()),M};return S.toString=()=>`${C.toString()}() { [capacitor code] }`,Object.defineProperty(S,"name",{value:C,writable:!1,configurable:!1}),S},y=m("addListener"),E=m("removeListener"),w=(C,T)=>{const S=y({eventName:C},T),D=async()=>{const j=await S;E({eventName:C,callbackId:j},T)},M=new Promise(j=>S.then(()=>j({remove:D})));return M.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await D()},M},N=new Proxy({},{get(C,T){switch(T){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return _?w:y;case"removeListener":return E;default:return m(T)}}});return n[d]=N,u.set(d,{name:d,proxy:N,platforms:new Set([...Object.keys(f),..._?[v]:[]])}),N};return r.convertFileSrc||(r.convertFileSrc=d=>d),r.getPlatform=s,r.handleError=c,r.isNativePlatform=a,r.isPluginAvailable=o,r.registerPlugin=h,r.Exception=qa,r.DEBUG=!!r.DEBUG,r.isLoggingEnabled=!!r.isLoggingEnabled,r},K0=t=>t.Capacitor=H0(t),Mi=K0(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),ic=Mi.registerPlugin;class ac{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,r){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(r);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),n&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,r);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,r,n){const s=this.listeners[e];if(!s){if(n){let a=this.retainedEventArguments[e];a||(a=[]),a.push(r),this.retainedEventArguments[e]=a}return}s.forEach(a=>a(r))}hasListeners(e){var r;return!!(!((r=this.listeners[e])===null||r===void 0)&&r.length)}registerWindowListener(e,r){this.windowListeners[r]={registered:!1,windowEventName:e,pluginEventName:r,handler:n=>{this.notifyListeners(r,n)}}}unimplemented(e="not implemented"){return new Mi.Exception(e,yn.Unimplemented)}unavailable(e="not available"){return new Mi.Exception(e,yn.Unavailable)}async removeListener(e,r){const n=this.listeners[e];if(!n)return;const s=n.indexOf(r);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const r=this.retainedEventArguments[e];r&&(delete this.retainedEventArguments[e],r.forEach(n=>{this.notifyListeners(e,n)}))}}const Au=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Iu=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class G0 extends ac{async getCookies(){const e=document.cookie,r={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[s,a]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=Iu(s).trim(),a=Iu(a).trim(),r[s]=a}),r}async setCookie(e){try{const r=Au(e.key),n=Au(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,a=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${r}=${n||""}${s}; path=${a}; ${o};`}catch(r){return Promise.reject(r)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(r){return Promise.reject(r)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const r of e)document.cookie=r.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}ic("CapacitorCookies",{web:()=>new G0});const Q0=async t=>new Promise((e,r)=>{const n=new FileReader;n.onload=()=>{const s=n.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},n.onerror=s=>r(s),n.readAsDataURL(t)}),J0=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(s=>s.toLocaleLowerCase()).reduce((s,a,o)=>(s[a]=t[e[o]],s),{})},Y0=(t,e=!0)=>t?Object.entries(t).reduce((n,s)=>{const[a,o]=s;let l,c;return Array.isArray(o)?(c="",o.forEach(u=>{l=e?encodeURIComponent(u):u,c+=`${a}=${l}&`}),c.slice(0,-1)):(l=e?encodeURIComponent(o):o,c=`${a}=${l}`),`${n}&${c}`},"").substr(1):null,X0=(t,e={})=>{const r=Object.assign({method:t.method||"GET",headers:t.headers},e),s=J0(t.headers)["content-type"]||"";if(typeof t.data=="string")r.body=t.data;else if(s.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[o,l]of Object.entries(t.data||{}))a.set(o,l);r.body=a.toString()}else if(s.includes("multipart/form-data")||t.data instanceof FormData){const a=new FormData;if(t.data instanceof FormData)t.data.forEach((l,c)=>{a.append(c,l)});else for(const l of Object.keys(t.data))a.append(l,t.data[l]);r.body=a;const o=new Headers(r.headers);o.delete("content-type"),r.headers=o}else(s.includes("application/json")||typeof t.data=="object")&&(r.body=JSON.stringify(t.data));return r};class Z0 extends ac{async request(e){const r=X0(e,e.webFetchExtra),n=Y0(e.params,e.shouldEncodeUrlParams),s=n?`${e.url}?${n}`:e.url,a=await fetch(s,r),o=a.headers.get("content-type")||"";let{responseType:l="text"}=a.ok?e:{};o.includes("application/json")&&(l="json");let c,u;switch(l){case"arraybuffer":case"blob":u=await a.blob(),c=await Q0(u);break;case"json":c=await a.json();break;case"document":case"text":default:c=await a.text()}const h={};return a.headers.forEach((d,f)=>{h[f]=d}),{data:c,headers:h,status:a.status,url:a.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}ic("CapacitorHttp",{web:()=>new Z0});var Lu;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(Lu||(Lu={}));var $u;(function(t){t.StatusBar="StatusBar",t.NavigationBar="NavigationBar"})($u||($u={}));class ey extends ac{async setStyle(){this.unavailable("not available for web")}async setAnimation(){this.unavailable("not available for web")}async show(){this.unavailable("not available for web")}async hide(){this.unavailable("not available for web")}}ic("SystemBars",{web:()=>new ey});const ty="modulepreload",ry=function(t){return"/"+t},Du={},Ss=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=ry(c),c in Du)return;Du[c]=!0;const u=c.endsWith(".css"),h=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":ty,u||(d.as="script"),d.crossOrigin="",d.href=c,l&&d.setAttribute("nonce",l),document.head.appendChild(d),u)return new Promise((f,x)=>{d.addEventListener("load",f),d.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})},ny=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Ss(async()=>{const{default:n}=await Promise.resolve().then(()=>kn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)};class oc extends Error{constructor(e,r="FunctionsError",n){super(e),this.name=r,this.context=n}}class sy extends oc{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Uu extends oc{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Mu extends oc{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Qo;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Qo||(Qo={}));var iy=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(h){try{u(n.next(h))}catch(d){o(d)}}function c(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):s(h.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class ay{constructor(e,{headers:r={},customFetch:n,region:s=Qo.Any}={}){this.url=e,this.headers=r,this.region=s,this.fetch=ny(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var n;return iy(this,void 0,void 0,function*(){try{const{headers:s,method:a,body:o}=r;let l={},{region:c}=r;c||(c=this.region);const u=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let h;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",h=o):typeof o=="string"?(l["Content-Type"]="text/plain",h=o):typeof FormData<"u"&&o instanceof FormData?h=o:(l["Content-Type"]="application/json",h=JSON.stringify(o)));const d=yield this.fetch(u.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:h}).catch(_=>{throw new sy(_)}),f=d.headers.get("x-relay-error");if(f&&f==="true")throw new Uu(d);if(!d.ok)throw new Mu(d);let x=((n=d.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),v;return x==="application/json"?v=yield d.json():x==="application/octet-stream"?v=yield d.blob():x==="text/event-stream"?v=d:x==="multipart/form-data"?v=yield d.formData():v=yield d.text(),{data:v,error:null,response:d}}catch(s){return{data:null,error:s,response:s instanceof Mu||s instanceof Uu?s.context:void 0}}})}}var Ie={},lc={},ca={},Es={},ua={},da={},oy=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},xn=oy();const ly=xn.fetch,Lf=xn.fetch.bind(xn),$f=xn.Headers,cy=xn.Request,uy=xn.Response,kn=Object.freeze(Object.defineProperty({__proto__:null,Headers:$f,Request:cy,Response:uy,default:Lf,fetch:ly},Symbol.toStringTag,{value:"Module"})),dy=gp(kn);var ha={};Object.defineProperty(ha,"__esModule",{value:!0});let hy=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};ha.default=hy;var Df=Xe&&Xe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(da,"__esModule",{value:!0});const fy=Df(dy),py=Df(ha);let my=class{constructor(e){var r,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(r=e.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=e.signal,this.isMaybeSingle=(n=e.isMaybeSingle)!==null&&n!==void 0?n:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=fy.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,r){return this.headers=new Headers(this.headers),this.headers.set(e,r),this}then(e,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var o,l,c,u;let h=null,d=null,f=null,x=a.status,v=a.statusText;if(a.ok){if(this.method!=="HEAD"){const p=await a.text();p===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((o=this.headers.get("Accept"))===null||o===void 0)&&o.includes("application/vnd.pgrst.plan+text"))?d=p:d=JSON.parse(p))}const k=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),g=(c=a.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");k&&g&&g.length>1&&(f=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(h={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,f=null,x=406,v="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const k=await a.text();try{h=JSON.parse(k),Array.isArray(h)&&a.status===404&&(d=[],h=null,x=200,v="OK")}catch{a.status===404&&k===""?(x=204,v="No Content"):h={message:k}}if(h&&this.isMaybeSingle&&(!((u=h==null?void 0:h.details)===null||u===void 0)&&u.includes("0 rows"))&&(h=null,x=200,v="OK"),h&&this.shouldThrowOnError)throw new py.default(h)}return{error:h,data:d,count:f,status:x,statusText:v}});return this.shouldThrowOnError||(s=s.catch(a=>{var o,l,c;return{error:{message:`${(o=a==null?void 0:a.name)!==null&&o!==void 0?o:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(l=a==null?void 0:a.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,r)}returns(){return this}overrideTypes(){return this}};da.default=my;var gy=Xe&&Xe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ua,"__esModule",{value:!0});const yy=gy(da);let xy=class extends yy.default{select(e){let r=!1;const n=(e??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:a=s}={}){const o=a?`${a}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${e}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,r,{foreignTable:n,referencedTable:s=n}={}){const a=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(o,`${r-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:a=!1,format:o="text"}={}){var l;const c=[e?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`),o==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};ua.default=xy;var vy=Xe&&Xe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Es,"__esModule",{value:!0});const wy=vy(ua);let by=class extends wy.default{eq(e,r){return this.url.searchParams.append(e,`eq.${r}`),this}neq(e,r){return this.url.searchParams.append(e,`neq.${r}`),this}gt(e,r){return this.url.searchParams.append(e,`gt.${r}`),this}gte(e,r){return this.url.searchParams.append(e,`gte.${r}`),this}lt(e,r){return this.url.searchParams.append(e,`lt.${r}`),this}lte(e,r){return this.url.searchParams.append(e,`lte.${r}`),this}like(e,r){return this.url.searchParams.append(e,`like.${r}`),this}likeAllOf(e,r){return this.url.searchParams.append(e,`like(all).{${r.join(",")}}`),this}likeAnyOf(e,r){return this.url.searchParams.append(e,`like(any).{${r.join(",")}}`),this}ilike(e,r){return this.url.searchParams.append(e,`ilike.${r}`),this}ilikeAllOf(e,r){return this.url.searchParams.append(e,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(e,r){return this.url.searchParams.append(e,`ilike(any).{${r.join(",")}}`),this}is(e,r){return this.url.searchParams.append(e,`is.${r}`),this}in(e,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}contains(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cs.{${r.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(r)}`),this}containedBy(e,r){return typeof r=="string"?this.url.searchParams.append(e,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(e,`cd.{${r.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(r)}`),this}rangeGt(e,r){return this.url.searchParams.append(e,`sr.${r}`),this}rangeGte(e,r){return this.url.searchParams.append(e,`nxl.${r}`),this}rangeLt(e,r){return this.url.searchParams.append(e,`sl.${r}`),this}rangeLte(e,r){return this.url.searchParams.append(e,`nxr.${r}`),this}rangeAdjacent(e,r){return this.url.searchParams.append(e,`adj.${r}`),this}overlaps(e,r){return typeof r=="string"?this.url.searchParams.append(e,`ov.${r}`):this.url.searchParams.append(e,`ov.{${r.join(",")}}`),this}textSearch(e,r,{config:n,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const o=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${a}fts${o}.${r}`),this}match(e){return Object.entries(e).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(e,r,n){return this.url.searchParams.append(e,`not.${r}.${n}`),this}or(e,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,r,n){return this.url.searchParams.append(e,`${r}.${n}`),this}};Es.default=by;var _y=Xe&&Xe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ca,"__esModule",{value:!0});const In=_y(Es);let jy=class{constructor(e,{headers:r={},schema:n,fetch:s}){this.url=e,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(e,{head:r=!1,count:n}={}){const s=r?"HEAD":"GET";let a=!1;const o=(e??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),n&&this.headers.append("Prefer",`count=${n}`),new In.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:r,defaultToNull:n=!0}={}){var s;const a="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new In.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:a=!0}={}){var o;const l="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new In.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}update(e,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new In.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:e}={}){var r;const n="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new In.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};ca.default=jy;var Uf=Xe&&Xe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(lc,"__esModule",{value:!0});const ky=Uf(ca),Ny=Uf(Es);let Sy=class Mf{constructor(e,{headers:r={},schema:n,fetch:s}={}){this.url=e,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(e){const r=new URL(`${this.url}/${e}`);return new ky.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Mf(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,r={},{head:n=!1,get:s=!1,count:a}={}){var o;let l;const c=new URL(`${this.url}/rpc/${e}`);let u;n||s?(l=n?"HEAD":"GET",Object.entries(r).filter(([d,f])=>f!==void 0).map(([d,f])=>[d,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([d,f])=>{c.searchParams.append(d,f)})):(l="POST",u=r);const h=new Headers(this.headers);return a&&h.set("Prefer",`count=${a}`),new Ny.default({method:l,url:c,headers:h,schema:this.schemaName,body:u,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}};lc.default=Sy;var Nn=Xe&&Xe.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ie,"__esModule",{value:!0});Ie.PostgrestError=Ie.PostgrestBuilder=Ie.PostgrestTransformBuilder=Ie.PostgrestFilterBuilder=Ie.PostgrestQueryBuilder=Ie.PostgrestClient=void 0;const Ff=Nn(lc);Ie.PostgrestClient=Ff.default;const Bf=Nn(ca);Ie.PostgrestQueryBuilder=Bf.default;const zf=Nn(Es);Ie.PostgrestFilterBuilder=zf.default;const qf=Nn(ua);Ie.PostgrestTransformBuilder=qf.default;const Wf=Nn(da);Ie.PostgrestBuilder=Wf.default;const Vf=Nn(ha);Ie.PostgrestError=Vf.default;var Ey=Ie.default={PostgrestClient:Ff.default,PostgrestQueryBuilder:Bf.default,PostgrestFilterBuilder:zf.default,PostgrestTransformBuilder:qf.default,PostgrestBuilder:Wf.default,PostgrestError:Vf.default};const{PostgrestClient:Cy,PostgrestQueryBuilder:uw,PostgrestFilterBuilder:dw,PostgrestTransformBuilder:hw,PostgrestBuilder:fw,PostgrestError:pw}=Ey;class Py{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const n=this.getWebSocketConstructor();return new n(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Ty="2.15.5",Ry=`realtime-js/${Ty}`,Oy="1.0.0",Jo=1e4,Ay=1e3,Iy=100;var Qn;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Qn||(Qn={}));var fe;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(fe||(fe={}));var it;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(it||(it={}));var Yo;(function(t){t.websocket="websocket"})(Yo||(Yo={}));var mr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(mr||(mr={}));class Ly{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,r,n)}_decodeBroadcast(e,r,n){const s=r.getUint8(1),a=r.getUint8(2);let o=this.HEADER_LENGTH+2;const l=n.decode(e.slice(o,o+s));o=o+s;const c=n.decode(e.slice(o,o+a));o=o+a;const u=JSON.parse(n.decode(e.slice(o,e.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class Hf{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var J;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(J||(J={}));const Fu=(t,e,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(e).reduce((a,o)=>(a[o]=$y(o,t,e,s),a),{})},$y=(t,e,r,n)=>{const s=e.find(l=>l.name===t),a=s==null?void 0:s.type,o=r[t];return a&&!n.includes(a)?Kf(a,o):Xo(o)},Kf=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return Fy(e,r)}switch(t){case J.bool:return Dy(e);case J.float4:case J.float8:case J.int2:case J.int4:case J.int8:case J.numeric:case J.oid:return Uy(e);case J.json:case J.jsonb:return My(e);case J.timestamp:return By(e);case J.abstime:case J.date:case J.daterange:case J.int4range:case J.int8range:case J.money:case J.reltime:case J.text:case J.time:case J.timestamptz:case J.timetz:case J.tsrange:case J.tstzrange:return Xo(e);default:return Xo(e)}},Xo=t=>t,Dy=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Uy=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},My=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Fy=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,n=t[r];if(t[0]==="{"&&n==="}"){let a;const o=t.slice(1,r);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Kf(e,l))}return t},By=t=>typeof t=="string"?t.replace(" ","T"):t,Gf=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Wa{constructor(e,r,n={},s=Jo){this.channel=e,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var n;return this._hasReceived(e)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Bu;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Bu||(Bu={}));class Jn{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Jn.syncState(this.state,s,a,o),this.pendingDiffs.forEach(c=>{this.state=Jn.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Jn.syncDiff(this.state,s,a,o),l())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,n,s){const a=this.cloneDeep(e),o=this.transformState(r),l={},c={};return this.map(a,(u,h)=>{o[u]||(c[u]=h)}),this.map(o,(u,h)=>{const d=a[u];if(d){const f=h.map(k=>k.presence_ref),x=d.map(k=>k.presence_ref),v=h.filter(k=>x.indexOf(k.presence_ref)<0),_=d.filter(k=>f.indexOf(k.presence_ref)<0);v.length>0&&(l[u]=v),_.length>0&&(c[u]=_)}else l[u]=h}),this.syncDiff(a,{joins:l,leaves:c},n,s)}static syncDiff(e,r,n,s){const{joins:a,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var u;const h=(u=e[l])!==null&&u!==void 0?u:[];if(e[l]=this.cloneDeep(c),h.length>0){const d=e[l].map(x=>x.presence_ref),f=h.filter(x=>d.indexOf(x.presence_ref)<0);e[l].unshift(...f)}n(l,h,c)}),this.map(o,(l,c)=>{let u=e[l];if(!u)return;const h=c.map(d=>d.presence_ref);u=u.filter(d=>h.indexOf(d.presence_ref)<0),e[l]=u,s(l,u,c),u.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(n=>r(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,n)=>{const s=e[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var zu;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(zu||(zu={}));var Yn;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Yn||(Yn={}));var jt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(jt||(jt={}));class cc{constructor(e,r={config:{}},n){this.topic=e,this.params=r,this.socket=n,this.bindings={},this.state=fe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Wa(this,it.join,this.params,this.timeout),this.rejoinTimer=new Hf(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=fe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=fe.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=fe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=fe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=fe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(it.reply,{},(s,a)=>{this._trigger(this._replyEventName(a),s)}),this.presence=new Jn(this),this.broadcastEndpointURL=Gf(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==fe.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(x=>x.filter))!==null&&s!==void 0?s:[],h=!!this.bindings[Yn.PRESENCE]&&this.bindings[Yn.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,d={},f={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(x=>e==null?void 0:e(jt.CHANNEL_ERROR,x)),this._onClose(()=>e==null?void 0:e(jt.CLOSED)),this.updateJoinPayload(Object.assign({config:f},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:x})=>{var v;if(this.socket.setAuth(),x===void 0){e==null||e(jt.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,k=(v=_==null?void 0:_.length)!==null&&v!==void 0?v:0,g=[];for(let p=0;p<k;p++){const m=_[p],{filter:{event:y,schema:E,table:w,filter:N}}=m,C=x&&x[p];if(C&&C.event===y&&C.schema===E&&C.table===w&&C.filter===N)g.push(Object.assign(Object.assign({},m),{id:C.id}));else{this.unsubscribe(),this.state=fe.errored,e==null||e(jt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(jt.SUBSCRIBED);return}}).receive("error",x=>{this.state=fe.errored,e==null||e(jt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(jt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,n){return this.state===fe.joined&&e===Yn.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,n)}async send(e,r={}){var n,s;if(!this._canPush()&&e.type==="broadcast"){const{event:a,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const u=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=fe.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(it.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new Wa(this,it.leave,{},e),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=fe.closed,this.bindings={}}async _fetchWithTimeout(e,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),o=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),o}_push(e,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Wa(this,e,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Iy){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,n){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,n){var s,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:u,join:h}=it;if(n&&[l,c,u,h].indexOf(o)>=0&&n!==this._joinRef())return;let f=this._onMessage(o,r,n);if(r&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(x=>{var v,_,k;return((v=x.filter)===null||v===void 0?void 0:v.event)==="*"||((k=(_=x.filter)===null||_===void 0?void 0:_.event)===null||k===void 0?void 0:k.toLocaleLowerCase())===o}).map(x=>x.callback(f,n)):(a=this.bindings[o])===null||a===void 0||a.filter(x=>{var v,_,k,g,p,m;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in x){const y=x.id,E=(v=x.filter)===null||v===void 0?void 0:v.event;return y&&((_=r.ids)===null||_===void 0?void 0:_.includes(y))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((k=r.data)===null||k===void 0?void 0:k.type.toLocaleLowerCase()))}else{const y=(p=(g=x==null?void 0:x.filter)===null||g===void 0?void 0:g.event)===null||p===void 0?void 0:p.toLocaleLowerCase();return y==="*"||y===((m=r==null?void 0:r.event)===null||m===void 0?void 0:m.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===o}).map(x=>{if(typeof f=="object"&&"ids"in f){const v=f.data,{schema:_,table:k,commit_timestamp:g,type:p,errors:m}=v;f=Object.assign(Object.assign({},{schema:_,table:k,commit_timestamp:g,eventType:p,new:{},old:{},errors:m}),this._getPayloadRecords(v))}x.callback(f,n)})}_isClosed(){return this.state===fe.closed}_isJoined(){return this.state===fe.joined}_isJoining(){return this.state===fe.joining}_isLeaving(){return this.state===fe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,n){const s=e.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,r){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&cc.isEqual(s.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(e[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(it.close,{},e)}_onError(e){this._on(it.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=fe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Fu(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Fu(e.columns,e.old_record)),r}}const Va=()=>{},Hs={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},zy=[1e3,2e3,5e3,1e4],qy=1e4,Wy=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Vy{constructor(e,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Jo,this.transport=null,this.heartbeatIntervalMs=Hs.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Va,this.ref=0,this.reconnectTimer=null,this.logger=Va,this.conn=null,this.sendBuffer=[],this.serializer=new Ly,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...o)=>Ss(async()=>{const{default:l}=await Promise.resolve().then(()=>kn);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...o)=>a(...o)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Yo.websocket}`,this.httpEndpoint=Gf(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Py.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Oy}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,n){this.logger(e,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Qn.connecting:return mr.Connecting;case Qn.open:return mr.Open;case Qn.closing:return mr.Closing;default:return mr.Closed}}isConnected(){return this.connectionState()===mr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const n=`realtime:${e}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new cc(`realtime:${e}`,r,this);return this.channels.push(a),a}}push(e){const{topic:r,event:n,payload:s,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Ay,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Hs.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:o}=r,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${n} ${s} ${l}`.trim(),a),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,a,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(it.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const n=e.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${e}${n}${s}`}_workerObjectUrl(e){let r;if(e)r=e;else{const n=new Blob([Wy],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:Ry};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(it.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Hf(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Hs.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,n,s,a,o,l,c,u,h;if(this.transport=(r=e==null?void 0:e.transport)!==null&&r!==void 0?r:null,this.timeout=(n=e==null?void 0:e.timeout)!==null&&n!==void 0?n:Jo,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:Hs.HEARTBEAT_INTERVAL,this.worker=(a=e==null?void 0:e.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:Va,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=e==null?void 0:e.reconnectAfterMs)!==null&&c!==void 0?c:d=>zy[d-1]||qy,this.encode=(u=e==null?void 0:e.encode)!==null&&u!==void 0?u:(d,f)=>f(JSON.stringify(d)),this.decode=(h=e==null?void 0:e.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class uc extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function pe(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Hy extends uc{constructor(e,r,n){super(e),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Zo extends uc{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var Ky=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(h){try{u(n.next(h))}catch(d){o(d)}}function c(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):s(h.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const Qf=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Ss(async()=>{const{default:n}=await Promise.resolve().then(()=>kn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},Gy=()=>Ky(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ss(()=>Promise.resolve().then(()=>kn),void 0)).Response:Response}),el=t=>{if(Array.isArray(t))return t.map(r=>el(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[s]=el(n)}),e},Qy=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Or=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(h){try{u(n.next(h))}catch(d){o(d)}}function c(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):s(h.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const Ha=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Jy=(t,e,r)=>Or(void 0,void 0,void 0,function*(){const n=yield Gy();t instanceof n&&!(r!=null&&r.noResolveJson)?t.json().then(s=>{const a=t.status||500,o=(s==null?void 0:s.statusCode)||a+"";e(new Hy(Ha(s),a,o))}).catch(s=>{e(new Zo(Ha(s),s))}):e(new Zo(Ha(t),t))}),Yy=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!n?s:(Qy(n)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(n)):s.body=n,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),r))};function Cs(t,e,r,n,s,a){return Or(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(r,Yy(e,n,s,a)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>Jy(c,l,n))})})}function Fi(t,e,r,n){return Or(this,void 0,void 0,function*(){return Cs(t,"GET",e,r,n)})}function mt(t,e,r,n,s){return Or(this,void 0,void 0,function*(){return Cs(t,"POST",e,n,s,r)})}function tl(t,e,r,n,s){return Or(this,void 0,void 0,function*(){return Cs(t,"PUT",e,n,s,r)})}function Xy(t,e,r,n){return Or(this,void 0,void 0,function*(){return Cs(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Jf(t,e,r,n,s){return Or(this,void 0,void 0,function*(){return Cs(t,"DELETE",e,n,s,r)})}var Ee=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(h){try{u(n.next(h))}catch(d){o(d)}}function c(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):s(h.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const Zy={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},qu={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ex{constructor(e,r={},n,s){this.shouldThrowOnError=!1,this.url=e,this.headers=r,this.bucketId=n,this.fetch=Qf(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,r,n,s){return Ee(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},qu),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=n,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(r),h=this._getFinalPath(u),d=yield(e=="PUT"?tl:mt)(this.fetch,`${this.url}/object/${h}`,a,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(pe(a))return{data:null,error:a};throw a}})}upload(e,r,n){return Ee(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,n)})}uploadToSignedUrl(e,r,n,s){return Ee(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:qu.upsert},s),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,h["cache-control"]=`max-age=${u.cacheControl}`,h["content-type"]=u.contentType);const d=yield tl(this.fetch,l.toString(),c,{headers:h});return{data:{path:a,fullPath:d.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(pe(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return Ee(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const a=yield mt(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new uc("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}})}update(e,r,n){return Ee(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,n)})}move(e,r,n){return Ee(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}})}copy(e,r,n){return Ee(this,void 0,void 0,function*(){try{return{data:{path:(yield mt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}})}createSignedUrl(e,r,n){return Ee(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),a=yield mt(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const o=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}})}createSignedUrls(e,r,n){return Ee(this,void 0,void 0,function*(){try{const s=yield mt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}})}download(e,r){return Ee(this,void 0,void 0,function*(){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),o=a?`?${a}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Fi(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(pe(l))return{data:null,error:l};throw l}})}info(e){return Ee(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const n=yield Fi(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:el(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}})}exists(e){return Ee(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Xy(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n)&&n instanceof Zo){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,r){const n=this._getFinalPath(e),s=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&s.push(a);const l=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${u}`)}}}remove(e){return Ee(this,void 0,void 0,function*(){try{return{data:yield Jf(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}})}list(e,r,n){return Ee(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Zy),r),{prefix:e||""});return{data:yield mt(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(pe(s))return{data:null,error:s};throw s}})}listV2(e,r){return Ee(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield mt(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const tx="2.12.1",rx={"X-Client-Info":`storage-js/${tx}`};var Lr=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(h){try{u(n.next(h))}catch(d){o(d)}}function c(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):s(h.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class nx{constructor(e,r={},n,s){this.shouldThrowOnError=!1;const a=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href,this.headers=Object.assign(Object.assign({},rx),r),this.fetch=Qf(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Lr(this,void 0,void 0,function*(){try{return{data:yield Fi(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(pe(e))return{data:null,error:e};throw e}})}getBucket(e){return Lr(this,void 0,void 0,function*(){try{return{data:yield Fi(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Lr(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}})}updateBucket(e,r){return Lr(this,void 0,void 0,function*(){try{return{data:yield tl(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(pe(n))return{data:null,error:n};throw n}})}emptyBucket(e){return Lr(this,void 0,void 0,function*(){try{return{data:yield mt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Lr(this,void 0,void 0,function*(){try{return{data:yield Jf(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(pe(r))return{data:null,error:r};throw r}})}}class sx extends nx{constructor(e,r={},n,s){super(e,r,n,s)}from(e){return new ex(this.url,this.headers,e,this.fetch)}}const ix="2.57.4";let Mn="";typeof Deno<"u"?Mn="deno":typeof document<"u"?Mn="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Mn="react-native":Mn="node";const ax={"X-Client-Info":`supabase-js-${Mn}/${ix}`},ox={headers:ax},lx={schema:"public"},cx={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ux={};var dx=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(h){try{u(n.next(h))}catch(d){o(d)}}function c(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):s(h.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};const hx=t=>{let e;return t?e=t:typeof fetch>"u"?e=Lf:e=fetch,(...r)=>e(...r)},fx=()=>typeof Headers>"u"?$f:Headers,px=(t,e,r)=>{const n=hx(r),s=fx();return(a,o)=>dx(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",t),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(a,Object.assign(Object.assign({},o),{headers:u}))})};var mx=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(h){try{u(n.next(h))}catch(d){o(d)}}function c(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):s(h.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};function gx(t){return t.endsWith("/")?t:t+"/"}function yx(t,e){var r,n;const{db:s,auth:a,realtime:o,global:l}=t,{db:c,auth:u,realtime:h,global:d}=e,f={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},h),o),storage:{},global:Object.assign(Object.assign(Object.assign({},d),l),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=l==null?void 0:l.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>mx(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function xx(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(gx(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Yf="2.71.1",zr=30*1e3,rl=3,Ka=rl*zr,vx="http://localhost:9999",wx="supabase.auth.token",bx={"X-Client-Info":`gotrue-js/${Yf}`},nl="X-Supabase-Api-Version",Xf={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},_x=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,jx=10*60*1e3;class fa extends Error{constructor(e,r,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function V(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class kx extends fa{constructor(e,r,n){super(e,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Nx(t){return V(t)&&t.name==="AuthApiError"}class Zf extends fa{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class cr extends fa{constructor(e,r,n,s){super(e,n,s),this.name=r,this.status=n}}class Ft extends cr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Sx(t){return V(t)&&t.name==="AuthSessionMissingError"}class Ks extends cr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Gs extends cr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Qs extends cr{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ex(t){return V(t)&&t.name==="AuthImplicitGrantRedirectError"}class Wu extends cr{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class sl extends cr{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Ga(t){return V(t)&&t.name==="AuthRetryableFetchError"}class Vu extends cr{constructor(e,r,n){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class il extends cr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Hu=` 	
\r=`.split(""),Cx=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Hu.length;e+=1)t[Hu[e].charCodeAt(0)]=-2;for(let e=0;e<Bi.length;e+=1)t[Bi[e].charCodeAt(0)]=e;return t})();function Ku(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Bi[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;r(Bi[n]),e.queuedBits-=6}}function ep(t,e,r){const n=Cx[t];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Gu(t){const e=[],r=o=>{e.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{Rx(o,n,r)};for(let o=0;o<t.length;o+=1)ep(t.charCodeAt(o),s,a);return e.join("")}function Px(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Tx(t,e){for(let r=0;r<t.length;r+=1){let n=t.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(t.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}Px(n,e)}}function Rx(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let n=1;n<6;n+=1)if(!(t>>7-n&1)){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Ox(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)ep(t.charCodeAt(s),r,n);return new Uint8Array(e)}function Ax(t){const e=[];return Tx(t,r=>e.push(r)),new Uint8Array(e)}function Ix(t){const e=[],r={queue:0,queuedBits:0},n=s=>{e.push(s)};return t.forEach(s=>Ku(s,r,n)),Ku(null,r,n),e.join("")}function Lx(t){return Math.round(Date.now()/1e3)+t}function $x(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const rt=()=>typeof window<"u"&&typeof document<"u",ur={tested:!1,writable:!1},tp=()=>{if(!rt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ur.tested)return ur.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),ur.tested=!0,ur.writable=!0}catch{ur.tested=!0,ur.writable=!1}return ur.writable};function Dx(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{e[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{e[s]=n}),e}const rp=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>Ss(async()=>{const{default:n}=await Promise.resolve().then(()=>kn);return{default:n}},void 0).then(({default:n})=>n(...r)):e=fetch,(...r)=>e(...r)},Ux=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",qr=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},dr=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Dt=async(t,e)=>{await t.removeItem(e)};class pa{constructor(){this.promise=new pa.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}pa.promiseConstructor=Promise;function Qa(t){const e=t.split(".");if(e.length!==3)throw new il("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!_x.test(e[n]))throw new il("JWT not in base64url format");return{header:JSON.parse(Gu(e[0])),payload:JSON.parse(Gu(e[1])),signature:Ox(e[2]),raw:{header:e[0],payload:e[1]}}}async function Mx(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Fx(t,e){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await t(a);if(!e(a,null,o)){n(o);return}}catch(o){if(!e(a,o)){s(o);return}}})()})}function Bx(t){return("0"+t.toString(16)).substr(-2)}function zx(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(e),Array.from(e,Bx).join("")}async function qx(t){const r=new TextEncoder().encode(t),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function Wx(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await qx(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function $r(t,e,r=!1){const n=zx();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await qr(t,`${e}-code-verifier`,s);const a=await Wx(n);return[a,n===a?"plain":"s256"]}const Vx=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Hx(t){const e=t.headers.get(nl);if(!e||!e.match(Vx))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Kx(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Gx(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Qx=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Dr(t){if(!Qx.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ja(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Qu(t){return JSON.parse(JSON.stringify(t))}var Jx=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};const pr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Yx=[502,503,504];async function Ju(t){var e;if(!Ux(t))throw new sl(pr(t),0);if(Yx.includes(t.status))throw new sl(pr(t),t.status);let r;try{r=await t.json()}catch(a){throw new Zf(pr(a),a)}let n;const s=Hx(t);if(s&&s.getTime()>=Xf["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new Vu(pr(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new Ft}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Vu(pr(r),t.status,r.weak_password.reasons);throw new kx(pr(r),t.status||500,n)}const Xx=(t,e,r,n)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function H(t,e,r,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[nl]||(a[nl]=Xf["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const o=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(o.redirect_to=n.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Zx(t,e,r+l,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function Zx(t,e,r,n,s,a){const o=Xx(e,n,s,a);let l;try{l=await t(r,Object.assign({},o))}catch(c){throw console.error(c),new sl(pr(c),0)}if(l.ok||await Ju(l),n!=null&&n.noResolveJson)return l;try{return await l.json()}catch(c){await Ju(c)}}function bt(t){var e;let r=null;nv(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Lx(t.expires_in)));const n=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:n},error:null}}function Yu(t){const e=bt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Vt(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function ev(t){return{data:t,error:null}}function tv(t){const{action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=t,o=Jx(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function rv(t){return t}function nv(t){return t.access_token&&t.refresh_token&&t.expires_in}const Ya=["global","local","others"];var sv=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r};class iv{constructor({url:e="",headers:r={},fetch:n}){this.url=e,this.headers=r,this.fetch=rp(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=Ya[0]){if(Ya.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ya.join(", ")}`);try{return await H(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(V(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,r={}){try{return await H(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Vt})}catch(n){if(V(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:r}=e,n=sv(e,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await H(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:tv,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(V(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await H(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Vt})}catch(r){if(V(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,n,s,a,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},h=await H(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=e==null?void 0:e.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:rv});if(h.error)throw h.error;const d=await h.json(),f=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,x=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return x.length>0&&(x.forEach(v=>{const _=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),k=JSON.parse(v.split(";")[1].split("=")[1]);u[`${k}Page`]=_}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(V(u))return{data:{users:[]},error:u};throw u}}async getUserById(e){Dr(e);try{return await H(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Vt})}catch(r){if(V(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Dr(e);try{return await H(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:Vt})}catch(n){if(V(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,r=!1){Dr(e);try{return await H(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:Vt})}catch(n){if(V(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){Dr(e.userId);try{const{data:r,error:n}=await H(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(V(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Dr(e.userId),Dr(e.id);try{return{data:await H(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(V(r))return{data:null,error:r};throw r}}}function Xu(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function av(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ur={debug:!!(globalThis&&tp()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class np extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class ov extends np{}async function lv(t,e,r){Ur.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),Ur.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){Ur.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await r()}finally{Ur.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw Ur.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new ov(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Ur.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}av();const cv={url:vx,storageKey:wx,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:bx,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Zu(t,e,r){return await r()}const Mr={};class xs{constructor(e){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=xs.nextInstanceID,xs.nextInstanceID+=1,this.instanceID>0&&rt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},cv),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new iv({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=rp(s.fetch),this.lock=s.lock||Zu,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:rt()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=lv:this.lock=Zu,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:tp()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Xu(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Xu(this.memoryStorage)),rt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=Mr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){Mr[this.storageKey]=Object.assign(Object.assign({},Mr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=Mr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Mr[this.storageKey]=Object.assign(Object.assign({},Mr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Yf}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=Dx(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),rt()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Ex(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return V(r)?{error:r}:{error:new Zf("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,n,s;try{const a=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:bt}),{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(V(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var r,n,s;try{let a;if("email"in e){const{email:h,password:d,options:f}=e;let x=null,v=null;this.flowType==="pkce"&&([x,v]=await $r(this.storage,this.storageKey)),a=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:h,password:d,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:x,code_challenge_method:v},xform:bt})}else if("phone"in e){const{phone:h,password:d,options:f}=e;a=await H(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:d,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:bt})}else throw new Gs("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(V(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let r;if("email"in e){const{email:a,password:o,options:l}=e;r=await H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Yu})}else if("phone"in e){const{phone:a,password:o,options:l}=e;r=await H(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Yu})}else throw new Gs("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new Ks}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(V(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,n,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,n,s,a,o,l,c,u,h,d,f,x;let v,_;if("message"in e)v=e.message,_=e.signature;else{const{chain:k,wallet:g,statement:p,options:m}=e;let y;if(rt())if(typeof g=="object")y=g;else{const w=window;if("solana"in w&&typeof w.solana=="object"&&("signIn"in w.solana&&typeof w.solana.signIn=="function"||"signMessage"in w.solana&&typeof w.solana.signMessage=="function"))y=w.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=g}const E=new URL((r=m==null?void 0:m.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in y&&y.signIn){const w=await y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},m==null?void 0:m.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),p?{statement:p}:null));let N;if(Array.isArray(w)&&w[0]&&typeof w[0]=="object")N=w[0];else if(w&&typeof w=="object"&&"signedMessage"in w&&"signature"in w)N=w;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)v=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),_=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in y)||typeof y.signMessage!="function"||!("publicKey"in y)||typeof y!="object"||!y.publicKey||!("toBase58"in y.publicKey)||typeof y.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${E.host} wants you to sign in with your Solana account:`,y.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(s=(n=m==null?void 0:m.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=m==null?void 0:m.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${m.signInWithSolana.notBefore}`]:[],...!((o=m==null?void 0:m.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${m.signInWithSolana.expirationTime}`]:[],...!((l=m==null?void 0:m.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${m.signInWithSolana.chainId}`]:[],...!((c=m==null?void 0:m.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${m.signInWithSolana.nonce}`]:[],...!((u=m==null?void 0:m.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${m.signInWithSolana.requestId}`]:[],...!((d=(h=m==null?void 0:m.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||d===void 0)&&d.length?["Resources",...m.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const w=await y.signMessage(new TextEncoder().encode(v),"utf8");if(!w||!(w instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=w}}try{const{data:k,error:g}=await H(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Ix(_)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:bt});if(g)throw g;return!k||!k.session||!k.user?{data:{user:null,session:null},error:new Ks}:(k.session&&(await this._saveSession(k.session),await this._notifyAllSubscribers("SIGNED_IN",k.session)),{data:Object.assign({},k),error:g})}catch(k){if(V(k))return{data:{user:null,session:null},error:k};throw k}}async _exchangeCodeForSession(e){const r=await dr(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:a,error:o}=await H(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:bt});if(await Dt(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new Ks}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(V(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:r,provider:n,token:s,access_token:a,nonce:o}=e,l=await H(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:bt}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Ks}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(V(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,n,s,a,o;try{if("email"in e){const{email:l,options:c}=e;let u=null,h=null;this.flowType==="pkce"&&([u,h]=await $r(this.storage,this.storageKey));const{error:d}=await H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:h},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:l,options:c}=e,{data:u,error:h}=await H(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:h}}throw new Gs("You must provide either an email or phone number.")}catch(l){if(V(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var r,n;try{let s,a;"options"in e&&(s=(r=e.options)===null||r===void 0?void 0:r.redirectTo,a=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:l}=await H(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:bt});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(V(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var r,n,s;try{let a=null,o=null;return this.flowType==="pkce"&&([a,o]=await $r(this.storage,this.storageKey)),await H(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:o}),headers:this.headers,xform:ev})}catch(a){if(V(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:n}=e;if(n)throw n;if(!r)throw new Ft;const{error:s}=await H(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(V(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:n,type:s,options:a}=e,{error:o}=await H(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:n,type:s,options:a}=e,{data:o,error:l}=await H(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new Gs("You must provide either an email or phone number and a type")}catch(r){if(V(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await dr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<Ka:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const o=await dr(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=Ja()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,u,h)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,h))})}return{data:{session:e},error:null}}const{session:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Vt}):await this._useSession(async r=>{var n,s,a;const{data:o,error:l}=r;if(l)throw l;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ft}:await H(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Vt})})}catch(r){if(V(r))return Sx(r)&&(await this._removeSession(),await Dt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new Ft;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await $r(this.storage,this.storageKey));const{data:u,error:h}=await H(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Vt});if(h)throw h;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(n){if(V(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ft;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:o}=Qa(e.access_token);if(o.exp&&(n=o.exp,s=n<=r),s){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(V(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var n;if(!e){const{data:o,error:l}=r;if(l)throw l;e=(n=o.session)!==null&&n!==void 0?n:void 0}if(!(e!=null&&e.refresh_token))throw new Ft;const{session:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(V(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!rt())throw new Qs("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Qs(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new Wu("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Qs("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Wu("No code detected.");const{data:p,error:m}=await this._exchangeCodeForSession(e.code);if(m)throw m;const y=new URL(window.location.href);return y.searchParams.delete("code"),window.history.replaceState(window.history.state,"",y.toString()),{data:{session:p.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=e;if(!a||!l||!o||!u)throw new Qs("No session defined in URL");const h=Math.round(Date.now()/1e3),d=parseInt(l);let f=h+d;c&&(f=parseInt(c));const x=f-h;x*1e3<=zr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${d}s`);const v=f-d;h-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,f,h):h-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,f,h);const{data:_,error:k}=await this._getUser(a);if(k)throw k;const g={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:d,expires_at:f,refresh_token:o,token_type:u,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(n){if(V(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await dr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{error:a};const o=(n=s.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(Nx(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Dt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=$x(),n={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await $r(this.storage,this.storageKey,!0));try{return await H(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(V(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(V(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var o,l,c,u,h;const{data:d,error:f}=a;if(f)throw f;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await H(this.fetch,"GET",x,{headers:this.headers,jwt:(h=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&h!==void 0?h:void 0})});if(s)throw s;return rt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:e.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(V(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)throw o;return await H(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(V(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Fx(async s=>(s>0&&await Mx(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await H(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:bt})),(s,a)=>{const o=200*Math.pow(2,s);return a&&Ga(a)&&Date.now()+o-n<zr})}catch(n){if(this._debug(r,"error",n),V(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",n),rt()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await dr(this.storage,this.storageKey);if(s&&this.userStorage){let o=await dr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await qr(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:Ja()}else if(s&&!s.user&&!s.user){const o=await dr(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await Dt(this.storage,this.storageKey+"-user"),await qr(this.storage,this.storageKey,s)):s.user=Ja()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Ka;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${Ka}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Ga(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var r,n;if(!e)throw new Ft;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new pa;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new Ft;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={session:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),V(a)){const o={session:null,error:a};return Ga(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,r,n=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:r});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await qr(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=Qu(s);await qr(this.storage,this.storageKey,a)}else{const s=Qu(r);await qr(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Dt(this.storage,this.storageKey),await Dt(this.storage,this.storageKey+"-code-verifier"),await Dt(this.storage,this.storageKey+"-user"),this.userStorage&&await Dt(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&rt()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),zr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-e)/zr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${zr}ms, refresh threshold is ${rl} ticks`),s<=rl&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof np)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!rt()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,o]=await $r(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await H(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(V(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var n,s;const{data:a,error:o}=r;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:u}=await H(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(e.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(V(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{data:null,error:a};const{data:o,error:l}=await H(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(r){if(V(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await H(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(V(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(e==null?void 0:e.factors)||[],s=n.filter(o=>o.factor_type==="totp"&&o.status==="verified"),a=n.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:n,totp:s,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,n;const{data:{session:s},error:a}=e;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Qa(s.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const h=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(e,r={keys:[]}){let n=r.keys.find(l=>l.kid===e);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+jx>s)return n;const{data:a,error:o}=await H(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,r={}){try{let n=e;if(!n){const{data:x,error:v}=await this.getSession();if(v||!x.session)return{data:null,error:v};n=x.session.access_token}const{header:s,payload:a,signature:o,raw:{header:l,payload:c}}=Qa(n);r!=null&&r.allowExpired||Kx(a.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:x}=await this.getUser(n);if(x)throw x;return{data:{claims:a,header:s,signature:o},error:null}}const h=Gx(s.alg),d=await crypto.subtle.importKey("jwk",u,h,!0,["verify"]);if(!await crypto.subtle.verify(h,d,o,Ax(`${l}.${c}`)))throw new il("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(n){if(V(n))return{data:null,error:n};throw n}}}xs.nextInstanceID=0;const uv=xs;class dv extends uv{constructor(e){super(e)}}var hv=function(t,e,r,n){function s(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function l(h){try{u(n.next(h))}catch(d){o(d)}}function c(h){try{u(n.throw(h))}catch(d){o(d)}}function u(h){h.done?a(h.value):s(h.value).then(l,c)}u((n=n.apply(t,e||[])).next())})};class fv{constructor(e,r,n){var s,a,o;this.supabaseUrl=e,this.supabaseKey=r;const l=xx(e);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,u={db:lx,realtime:ux,auth:Object.assign(Object.assign({},cx),{storageKey:c}),global:ox},h=yx(n??{},u);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=px(r,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new Cy(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new sx(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new ay(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},n={}){return this.rest.rpc(e,r,n)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return hv(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,storageKey:o,flowType:l,lock:c,debug:u},h,d){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new dv({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),h),storageKey:o,autoRefreshToken:e,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,flowType:l,lock:c,debug:u,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Vy(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(e,r,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const pv=(t,e,r)=>new fv(t,e,r);function mv(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}mv()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const gv="https://uqofmsreosfjflmgurzb.supabase.co",yv="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVxb2Ztc3Jlb3NmamZsbWd1cnpiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA3Njc3NDgsImV4cCI6MjA3NjM0Mzc0OH0.CYJ0Vq3xe1jpvjb7zHiCvL8KPZKQJ65XJaYNDrGgOzM",A=pv(gv,yv,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0}}),sp=b.createContext(void 0);function xv({children:t}){const[e,r]=b.useState(null),[n,s]=b.useState(null),[a,o]=b.useState(null),[l,c]=b.useState(!0);b.useEffect(()=>{A.auth.getSession().then(({data:{session:m}})=>{o(m),r((m==null?void 0:m.user)??null),m!=null&&m.user?u(m.user.id):c(!1)});const{data:{subscription:p}}=A.auth.onAuthStateChange(async(m,y)=>{o(y),r((y==null?void 0:y.user)??null),y!=null&&y.user?u(y.user.id):(s(null),c(!1))});return()=>p.unsubscribe()},[]);const u=async p=>{try{const{data:m,error:y}=await A.from("profiles").select("*").eq("id",p).maybeSingle();if(y)throw y;s(m)}catch(m){console.error("Error loading profile:",m)}finally{c(!1)}},g={user:e,profile:n,session:a,loading:l,signUp:async(p,m,y,E)=>{try{const{data:w,error:N}=await A.auth.signUp({email:p,password:m});if(N)return{error:N};if(!w.user)return{error:new fa("User creation failed")};const{error:C}=await A.from("profiles").insert([{id:w.user.id,email:w.user.email,full_name:y,phone:E}]);return C&&console.error("Error creating profile:",C),{error:null}}catch(w){return{error:w}}},signIn:async(p,m)=>{const{error:y}=await A.auth.signInWithPassword({email:p,password:m});return{error:y}},signInWithOTP:async(p,m=!1)=>{try{if(m){const{error:y}=await A.auth.signInWithOtp({phone:p});return{error:y}}else{const{error:y}=await A.auth.signInWithOtp({email:p,options:{shouldCreateUser:!1}});return{error:y}}}catch(y){return{error:y}}},verifyOTP:async(p,m,y=!1)=>{try{if(y){const{error:E}=await A.auth.verifyOtp({phone:p,token:m,type:"sms"});return{error:E}}else{const{error:E}=await A.auth.verifyOtp({email:p,token:m,type:"email"});return{error:E}}}catch(E){return{error:E}}},signOut:async()=>{const{error:p}=await A.auth.signOut();return{error:p}},resetPassword:async p=>{const{error:m}=await A.auth.resetPasswordForEmail(p,{redirectTo:`${window.location.origin}/reset-password`});return{error:m}},updateProfile:async p=>{if(!e)return{error:new Error("Not authenticated")};try{const{error:m}=await A.from("profiles").update(p).eq("id",e.id);if(m)throw m;return s(y=>y?{...y,...p}:null),{error:null}}catch(m){return{error:m}}}};return i.jsx(sp.Provider,{value:g,children:t})}function Oe(){const t=b.useContext(sp);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const vv=b.createContext(void 0);function wv({children:t}){const{user:e}=Oe(),[r,n]=b.useState([]),[s,a]=b.useState(0),[o,l]=b.useState(null),[c,u]=b.useState(null),[h,d]=b.useState(null),f=async()=>{if(e)try{const{data:_,error:k}=await A.from("notifications").select("*").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(50);if(k)throw k;n(_||[]),a((_==null?void 0:_.filter(g=>!g.is_read).length)||0)}catch(_){console.error("Error loading notifications:",_)}},x=async _=>{try{const{error:k}=await A.from("notifications").update({is_read:!0}).eq("id",_);if(k)throw k;n(g=>g.map(p=>p.id===_?{...p,is_read:!0}:p)),a(g=>Math.max(0,g-1))}catch(k){console.error("Error marking notification as read:",k)}},v=async()=>{if(e)try{const{error:_}=await A.from("notifications").update({is_read:!0}).eq("user_id",e.id).eq("is_read",!1);if(_)throw _;n(k=>k.map(g=>({...g,is_read:!0}))),a(0)}catch(_){console.error("Error marking all as read:",_)}};return b.useEffect(()=>{if(!e){o&&(A.removeChannel(o),l(null)),c&&(A.removeChannel(c),u(null)),h&&(A.removeChannel(h),d(null)),n([]),a(0);return}f();const _=A.channel("notifications-channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${e.id}`},p=>{const m=p.new;n(y=>[m,...y]),a(y=>y+1)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"notifications",filter:`user_id=eq.${e.id}`},p=>{const m=p.new;n(y=>y.map(E=>E.id===m.id?m:E)),m.is_read&&a(y=>Math.max(0,y-1))}).subscribe(),k=A.channel("bookings-channel").on("postgres_changes",{event:"*",schema:"public",table:"ride_bookings"},()=>{window.dispatchEvent(new CustomEvent("booking-update"))}).subscribe(),g=A.channel("messages-channel").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`recipient_id=eq.${e.id}`},()=>{window.dispatchEvent(new CustomEvent("message-received"))}).subscribe();return l(_),u(k),d(g),()=>{_&&A.removeChannel(_),k&&A.removeChannel(k),g&&A.removeChannel(g)}},[e]),i.jsx(vv.Provider,{value:{unreadNotifications:s,notifications:r,markAsRead:x,markAllAsRead:v,refreshNotifications:f},children:t})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var bv={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _v=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),q=(t,e)=>{const r=b.forwardRef(({color:n="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:o,className:l="",children:c,...u},h)=>b.createElement("svg",{ref:h,...bv,width:s,height:s,stroke:n,strokeWidth:o?Number(a)*24/Number(s):a,className:["lucide",`lucide-${_v(t)}`,l].join(" "),...u},[...e.map(([d,f])=>b.createElement(d,f)),...Array.isArray(c)?c:[c]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=q("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dc=q("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ip=q("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ed=q("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xa=q("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=q("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jv=q("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=q("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const td=q("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vn=q("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rd=q("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hc=q("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=q("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ap=q("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const op=q("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kv=q("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nv=q("Flower2",[["path",{d:"M12 5a3 3 0 1 1 3 3m-3-3a3 3 0 1 0-3 3m3-3v1M9 8a3 3 0 1 0 3 3M9 8h1m5 0a3 3 0 1 1-3 3m3-3h-1m-2 3v-1",key:"3pnvol"}],["circle",{cx:"12",cy:"8",r:"2",key:"1822b1"}],["path",{d:"M12 10v12",key:"6ubwww"}],["path",{d:"M12 22c4.2 0 7-1.667 7-5-4.2 0-7 1.667-7 5Z",key:"9hd38g"}],["path",{d:"M12 22c-4.2 0-7-1.667-7-5 4.2 0 7 1.667 7 5Z",key:"ufn41s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sv=q("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ev=q("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nd=q("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cv=q("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pv=q("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lp=q("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=q("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fc=q("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=q("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tv=q("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=q("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rv=q("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sr=q("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ov=q("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Av=q("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=q("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cp=q("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=q("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iv=q("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=q("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lv=q("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const up=q("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=q("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $v=q("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dp=q("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=q("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hp=q("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=q("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ci=q("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function mc({size:t="md",showText:e=!0,className:r=""}){const n={sm:"w-10 h-10",md:"w-14 h-14",lg:"w-16 h-16"},s={sm:"w-5 h-5",md:"w-7 h-7",lg:"w-8 h-8"},a={sm:"w-3 h-3",md:"w-4 h-4",lg:"w-4 h-4"},o={sm:"text-base",md:"text-xl",lg:"text-2xl"};return i.jsxs("div",{className:`flex items-center gap-3 ${r}`,children:[i.jsx("div",{className:"relative",children:i.jsxs("div",{className:`${n[t]} bg-gradient-to-br from-red-500 via-red-600 to-orange-500 rounded-2xl flex items-center justify-center shadow-lg transform hover:scale-105 transition-transform duration-200`,children:[i.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-white/20 to-transparent rounded-2xl"}),i.jsxs("div",{className:"relative",children:[i.jsx(wt,{className:`${s[t]} text-white drop-shadow-md`,strokeWidth:2.5}),i.jsx(ot,{className:`${a[t]} text-white absolute -bottom-1 -right-1 bg-orange-500 rounded-full p-0.5`,strokeWidth:3})]})]})}),e&&i.jsxs("div",{children:[i.jsx("span",{className:`${o[t]} font-bold bg-gradient-to-r from-gray-900 to-gray-700 bg-clip-text text-transparent`,children:"Carpool Network"}),i.jsx("p",{className:"text-xs font-medium text-orange-600 -mt-1",children:"Community Carpooling"})]})]})}function Dv(){const t=dt(),[e,r]=b.useState("password"),[n,s]=b.useState(""),[a,o]=b.useState(""),[l,c]=b.useState(""),[u,h]=b.useState(""),[d,f]=b.useState(!1),[x,v]=b.useState(""),[_,k]=b.useState(""),[g,p]=b.useState(!1),[m,y]=b.useState(!1),[E,w]=b.useState(""),{signIn:N,signInWithOTP:C,verifyOTP:T,resetPassword:S}=Oe(),D=async P=>{P.preventDefault(),v(""),p(!0);try{const{error:U}=await N(n,l);U?v(U.message):t("/")}catch{v("An unexpected error occurred")}finally{p(!1)}},M=async P=>{P.preventDefault(),v(""),k(""),p(!0);try{const U=e==="phone-otp",I=U?a:n,{error:F}=await C(I,U);F?v(F.message):(f(!0),k(`OTP sent to your ${U?"phone":"email"}!`))}catch{v("An unexpected error occurred")}finally{p(!1)}},j=async P=>{P.preventDefault(),v(""),p(!0);try{const U=e==="phone-otp",I=U?a:n,{error:F}=await T(I,u,U);F?v(F.message):t("/")}catch{v("An unexpected error occurred")}finally{p(!1)}},O=async P=>{P.preventDefault(),v(""),k(""),p(!0);try{const{error:U}=await S(E);U?v(U.message):(k("Password reset link sent! Check your email."),setTimeout(()=>{y(!1),w(""),k("")},3e3))}catch{v("An unexpected error occurred")}finally{p(!1)}},R=()=>{f(!1),h(""),v(""),k("")};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"w-full max-w-md",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx(mc,{size:"lg",showText:!1})}),i.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome Back"}),i.jsx("p",{className:"text-gray-600",children:"Sign in to continue carpooling"})]}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[x&&i.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-start gap-3",children:[i.jsx(Ye,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),i.jsx("div",{className:"flex-1 text-sm",children:x})]}),_&&i.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-start gap-3",children:[i.jsx(vn,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),i.jsx("div",{className:"flex-1 text-sm",children:_})]}),!m&&!d&&i.jsxs("div",{className:"flex gap-2 mb-6",children:[i.jsxs("button",{onClick:()=>{r("password"),R()},className:`flex-1 flex items-center justify-center gap-2 py-2.5 px-3 rounded-lg font-medium text-sm transition-all ${e==="password"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[i.jsx(Cv,{className:"w-4 h-4"}),"Password"]}),i.jsxs("button",{onClick:()=>{r("email-otp"),R()},className:`flex-1 flex items-center justify-center gap-2 py-2.5 px-3 rounded-lg font-medium text-sm transition-all ${e==="email-otp"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[i.jsx(lp,{className:"w-4 h-4"}),"Email OTP"]}),i.jsxs("button",{onClick:()=>{r("phone-otp"),R()},className:`flex-1 flex items-center justify-center gap-2 py-2.5 px-3 rounded-lg font-medium text-sm transition-all ${e==="phone-otp"?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[i.jsx(Sr,{className:"w-4 h-4"}),"Phone OTP"]})]}),m?i.jsxs("form",{onSubmit:O,className:"space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"resetEmail",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),i.jsx("input",{id:"resetEmail",type:"email",value:E,onChange:P=>w(P.target.value),required:!0,disabled:g,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500",placeholder:"you@example.com"})]}),i.jsx("button",{type:"submit",disabled:g,className:"w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Sending...":"Send Reset Link"}),i.jsx("button",{type:"button",onClick:()=>{y(!1),w(""),v(""),k("")},className:"w-full text-sm text-blue-600 hover:underline",children:"Back to Sign In"})]}):e==="password"?i.jsxs("form",{onSubmit:D,className:"space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",value:n,onChange:P=>s(P.target.value),required:!0,disabled:g,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500",placeholder:"you@example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),i.jsx("input",{id:"password",type:"password",value:l,onChange:P=>c(P.target.value),required:!0,disabled:g,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500",placeholder:""})]}),i.jsx("div",{className:"flex items-center justify-between",children:i.jsx("button",{type:"button",onClick:()=>{y(!0),v("")},className:"text-sm text-blue-600 hover:underline",children:"Forgot password?"})}),i.jsx("button",{type:"submit",disabled:g,className:"w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Signing in...":"Sign In"})]}):i.jsx(i.Fragment,{children:d?i.jsxs("form",{onSubmit:j,className:"space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"otp",className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter OTP"}),i.jsx("input",{id:"otp",type:"text",value:u,onChange:P=>h(P.target.value),required:!0,disabled:g,maxLength:6,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 text-center text-2xl tracking-widest",placeholder:"000000"})]}),i.jsx("button",{type:"submit",disabled:g,className:"w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Verifying...":"Verify OTP"}),i.jsx("button",{type:"button",onClick:R,className:"w-full text-sm text-blue-600 hover:underline",children:"Back"})]}):i.jsxs("form",{onSubmit:M,className:"space-y-5",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:e==="email-otp"?"emailOtp":"phoneOtp",className:"block text-sm font-medium text-gray-700 mb-2",children:e==="email-otp"?"Email Address":"Phone Number"}),i.jsx("input",{id:e==="email-otp"?"emailOtp":"phoneOtp",type:e==="email-otp"?"email":"tel",value:e==="email-otp"?n:a,onChange:P=>e==="email-otp"?s(P.target.value):o(P.target.value),required:!0,disabled:g,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50",placeholder:e==="email-otp"?"you@example.com":"+1234567890"})]}),i.jsx("button",{type:"submit",disabled:g,className:"w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Sending...":"Send OTP"})]})}),i.jsx("div",{className:"mt-6 text-center",children:i.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",i.jsx(sc,{to:"/signup",className:"text-blue-600 font-medium hover:underline",children:"Sign up"})]})})]})]})})}function Uv(){const t=dt(),[e,r]=b.useState(""),[n,s]=b.useState(""),[a,o]=b.useState(""),[l,c]=b.useState(""),[u,h]=b.useState(""),[d,f]=b.useState(""),[x,v]=b.useState(!1),{signUp:_}=Oe(),k=async g=>{if(g.preventDefault(),f(""),l.length<6){f("Password must be at least 6 characters");return}if(l!==u){f("Passwords do not match");return}v(!0);try{const{error:p}=await _(n,l,e,a);p?f(p.message):t("/")}catch{f("An unexpected error occurred")}finally{v(!1)}};return i.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center p-4",children:i.jsxs("div",{className:"w-full max-w-md",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx(mc,{size:"lg",showText:!1})}),i.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Account"}),i.jsx("p",{className:"text-gray-600",children:"Join the carpooling community"})]}),i.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 border border-gray-100",children:[d&&i.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-start gap-3",children:[i.jsx(Ye,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),i.jsx("div",{className:"flex-1 text-sm",children:d})]}),i.jsxs("form",{onSubmit:k,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"fullName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),i.jsx("input",{id:"fullName",type:"text",value:e,onChange:g=>r(g.target.value),required:!0,disabled:x,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50",placeholder:"John Doe"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),i.jsx("input",{id:"email",type:"email",value:n,onChange:g=>s(g.target.value),required:!0,disabled:x,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50",placeholder:"you@example.com"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),i.jsx("input",{id:"phone",type:"tel",value:a,onChange:g=>o(g.target.value),required:!0,disabled:x,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50",placeholder:"+1234567890"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),i.jsx("input",{id:"password",type:"password",value:l,onChange:g=>c(g.target.value),required:!0,disabled:x,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50",placeholder:"At least 6 characters"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),i.jsx("input",{id:"confirmPassword",type:"password",value:u,onChange:g=>h(g.target.value),required:!0,disabled:x,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50",placeholder:"Repeat your password"})]}),i.jsx("button",{type:"submit",disabled:x,className:"w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Creating account...":"Create Account"})]}),i.jsx("div",{className:"mt-6 text-center",children:i.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",i.jsx(sc,{to:"/signin",className:"text-blue-600 font-medium hover:underline",children:"Sign in"})]})})]})]})})}function Mv(){var h;const{profile:t}=Oe(),e=dt(),[r,n]=b.useState({totalRidesOffered:0,totalRidesTaken:0,upcomingRides:0,activeRides:0}),[s,a]=b.useState([]),[o,l]=b.useState(!0);b.useEffect(()=>{c()},[]);const c=async()=>{try{const{data:d}=await A.from("rides").select("*",{count:"exact",head:!0}).eq("status","active"),{data:f}=await A.from("rides").select(`
          id,
          origin,
          destination,
          departure_time,
          available_seats,
          driver:profiles!rides_driver_id_fkey(full_name, average_rating)
        `).eq("status","active").gte("departure_time",new Date().toISOString()).order("departure_time",{ascending:!0}).limit(5);n({totalRidesOffered:(t==null?void 0:t.total_rides_offered)||0,totalRidesTaken:(t==null?void 0:t.total_rides_taken)||0,upcomingRides:(d==null?void 0:d.length)||0,activeRides:(d==null?void 0:d.length)||0}),a(f||[])}catch(d){console.error("Error loading dashboard data:",d)}finally{l(!1)}},u=d=>new Date(d).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});return o?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h1",{className:"text-3xl font-bold text-gray-900",children:["Welcome back, ",(h=t==null?void 0:t.full_name)==null?void 0:h.split(" ")[0],"!"]}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Here's your carpooling activity"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(wt,{className:"w-6 h-6 text-blue-600"})}),i.jsx(sd,{className:"w-5 h-5 text-green-500"})]}),i.jsx("p",{className:"text-3xl font-bold text-gray-900",children:r.totalRidesOffered}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Rides Offered"})]}),i.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center",children:i.jsx(ot,{className:"w-6 h-6 text-green-600"})}),i.jsx(sd,{className:"w-5 h-5 text-green-500"})]}),i.jsx("p",{className:"text-3xl font-bold text-gray-900",children:r.totalRidesTaken}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Rides Taken"})]}),i.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:[i.jsx("div",{className:"flex items-center justify-between mb-2",children:i.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center",children:i.jsx(Ge,{className:"w-6 h-6 text-orange-600"})})}),i.jsx("p",{className:"text-3xl font-bold text-gray-900",children:r.upcomingRides}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Available Rides"})]}),i.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200 hover:shadow-lg transition-shadow",children:[i.jsx("div",{className:"flex items-center justify-between mb-2",children:i.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center",children:i.jsx("div",{className:"text-2xl",children:""})})}),i.jsx("p",{className:"text-3xl font-bold text-gray-900",children:(t==null?void 0:t.average_rating.toFixed(1))||"0.0"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Your Rating"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Quick Actions"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("button",{onClick:()=>e("/find-rides"),className:"w-full flex items-center justify-between p-4 bg-blue-50 hover:bg-blue-100 rounded-xl transition-colors group",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:i.jsx(yt,{className:"w-5 h-5 text-white"})}),i.jsxs("div",{className:"text-left",children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Find a Ride"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Search available rides"})]})]}),i.jsx(ed,{className:"w-5 h-5 text-blue-600 group-hover:translate-x-1 transition-transform"})]}),i.jsxs("button",{onClick:()=>e("/post-ride"),className:"w-full flex items-center justify-between p-4 bg-green-50 hover:bg-green-100 rounded-xl transition-colors group",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center",children:i.jsx(wt,{className:"w-5 h-5 text-white"})}),i.jsxs("div",{className:"text-left",children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Offer a Ride"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Post your trip"})]})]}),i.jsx(ed,{className:"w-5 h-5 text-green-600 group-hover:translate-x-1 transition-transform"})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl p-6 border border-gray-200",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Available Rides"}),i.jsx("button",{onClick:()=>e("/find-rides"),className:"text-sm text-blue-600 hover:underline",children:"View all"})]}),i.jsx("div",{className:"space-y-3",children:s.length===0?i.jsx("p",{className:"text-gray-500 text-center py-8",children:"No upcoming rides available"}):s.map(d=>{var f,x;return i.jsx("div",{className:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 transition-colors cursor-pointer",onClick:()=>e("/find-rides"),children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-700 mb-1",children:[i.jsx("span",{className:"font-medium",children:d.origin}),i.jsx("span",{className:"text-gray-400",children:""}),i.jsx("span",{className:"font-medium",children:d.destination})]}),i.jsx("p",{className:"text-xs text-gray-600",children:u(d.departure_time)}),i.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[i.jsx("span",{className:"text-xs text-gray-600",children:(f=d.driver)==null?void 0:f.full_name}),i.jsx("span",{className:"text-xs text-gray-400",children:""}),i.jsxs("span",{className:"text-xs text-gray-600",children:[" ",(x=d.driver)==null?void 0:x.average_rating.toFixed(1)]})]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("span",{className:"text-sm font-medium text-blue-600",children:[d.available_seats," ",d.available_seats===1?"seat":"seats"]})})]})},d.id)})})]})]})]})}function qi({value:t,onChange:e,placeholder:r="Enter location",label:n,required:s=!1,id:a}){const o=b.useRef(null),l=b.useRef(null),c=b.useRef(!1);b.useEffect(()=>{const h=async()=>{if(typeof window.google<"u"&&window.google.maps){d();return}const f="AIzaSyDiqv8H6yGfUM5itzjpL1pU19I_veBIwHE";if(document.querySelector('script[src*="maps.googleapis.com"]')){const x=setInterval(()=>{typeof window.google<"u"&&window.google.maps&&(clearInterval(x),d())},100);return}try{const x=document.createElement("script");x.src=`https://maps.googleapis.com/maps/api/js?key=${f}&libraries=places`,x.async=!0,x.defer=!0,x.onload=()=>d(),document.head.appendChild(x)}catch(x){console.error("Error loading Google Maps:",x)}},d=()=>{if(!o.current||l.current)return;const f=new google.maps.places.Autocomplete(o.current,{componentRestrictions:{country:"gb"},fields:["address_components","geometry","name","formatted_address"]});f.addListener("place_changed",()=>{const x=f.getPlace();x.formatted_address&&(c.current=!0,e(x.formatted_address,x),setTimeout(()=>{c.current=!1},0))}),l.current=f};h()},[e]),b.useEffect(()=>{o.current&&!c.current&&(o.current.value=t)},[t]);const u=h=>{e(h.target.value)};return i.jsxs("div",{children:[n&&i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[n,s&&i.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx("input",{ref:o,id:a,type:"text",defaultValue:t,onChange:u,placeholder:r,required:s,autoComplete:"off",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})}const Fr="AIzaSyDiqv8H6yGfUM5itzjpL1pU19I_veBIwHE";class Fv{constructor(){this.directionsService=null,typeof google<"u"&&google.maps&&(this.directionsService=new google.maps.DirectionsService)}async getWeather(e,r){return this.getWeatherForecast(e,r)}async getMultipleRouteOptions(e,r){var o,l;const n="https://routes.googleapis.com/directions/v2:computeRoutes",s=[],a=[{type:"TRAFFIC_AWARE",name:"Fastest Route",desc:"Optimized for current traffic"},{type:"SHORTEST",name:"Shortest Route",desc:"Minimum distance"},{type:"FUEL_EFFICIENT",name:"Eco-Friendly Route",desc:"Best fuel economy"}];try{for(const c of a){const u=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-Goog-Api-Key":Fr,"X-Goog-FieldMask":"routes.duration,routes.distanceMeters,routes.polyline,routes.legs"},body:JSON.stringify({origin:{location:{latLng:{latitude:e.lat,longitude:e.lng}}},destination:{location:{latLng:{latitude:r.lat,longitude:r.lng}}},travelMode:"DRIVE",routingPreference:c.type,computeAlternativeRoutes:!1,languageCode:"en-GB",units:"METRIC"})});if(u.ok){const d=(o=(await u.json()).routes)==null?void 0:o[0];if(d){const f=(d.distanceMeters/1e3).toFixed(1),x=Math.round(parseInt(d.duration.replace("s",""))/60);s.push({name:c.name,description:c.desc,distance:`${f} km`,duration:`${x} min`,distanceValue:d.distanceMeters,durationValue:parseInt(d.duration.replace("s","")),polyline:((l=d.polyline)==null?void 0:l.encodedPolyline)||"",optimizationType:c.type==="TRAFFIC_AWARE"?"FASTEST":c.type==="SHORTEST"?"SHORTEST":"ECO_FRIENDLY",fuelEfficiency:c.type==="FUEL_EFFICIENT"?"Optimized":void 0})}}}if(s.length>1){const c=s.reduce((h,d)=>h+d.distanceValue,0)/s.length,u=s.reduce((h,d)=>h+d.durationValue,0)/s.length;s.push({name:"Balanced Route",description:"Best balance of time and distance",distance:`${(c/1e3).toFixed(1)} km`,duration:`${Math.round(u/60)} min`,distanceValue:c,durationValue:u,polyline:s[0].polyline,optimizationType:"BALANCED"})}return s.length>0?s:await this.getFallbackRoute(e,r)}catch(c){return console.error("Routes API error:",c),await this.getFallbackRoute(e,r)}}async getFallbackRoute(e,r){if(!this.directionsService)return[];try{const n=await this.getDirections(e,r);return[{name:"Standard Route",description:"Default route",distance:n.distance,duration:n.duration,distanceValue:n.distanceValue,durationValue:n.durationValue,polyline:n.polyline,optimizationType:"BALANCED"}]}catch{return[]}}async getDirections(e,r,n){if(!this.directionsService)throw new Error("Google Maps not loaded");const s={origin:new google.maps.LatLng(e.lat,e.lng),destination:new google.maps.LatLng(r.lat,r.lng),travelMode:google.maps.TravelMode.DRIVING,waypoints:n||[],optimizeWaypoints:!0,avoidHighways:!1,avoidTolls:!1};return new Promise((a,o)=>{this.directionsService.route(s,(l,c)=>{var u,h,d,f;if(c===google.maps.DirectionsStatus.OK&&l){const x=l.routes[0],v=x.legs[0];a({distance:((u=v.distance)==null?void 0:u.text)||"",duration:((h=v.duration)==null?void 0:h.text)||"",distanceValue:((d=v.distance)==null?void 0:d.value)||0,durationValue:((f=v.duration)==null?void 0:f.value)||0,polyline:x.overview_polyline||"",steps:v.steps})}else o(new Error(`Directions request failed: ${c}`))})})}async getWeatherForecast(e,r,n){var a,o,l,c,u,h;const s=`https://weather.googleapis.com/v1/weather?location=${e},${r}&key=${Fr}`;try{const d=await fetch(s);if(!d.ok)throw new Error("Weather API request failed");const f=await d.json();return{temperature:((a=f.temperature)==null?void 0:a.value)||20,condition:((o=f.condition)==null?void 0:o.description)||"Partly Cloudy",humidity:((l=f.humidity)==null?void 0:l.value)||60,windSpeed:((u=(c=f.wind)==null?void 0:c.speed)==null?void 0:u.value)||10,icon:((h=f.condition)==null?void 0:h.icon)||"partly_cloudy",forecast:n?this.generateForecast(n):void 0}}catch(d){return console.error("Weather API error:",d),this.getMockWeatherData(n)}}getMockWeatherData(e){const r=15+Math.random()*10,n=["Sunny","Partly Cloudy","Cloudy","Light Rain"],s=n[Math.floor(Math.random()*n.length)];return{temperature:Math.round(r),condition:s,humidity:50+Math.floor(Math.random()*30),windSpeed:5+Math.floor(Math.random()*15),icon:s.toLowerCase().replace(" ","_"),forecast:e?this.generateForecast(e):void 0}}generateForecast(e){const r=[],n=["Sunny","Partly Cloudy","Cloudy","Light Rain"];for(let s=0;s<5;s++){const a=new Date(e);a.setDate(a.getDate()+s),r.push({date:a.toLocaleDateString("en-GB",{weekday:"short",month:"short",day:"numeric"}),temperature:Math.round(12+Math.random()*12),condition:n[Math.floor(Math.random()*n.length)],precipitationChance:Math.floor(Math.random()*60)})}return r}async getAirQuality(e,r){var s;const n=`https://airquality.googleapis.com/v1/currentConditions:lookup?key=${Fr}`;try{const a=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({location:{latitude:e,longitude:r}})});if(!a.ok)throw new Error("Air Quality API request failed");const c=((await a.json()).indexes||[])[0]||{},u={Excellent:"#00E400",Good:"#92D050",Moderate:"#FFFF00",Poor:"#FF7E00","Very Poor":"#FF0000",Severe:"#8F3F97"};return{aqi:c.aqi||50,category:c.category||"Good",dominantPollutant:c.dominantPollutant||"pm25",healthRecommendations:((s=c.healthRecommendations)==null?void 0:s.generalPopulation)||"Air quality is acceptable",color:u[c.category]||"#92D050"}}catch(a){return console.error("Air Quality API error:",a),{aqi:50,category:"Good",dominantPollutant:"pm25",healthRecommendations:"Air quality is acceptable for most people",color:"#92D050"}}}async getPollenData(e,r){var s;const n=`https://pollen.googleapis.com/v1/forecast:lookup?key=${Fr}&location.latitude=${e}&location.longitude=${r}&days=1`;try{const a=await fetch(n);if(!a.ok)throw new Error("Pollen API request failed");const l=(s=(await a.json()).dailyInfo)==null?void 0:s[0];return((l==null?void 0:l.pollenTypeInfo)||[]).map(u=>{var h,d,f;return{plantType:u.displayName||u.code,index:((h=u.indexInfo)==null?void 0:h.value)||0,category:((d=u.indexInfo)==null?void 0:d.category)||"Low",description:this.getPollenDescription(((f=u.indexInfo)==null?void 0:f.category)||"Low")}})}catch(a){return console.error("Pollen API error:",a),this.getMockPollenData()}}getMockPollenData(){return["Tree","Grass","Weed"].map(r=>({plantType:r,index:Math.floor(Math.random()*5),category:["Low","Low-Medium","Medium","Medium-High","High"][Math.floor(Math.random()*5)],description:"Pollen levels are typical for this time of year"}))}getPollenDescription(e){return{Low:"Pollen levels are low and pose little risk","Low-Medium":"Pollen levels are slightly elevated",Medium:"Moderate pollen levels, sensitive individuals may experience symptoms","Medium-High":"High pollen levels, precautions recommended",High:"Very high pollen levels, outdoor activities may be affected"}[e]||"No data available"}async searchNearbyPlaces(e,r,n,s=5e3){const a="https://places.googleapis.com/v1/places:searchNearby";try{const o=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json","X-Goog-Api-Key":Fr,"X-Goog-FieldMask":"places.displayName,places.formattedAddress,places.location,places.types,places.rating,places.currentOpeningHours"},body:JSON.stringify({locationRestriction:{circle:{center:{latitude:e,longitude:r},radius:s}},includedTypes:[n],maxResultCount:10})});if(!o.ok)throw new Error("Places API request failed");return((await o.json()).places||[]).map(u=>{var h,d,f,x;return{name:((h=u.displayName)==null?void 0:h.text)||"",address:u.formattedAddress||"",placeId:u.id||"",location:{lat:((d=u.location)==null?void 0:d.latitude)||0,lng:((f=u.location)==null?void 0:f.longitude)||0},types:u.types||[],rating:u.rating,openNow:(x=u.currentOpeningHours)==null?void 0:x.openNow}})}catch(o){return console.error("Places API error:",o),[]}}getStaticMapUrl(e,r=13,n=600,s=400,a){let o=`https://maps.googleapis.com/maps/api/staticmap?center=${e.lat},${e.lng}&zoom=${r}&size=${n}x${s}&key=${Fr}`;return a&&a.length>0&&a.forEach(l=>{const c=l.label?`|label:${l.label}`:"";o+=`&markers=color:red${c}|${l.lat},${l.lng}`}),o}calculateDetour(e,r){const n=(r-e)/1e3,s=(r-e)/e*100;return{detourKm:Math.round(n*10)/10,detourPercent:Math.round(s*10)/10}}}const Et=new Fv;function Bv(){const{user:t}=Oe(),e=dt(),[r,n]=b.useState(""),[s,a]=b.useState(""),[o,l]=b.useState(""),[c,u]=b.useState(1),[h,d]=b.useState([]),[f,x]=b.useState(!1),[v,_]=b.useState(!1);b.useEffect(()=>{k()},[]);const k=async()=>{if(t){x(!0);try{const{data:y,error:E}=await A.from("rides").select(`
          *,
          driver:profiles!rides_driver_id_fkey(*),
          vehicle:vehicles(*)
        `).eq("status","active").neq("driver_id",t.id).gte("departure_time",new Date().toISOString()).order("departure_time",{ascending:!0}).limit(20);if(E)throw E;const w=y||[],{data:N}=await A.from("ride_bookings").select("ride_id, id, status").eq("passenger_id",t.id).in("ride_id",w.map(T=>T.id)),C=await Promise.all(w.map(async T=>{const S=N==null?void 0:N.find(M=>M.ride_id===T.id);let D=null;if(T.origin_lat&&T.origin_lng)try{D=await Et.getWeather(T.origin_lat,T.origin_lng)}catch(M){console.error("Failed to load weather:",M)}return{...T,userBooking:S?{id:S.id,status:S.status}:void 0,weather:D&&D.condition!=="Unavailable"?{temperature:D.temperature,condition:D.condition}:void 0}}));d(C)}catch(y){console.error("Error loading rides:",y)}finally{x(!1)}}},g=async y=>{if(y.preventDefault(),!!t){x(!0),_(!0);try{let E=A.from("rides").select(`
          *,
          driver:profiles!rides_driver_id_fkey(*),
          vehicle:vehicles(*)
        `).eq("status","active").neq("driver_id",t.id).gte("available_seats",c);if(o){const C=new Date(o);C.setHours(0,0,0,0);const T=new Date(o);T.setHours(23,59,59,999),E=E.gte("departure_time",C.toISOString()).lte("departure_time",T.toISOString())}else E=E.gte("departure_time",new Date().toISOString());E=E.order("departure_time",{ascending:!0}).limit(20);const{data:w,error:N}=await E;if(N)throw N;d(w||[])}catch(E){console.error("Error searching rides:",E)}finally{x(!1)}}},p=async y=>{if(t)try{const{error:E}=await A.from("ride_bookings").insert([{ride_id:y,passenger_id:t.id,pickup_location:r||"To be confirmed",pickup_lat:0,pickup_lng:0,dropoff_location:s||"To be confirmed",dropoff_lat:0,dropoff_lng:0,seats_requested:c}]);if(E)throw E;alert("Ride request sent successfully!"),k()}catch(E){E.code==="23505"?alert("You have already requested this ride"):alert("Failed to request ride. Please try again.")}},m=y=>new Date(y).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Find a Ride"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Search for available rides in your area"})]}),i.jsx("div",{className:"bg-white rounded-xl p-6 border border-gray-200 shadow-sm",children:i.jsxs("form",{onSubmit:g,className:"space-y-4",children:[i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsx(qi,{id:"search-origin-input",label:"From",value:r,onChange:y=>n(y),placeholder:"Enter pickup location"}),i.jsx(qi,{id:"search-destination-input",label:"To",value:s,onChange:y=>a(y),placeholder:"Enter destination"})]}),i.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[i.jsx(Ge,{className:"w-4 h-4 inline mr-1"}),"Date"]}),i.jsx("input",{type:"date",value:o,onChange:y=>l(y.target.value),min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[i.jsx(ot,{className:"w-4 h-4 inline mr-1"}),"Seats"]}),i.jsx("select",{value:c,onChange:y=>u(Number(y.target.value)),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[1,2,3,4].map(y=>i.jsxs("option",{value:y,children:[y," ",y===1?"seat":"seats"]},y))})]}),i.jsx("div",{className:"flex items-end",children:i.jsxs("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 text-white px-6 py-3 rounded-xl font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:[i.jsx(pc,{className:"w-5 h-5"}),f?"Searching...":"Search"]})})]})]})}),i.jsxs("div",{children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsx("h2",{className:"text-xl font-bold text-gray-900",children:v?`${h.length} rides found`:"All Available Rides"})}),f?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full"})}):h.length===0?i.jsx("div",{className:"bg-white rounded-xl p-12 text-center border border-gray-200",children:i.jsx("p",{className:"text-gray-600",children:v?"No rides found matching your criteria":"No rides available"})}):i.jsx("div",{className:"space-y-4",children:h.map(y=>i.jsxs("div",{className:`bg-white border rounded-xl p-6 hover:shadow-lg transition-all ${y.userBooking&&y.userBooking.status!=="cancelled"?"border-green-300 bg-green-50":"border-gray-200"}`,children:[y.userBooking&&y.userBooking.status!=="cancelled"&&i.jsxs("div",{className:"mb-4 flex items-center gap-2 bg-green-100 border border-green-300 rounded-lg px-4 py-2",children:[i.jsx(vn,{className:"w-5 h-5 text-green-600"}),i.jsxs("span",{className:"font-semibold text-green-800",children:["Already Booked - Status: ",y.userBooking.status.charAt(0).toUpperCase()+y.userBooking.status.slice(1)]})]}),i.jsxs("div",{className:"flex flex-col lg:flex-row gap-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-2xl font-bold text-blue-600",children:y.driver.full_name.charAt(0)})}),i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-gray-900",children:y.driver.full_name}),i.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Er,{className:"w-4 h-4 text-yellow-400 fill-current"}),y.driver.average_rating.toFixed(1)]}),i.jsx("span",{children:""}),i.jsxs("span",{children:[y.driver.total_rides_offered," rides"]})]}),y.weather&&i.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-gray-600",children:[i.jsx(ma,{className:"w-3 h-3"}),i.jsxs("span",{children:[Math.round(y.weather.temperature),"C - ",y.weather.condition]})]})]})]}),i.jsxs("div",{className:"flex-1 space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2 text-gray-700",children:[i.jsx(yt,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),i.jsx("span",{className:"font-medium",children:y.origin}),i.jsx("span",{className:"text-gray-400",children:""}),i.jsx("span",{className:"font-medium",children:y.destination})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Ge,{className:"w-4 h-4"}),m(y.departure_time)]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ot,{className:"w-4 h-4"}),y.available_seats," of ",y.total_seats," seats"]}),y.vehicle&&i.jsxs("span",{children:[y.vehicle.color," ",y.vehicle.make," ",y.vehicle.model]})]}),y.notes&&i.jsx("p",{className:"text-sm text-gray-600 mt-2",children:y.notes})]}),i.jsxs("div",{className:"flex lg:flex-col gap-2 lg:justify-center",children:[i.jsxs("button",{onClick:()=>e(`/rides/${y.id}`),className:"flex-1 lg:flex-none px-6 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors font-medium whitespace-nowrap flex items-center justify-center gap-2",children:[i.jsx(op,{className:"w-4 h-4"}),"View Details"]}),y.userBooking&&y.userBooking.status!=="cancelled"?i.jsx("button",{onClick:()=>e(`/bookings/${y.userBooking.id}`),className:"flex-1 lg:flex-none px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium whitespace-nowrap",children:"View Booking"}):i.jsx("button",{onClick:()=>p(y.id),className:"flex-1 lg:flex-none px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium whitespace-nowrap",children:"Request Ride"})]})]})]},y.id))})]})]})}function zv(){const{user:t}=Oe(),e=dt(),[r,n]=b.useState(!1),[s,a]=b.useState(!0),[o,l]=b.useState(4),[c,u]=b.useState({origin:"",destination:"",departureDate:"",departureTime:"",availableSeats:1,notes:"",isRecurring:!1,timeType:"depart"}),[h,d]=b.useState({lat:0,lng:0}),[f,x]=b.useState({lat:0,lng:0}),[v,_]=b.useState(!1),[k,g]=b.useState(!1),[p,m]=b.useState("");b.useEffect(()=>{y()},[t]);const y=async()=>{if(t)try{const{data:w,error:N}=await A.from("vehicles").select("id, capacity").eq("user_id",t.id).eq("is_active",!0).limit(1).maybeSingle();if(N)throw N;if(n(!!w),w!=null&&w.capacity){const C=w.capacity-1;l(C),u(T=>({...T,availableSeats:Math.min(T.availableSeats,C)}))}}catch(w){console.error("Error checking vehicle:",w)}finally{a(!1)}},E=async w=>{if(w.preventDefault(),!!t){m(""),_(!0);try{const{data:N}=await A.from("vehicles").select("*").eq("user_id",t.id).eq("is_active",!0).limit(1).maybeSingle();if(!N){m("Please add a vehicle to your profile first"),_(!1);return}const C=new Date(`${c.departureDate}T${c.departureTime}`).toISOString(),T=(N.capacity||5)-1,S=Math.min(c.availableSeats,T),{error:D}=await A.from("rides").insert([{driver_id:t.id,vehicle_id:N.id,origin:c.origin,origin_lat:h.lat,origin_lng:h.lng,destination:c.destination,destination_lat:f.lat,destination_lng:f.lng,departure_time:C,available_seats:S,total_seats:S,notes:c.notes,is_recurring:c.isRecurring}]);if(D)throw D;g(!0),u({origin:"",destination:"",departureDate:"",departureTime:"",availableSeats:1,notes:"",isRecurring:!1,timeType:"depart"}),setTimeout(()=>{e("/my-rides")},2e3)}catch(N){console.error("Error posting ride:",N),m("Failed to post ride. Please try again.")}finally{_(!1)}}};return s?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full"})}):r?i.jsxs("div",{className:"max-w-3xl mx-auto space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Post a Ride"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Share your journey with the community"})]}),k&&i.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-6 py-4 rounded-xl flex items-center gap-3",children:[i.jsx(vn,{className:"w-6 h-6"}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:"Ride posted successfully!"}),i.jsx("p",{className:"text-sm",children:"Redirecting to your rides..."})]})]}),p&&i.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-xl flex items-center gap-3",children:[i.jsx(Ye,{className:"w-6 h-6"}),i.jsx("p",{children:p})]}),i.jsx("div",{className:"bg-white rounded-xl p-8 border border-gray-200 shadow-sm",children:i.jsxs("form",{onSubmit:E,className:"space-y-6",children:[i.jsx(qi,{id:"origin-input",label:"Pickup Location",value:c.origin,onChange:(w,N)=>{var C;u(T=>({...T,origin:w})),(C=N==null?void 0:N.geometry)!=null&&C.location&&d({lat:N.geometry.location.lat(),lng:N.geometry.location.lng()})},placeholder:"Enter starting point",required:!0}),i.jsx(qi,{id:"destination-input",label:"Destination",value:c.destination,onChange:(w,N)=>{var C;u(T=>({...T,destination:w})),(C=N==null?void 0:N.geometry)!=null&&C.location&&x({lat:N.geometry.location.lat(),lng:N.geometry.location.lng()})},placeholder:"Enter destination",required:!0}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Time Type"}),i.jsxs("div",{className:"flex gap-4 mb-4",children:[i.jsx("button",{type:"button",onClick:()=>u({...c,timeType:"depart"}),className:`flex-1 py-3 px-4 rounded-xl font-medium transition-all ${c.timeType==="depart"?"bg-blue-600 text-white ring-2 ring-blue-400":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Depart After"}),i.jsx("button",{type:"button",onClick:()=>u({...c,timeType:"arrive"}),className:`flex-1 py-3 px-4 rounded-xl font-medium transition-all ${c.timeType==="arrive"?"bg-blue-600 text-white ring-2 ring-blue-400":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Arrive By"})]}),i.jsx("p",{className:"text-xs text-gray-500 mb-4",children:c.timeType==="depart"?"You will depart after this time":"You want to arrive by this time"})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[i.jsx(Ge,{className:"w-4 h-4 inline mr-1"}),"Date"]}),i.jsx("input",{type:"date",value:c.departureDate,onChange:w=>u({...c,departureDate:w.target.value}),min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[i.jsx(hc,{className:"w-4 h-4 inline mr-1"}),c.timeType==="depart"?"Departure Time":"Arrival Time"]}),i.jsx("input",{type:"time",value:c.departureTime,onChange:w=>u({...c,departureTime:w.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[i.jsx(ot,{className:"w-4 h-4 inline mr-1"}),"Available Seats"]}),i.jsx("select",{value:c.availableSeats,onChange:w=>u({...c,availableSeats:Number(w.target.value)}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Array.from({length:o},(w,N)=>N+1).map(w=>i.jsxs("option",{value:w,children:[w," ",w===1?"seat":"seats"]},w))}),i.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Your vehicle has ",o," passenger seats available (excluding driver)"]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes (Optional)"}),i.jsx("textarea",{value:c.notes,onChange:w=>u({...c,notes:w.target.value}),placeholder:"Any additional information about your ride...",rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",id:"recurring",checked:c.isRecurring,onChange:w=>u({...c,isRecurring:w.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),i.jsx("label",{htmlFor:"recurring",className:"text-sm text-gray-700",children:"This is a recurring ride"})]}),i.jsxs("button",{type:"submit",disabled:v,className:"w-full bg-blue-600 text-white py-4 rounded-xl font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:[i.jsx(wt,{className:"w-5 h-5"}),v?"Posting Ride...":"Post Ride"]})]})})]}):i.jsx("div",{className:"max-w-2xl mx-auto",children:i.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-8 text-center",children:[i.jsx(Ye,{className:"w-16 h-16 text-yellow-600 mx-auto mb-4"}),i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Vehicle Registered"}),i.jsx("p",{className:"text-gray-700 mb-6",children:"You need to add a vehicle to your profile before you can offer rides."}),i.jsx("button",{onClick:()=>e("/profile"),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Go to Profile"})]})})}function qv(){const{user:t}=Oe(),e=dt(),[r,n]=b.useState("offered"),[s,a]=b.useState([]),[o,l]=b.useState([]),[c,u]=b.useState([]),[h,d]=b.useState([]),[f,x]=b.useState(!0),[v,_]=b.useState(null),[k,g]=b.useState(null);b.useEffect(()=>{m(),r!=="requests"&&r!=="passengers"&&p();const j=()=>{m(),r!=="requests"&&r!=="passengers"&&p()};return window.addEventListener("booking-update",j),()=>{window.removeEventListener("booking-update",j)}},[t,r]);const p=async()=>{if(t)try{const{data:j,error:O}=await A.from("rides").select("id").eq("driver_id",t.id);if(O)throw O;const R=(j==null?void 0:j.map(P=>P.id))||[];if(R.length>0){const{data:P,error:U}=await A.from("ride_bookings").select("id").in("ride_id",R).eq("status","pending");!U&&P&&u(P)}}catch(j){console.error("Error loading requests count:",j)}},m=async()=>{if(t){x(!0);try{if(r==="offered"){const{data:j,error:O}=await A.from("rides").select("*").eq("driver_id",t.id).order("departure_time",{ascending:!1});if(O)throw O;a(j||[])}else if(r==="booked"){const{data:j,error:O}=await A.from("ride_bookings").select(`
            *,
            ride:rides(
              id,
              origin,
              destination,
              departure_time,
              driver:profiles!rides_driver_id_fkey(full_name, average_rating)
            )
          `).eq("passenger_id",t.id).order("created_at",{ascending:!1});if(O)throw O;l(j||[])}else if(r==="requests"){const{data:j,error:O}=await A.from("rides").select("id").eq("driver_id",t.id);if(O)throw O;const R=(j==null?void 0:j.map(P=>P.id))||[];if(R.length>0){const{data:P,error:U}=await A.from("ride_bookings").select(`
              *,
              passenger:profiles(
                id,
                full_name,
                average_rating,
                total_bookings,
                cancelled_bookings,
                last_minute_cancellations,
                reliability_score,
                bio
              ),
              ride:rides(
                id,
                origin,
                destination,
                departure_time,
                available_seats
              )
            `).in("ride_id",R).eq("status","pending").order("created_at",{ascending:!1});if(U)throw console.error("Error loading booking requests:",U),U;console.log("Booking requests loaded:",P),u(P||[])}else u([])}else if(r==="passengers"){const{data:j,error:O}=await A.from("rides").select("id").eq("driver_id",t.id);if(O)throw O;const R=(j==null?void 0:j.map(P=>P.id))||[];if(R.length>0){const{data:P,error:U}=await A.from("ride_bookings").select(`
              *,
              passenger:profiles(
                id,
                full_name,
                average_rating,
                total_bookings,
                cancelled_bookings,
                last_minute_cancellations,
                reliability_score,
                bio,
                phone
              ),
              ride:rides(
                id,
                origin,
                destination,
                departure_time,
                available_seats
              )
            `).in("ride_id",R).eq("status","confirmed").order("created_at",{ascending:!1});if(U)throw console.error("Error loading confirmed passengers:",U),U;d(P||[])}else d([])}}catch(j){console.error("Error loading rides:",j)}finally{x(!1)}}},y=async j=>{if(confirm("Are you sure you want to delete this ride? This action cannot be undone.")){_(j);try{const{error:O}=await A.from("rides").delete().eq("id",j);if(O)throw O;a(R=>R.filter(P=>P.id!==j)),alert("Ride deleted successfully!")}catch(O){console.error("Error deleting ride:",O),alert("Failed to delete ride. Please try again.")}finally{_(null)}}},E=async j=>{if(confirm("Are you sure you want to cancel this ride?")){_(j);try{const{error:O}=await A.from("rides").update({status:"cancelled"}).eq("id",j);if(O)throw O;m(),alert("Ride cancelled successfully!")}catch(O){console.error("Error cancelling ride:",O),alert("Failed to cancel ride. Please try again.")}finally{_(null)}}},w=async j=>{if(confirm(`Accept booking request from ${j.passenger.full_name}?`)){g(j.id);try{const{error:O}=await A.rpc("driver_decide_booking",{p_booking_id:j.id,p_decision:"confirmed"});if(O)throw O;alert("Booking request accepted!"),m()}catch(O){console.error("Error accepting request:",O),alert(O.message||"Failed to accept request. Please try again.")}finally{g(null)}}},N=async j=>{if(prompt("Reason for rejecting (optional):")!==null&&confirm(`Reject booking request from ${j.passenger.full_name}?`)){g(j.id);try{const{error:R}=await A.rpc("driver_decide_booking",{p_booking_id:j.id,p_decision:"cancelled"});if(R)throw R;alert("Booking request rejected."),m()}catch(R){console.error("Error rejecting request:",R),alert(R.message||"Failed to reject request. Please try again.")}finally{g(null)}}},C=async(j,O)=>{const R=prompt("Please provide a reason for cancellation (optional):");if(R!==null&&confirm("Are you sure you want to cancel this booking?")){_(j);try{const{error:P}=await A.rpc("cancel_booking",{p_booking_id:j,p_reason:R||"No reason provided"});if(P)throw P;m(),alert("Booking cancelled successfully!")}catch(P){console.error("Error cancelling booking:",P);const U=P.message||"Failed to cancel booking. Please try again.";U.includes("already cancelled")?alert("This booking is already cancelled."):alert(U)}finally{_(null)}}},T=j=>new Date(j).toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}),S=j=>new Date(j)<new Date,D=(j,O=!1)=>{if(O)return"bg-gray-100 text-gray-600";switch(j){case"active":return"bg-green-100 text-green-800";case"in-progress":return"bg-blue-100 text-blue-800";case"completed":return"bg-gray-100 text-gray-800";case"cancelled":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},M=(j,O=!1)=>O?"expired":j;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Rides"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your rides and bookings"})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[i.jsxs("div",{className:"border-b border-gray-200 flex",children:[i.jsx("button",{onClick:()=>n("offered"),className:`flex-1 px-6 py-4 font-medium transition-colors ${r==="offered"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:"Rides I'm Offering"}),i.jsxs("button",{onClick:()=>n("requests"),className:`flex-1 px-6 py-4 font-medium transition-colors relative ${r==="requests"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:["Requests",c.length>0&&i.jsx("span",{className:"ml-2 inline-flex items-center justify-center w-6 h-6 text-xs font-bold text-white bg-red-600 rounded-full",children:c.length})]}),i.jsxs("button",{onClick:()=>n("passengers"),className:`flex-1 px-6 py-4 font-medium transition-colors ${r==="passengers"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:["Passengers",h.length>0&&i.jsx("span",{className:"ml-2 inline-flex items-center justify-center w-6 h-6 text-xs font-bold text-white bg-green-600 rounded-full",children:h.length})]}),i.jsx("button",{onClick:()=>n("booked"),className:`flex-1 px-6 py-4 font-medium transition-colors ${r==="booked"?"text-blue-600 border-b-2 border-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:"My Bookings"})]}),i.jsx("div",{className:"p-6",children:f?i.jsx("div",{className:"flex items-center justify-center py-12",children:i.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full"})}):r==="offered"?i.jsx("div",{className:"space-y-4",children:s.length===0?i.jsxs("div",{className:"text-center py-12 text-gray-500",children:[i.jsx(wt,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),i.jsx("p",{className:"font-medium mb-2",children:"No rides offered yet"}),i.jsx("p",{className:"text-sm",children:"Start by posting your first ride!"})]}):s.map(j=>{const O=S(j.departure_time),R=j.status==="cancelled";return i.jsxs("div",{className:`border rounded-xl p-6 transition-all ${O||R?"border-gray-200 bg-gray-50 opacity-75":"border-gray-200 bg-white hover:shadow-lg cursor-pointer"}`,onClick:()=>{!O&&!R&&e(`/rides/${j.id}`)},children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${D(j.status,O)}`,children:M(j.status,O)}),j.is_recurring&&i.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:"Recurring"}),O&&!R&&i.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-500",children:[i.jsx(Ye,{className:"w-3 h-3"}),"Past departure time"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[!O&&!R&&i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:P=>{P.stopPropagation(),e(`/rides/${j.id}`)},className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"View Details",children:i.jsx(op,{className:"w-4 h-4"})}),i.jsx("button",{onClick:P=>{P.stopPropagation(),alert("Edit functionality coming soon!")},className:"p-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",title:"Edit Ride",children:i.jsx(Rv,{className:"w-4 h-4"})}),i.jsx("button",{onClick:P=>{P.stopPropagation(),E(j.id)},className:"p-2 text-orange-600 hover:bg-orange-50 rounded-lg transition-colors",title:"Cancel Ride",disabled:v===j.id,children:i.jsx(Ye,{className:"w-4 h-4"})})]}),i.jsx("button",{onClick:P=>{P.stopPropagation(),y(j.id)},className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete Ride",disabled:v===j.id,children:v===j.id?i.jsx("div",{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"}):i.jsx(up,{className:"w-4 h-4"})})]})]}),i.jsxs("div",{className:"flex items-center gap-2 text-gray-700 mb-2",children:[i.jsx(yt,{className:"w-5 h-5 text-blue-600"}),i.jsx("span",{className:"font-medium",children:j.origin}),i.jsx("span",{className:"text-gray-400",children:""}),i.jsx("span",{className:"font-medium",children:j.destination})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Ge,{className:"w-4 h-4"}),T(j.departure_time)]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ot,{className:"w-4 h-4"}),j.available_seats,"/",j.total_seats," available"]})]}),j.notes&&i.jsx("p",{className:"mt-3 text-sm text-gray-600 border-t border-gray-100 pt-3",children:j.notes})]},j.id)})}):r==="requests"?i.jsx("div",{className:"space-y-4",children:c.length===0?i.jsxs("div",{className:"text-center py-12 text-gray-500",children:[i.jsx(ot,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),i.jsx("p",{className:"font-medium mb-2",children:"No pending requests"}),i.jsx("p",{className:"text-sm",children:"Booking requests will appear here"})]}):c.map(j=>{if(!j.passenger||!j.ride)return console.error("Invalid booking request data:",j),null;const O=j.passenger.reliability_score>=4.5?"text-green-600":j.passenger.reliability_score>=3.5?"text-yellow-600":"text-red-600";return i.jsxs("div",{className:"border-2 border-blue-200 rounded-xl p-6 bg-blue-50",children:[i.jsx("div",{className:"flex items-start justify-between mb-4",children:i.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[i.jsx("div",{className:"w-14 h-14 bg-blue-200 rounded-full flex items-center justify-center text-2xl font-bold text-blue-700 flex-shrink-0",children:j.passenger.full_name.charAt(0)}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-bold text-lg text-gray-900",children:j.passenger.full_name}),i.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Er,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),j.passenger.average_rating.toFixed(1)]}),i.jsxs("span",{className:"text-gray-600",children:[j.passenger.total_bookings," bookings"]}),i.jsxs("span",{className:`flex items-center gap-1 font-medium ${O}`,children:[i.jsx(ws,{className:"w-4 h-4"}),j.passenger.reliability_score.toFixed(1)," reliability"]})]}),j.passenger.cancelled_bookings>0&&i.jsxs("div",{className:"mt-2 text-xs text-gray-600 bg-white px-3 py-1 rounded-lg inline-block",children:[" ",j.passenger.cancelled_bookings," cancellations",j.passenger.last_minute_cancellations>0&&` (${j.passenger.last_minute_cancellations} last-minute)`]}),j.passenger.bio&&i.jsxs("p",{className:"mt-2 text-sm text-gray-700 italic",children:['"',j.passenger.bio,'"']})]})]})}),i.jsx("div",{className:"bg-white rounded-lg p-4 mb-4",children:i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[i.jsx(yt,{className:"w-4 h-4 text-blue-600"}),"Trip Details"]}),i.jsxs("div",{className:"space-y-1 text-sm text-gray-700",children:[i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"From:"})," ",j.pickup_location]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"To:"})," ",j.dropoff_location]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Seats:"})," ",j.seats_requested]})]})]}),i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[i.jsx(Ge,{className:"w-4 h-4 text-blue-600"}),"Ride Info"]}),i.jsxs("div",{className:"space-y-1 text-sm text-gray-700",children:[i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Route:"})," ",j.ride.origin,"  ",j.ride.destination]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Departure:"})," ",T(j.ride.departure_time)]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Requested:"})," ",new Date(j.created_at).toLocaleString()]})]})]})]})}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>w(j),disabled:k===j.id,className:"flex-1 bg-green-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:k===j.id?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(vn,{className:"w-5 h-5"}),"Accept"]})}),i.jsx("button",{onClick:()=>N(j),disabled:k===j.id,className:"flex-1 bg-red-600 text-white py-3 px-4 rounded-lg font-semibold hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:k===j.id?"Processing...":i.jsxs(i.Fragment,{children:[i.jsx(al,{className:"w-5 h-5"}),"Reject"]})})]})]},j.id)})}):r==="passengers"?i.jsx("div",{className:"space-y-4",children:h.length===0?i.jsxs("div",{className:"text-center py-12 text-gray-500",children:[i.jsx(ot,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),i.jsx("p",{className:"font-medium mb-2",children:"No confirmed passengers"}),i.jsx("p",{className:"text-sm",children:"Passengers will appear here after you accept booking requests"})]}):h.map(j=>!j.passenger||!j.ride?null:i.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 rounded-xl p-6 border border-green-200",children:[i.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[i.jsx("div",{className:"w-16 h-16 bg-green-200 rounded-full flex items-center justify-center text-2xl font-bold text-green-700 flex-shrink-0",children:j.passenger.full_name.charAt(0)}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-bold text-xl text-gray-900",children:j.passenger.full_name}),i.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-1 text-sm",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Er,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),j.passenger.average_rating.toFixed(1)]}),i.jsxs("span",{className:"text-gray-600",children:[j.passenger.total_bookings," bookings"]}),i.jsxs("span",{className:"flex items-center gap-1 font-medium text-green-600",children:[i.jsx(ws,{className:"w-4 h-4"}),j.passenger.reliability_score.toFixed(1)," reliability"]})]})]})]}),i.jsx("div",{className:"bg-white rounded-lg p-4 mb-4",children:i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[i.jsx(yt,{className:"w-4 h-4 text-blue-600"}),"Ride Details"]}),i.jsxs("div",{className:"space-y-1 text-sm text-gray-700",children:[i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Route:"})," ",j.ride.origin,"  ",j.ride.destination]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Departure:"})," ",T(j.ride.departure_time)]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Seats Booked:"})," ",j.seats_requested]})]})]}),i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[i.jsx(Ge,{className:"w-4 h-4 text-blue-600"}),"Pickup & Drop-off"]}),i.jsxs("div",{className:"space-y-1 text-sm text-gray-700",children:[i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Pickup:"})," ",j.pickup_location]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Drop-off:"})," ",j.dropoff_location]}),i.jsxs("p",{children:[i.jsx("span",{className:"font-medium",children:"Confirmed:"})," ",new Date(j.updated_at).toLocaleString()]})]})]})]})}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("button",{onClick:()=>{e("/messages",{state:{userId:j.passenger.id,userName:j.passenger.full_name}})},className:"flex-1 bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center justify-center gap-2",children:[i.jsx(zi,{className:"w-5 h-5"}),"Message Passenger"]}),j.passenger.phone&&i.jsxs("a",{href:`tel:${j.passenger.phone}`,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center justify-center gap-2",children:[i.jsx(Sr,{className:"w-5 h-5"}),"Call"]})]})]},j.id))}):i.jsx("div",{className:"space-y-4",children:o.length===0?i.jsxs("div",{className:"text-center py-12 text-gray-500",children:[i.jsx(Ge,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),i.jsx("p",{className:"font-medium mb-2",children:"No bookings yet"}),i.jsx("p",{className:"text-sm",children:"Find a ride to get started!"})]}):o.map(j=>{var U,I;const O=S(j.ride.departure_time),R=j.status==="cancelled",P=!O&&!R&&(j.status==="pending"||j.status==="confirmed");return i.jsxs("div",{className:`border rounded-xl p-6 transition-all ${O||R?"border-gray-200 bg-gray-50 opacity-75":"border-gray-200 bg-white hover:shadow-lg cursor-pointer"}`,onClick:()=>{!O&&!R&&e(`/bookings/${j.id}`)},children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${D(j.status,O)}`,children:M(j.status,O)}),O&&i.jsxs("span",{className:"flex items-center gap-1 text-xs text-gray-500",children:[i.jsx(Ye,{className:"w-3 h-3"}),"Past departure time"]})]}),P&&i.jsx("button",{onClick:F=>{F.stopPropagation(),C(j.id,j.ride.departure_time)},className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Cancel Booking",disabled:v===j.id,children:v===j.id?i.jsx("div",{className:"w-4 h-4 border-2 border-red-600 border-t-transparent rounded-full animate-spin"}):i.jsx(al,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex items-center gap-2 text-gray-700 mb-2",children:[i.jsx(yt,{className:"w-5 h-5 text-blue-600"}),i.jsx("span",{className:"font-medium",children:j.pickup_location}),i.jsx("span",{className:"text-gray-400",children:""}),i.jsx("span",{className:"font-medium",children:j.dropoff_location})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Ge,{className:"w-4 h-4"}),T(j.ride.departure_time)]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ot,{className:"w-4 h-4"}),j.seats_requested," ",j.seats_requested===1?"seat":"seats"]})]}),i.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100 text-sm text-gray-600",children:i.jsxs("p",{children:["Driver: ",i.jsx("span",{className:"font-medium",children:(U=j.ride.driver)==null?void 0:U.full_name}),"  ",i.jsxs("span",{className:"text-yellow-600",children:[" ",(I=j.ride.driver)==null?void 0:I.average_rating.toFixed(1)]})]})})]},j.id)})})})]})]})}function Wv({initialUserId:t}){const{user:e}=Oe(),[r,n]=b.useState(new Map),[s,a]=b.useState(t||null),[o,l]=b.useState(""),[c,u]=b.useState(!0),[h,d]=b.useState(""),[f,x]=b.useState(!1),v=b.useRef(null),_=b.useRef(null);b.useEffect(()=>{if(!e)return;g(),t&&a(t);const R=A.channel("messages-recipient").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`recipient_id=eq.${e.id}`},()=>{g(),k()}).subscribe(),P=A.channel("messages-sender").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`sender_id=eq.${e.id}`},()=>{g(),k()}).subscribe(),U=A.channel("messages-update").on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages"},()=>{g()}).subscribe();return()=>{A.removeChannel(R),A.removeChannel(P),A.removeChannel(U)}},[e]),b.useEffect(()=>{k()},[s,r]),b.useEffect(()=>{s&&p(s)},[s,r]);const k=()=>{var R;(R=v.current)==null||R.scrollIntoView({behavior:"smooth"})},g=async()=>{if(e)try{const{data:R,error:P}=await A.from("messages").select(`
          *,
          sender:profiles!messages_sender_id_fkey(*),
          recipient:profiles!messages_recipient_id_fkey(*)
        `).or(`sender_id.eq.${e.id},recipient_id.eq.${e.id}`).order("created_at",{ascending:!1});if(P)throw P;const U=new Map;R.forEach(I=>{const F=I.sender_id===e.id?I.recipient_id:I.sender_id;U.has(F)||U.set(F,[]),U.get(F).push(I)}),U.forEach(I=>{I.sort((F,W)=>new Date(F.created_at).getTime()-new Date(W.created_at).getTime())}),n(U)}catch(R){console.error("Error loading messages:",R)}finally{u(!1)}},p=async R=>{if(!e)return;const U=(r.get(R)||[]).filter(F=>F.recipient_id===e.id&&!F.read);if(U.length===0)return;const I=U.map(F=>F.id);await A.from("messages").update({read:!0}).in("id",I)},m=async R=>{if(R.preventDefault(),!(!e||!s||!o.trim()))try{const{error:P}=await A.from("messages").insert([{sender_id:e.id,recipient_id:s,content:o.trim(),read:!1}]);if(P)throw P;l(""),x(!1),k()}catch(P){console.error("Error sending message:",P)}},y=R=>{l(R.target.value),x(!0),_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{x(!1)},1e3)},E=R=>{const P=R.replace(/[^0-9]/g,"");window.open(`https://wa.me/${P}`,"_blank")},w=R=>{const P=r.get(R);if(!P||P.length===0)return;const U=P[0];return U.sender_id===R?U.sender:U.recipient},N=R=>{const P=r.get(R);return P==null?void 0:P[P.length-1]},C=R=>(r.get(R)||[]).filter(U=>U.recipient_id===(e==null?void 0:e.id)&&!U.read).length,T=R=>{const P=new Date(R),I=new Date().getTime()-P.getTime(),F=Math.floor(I/(1e3*60*60*24));return F===0?P.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"}):F===1?"Yesterday":F<7?P.toLocaleDateString("en-GB",{weekday:"short"}):P.toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"2-digit"})},S=R=>{const P=new Date(R),I=new Date().getTime()-P.getTime(),F=Math.floor(I/(1e3*60*60*24));return F===0?"Today":F===1?"Yesterday":P.toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})},D=(R,P)=>{if(!P)return!0;const U=new Date(R.created_at).toDateString(),I=new Date(P.created_at).toDateString();return U!==I},M=s?r.get(s)||[]:[],j=s?w(s):null,O=Array.from(r.keys()).filter(R=>{const P=w(R);return P==null?void 0:P.full_name.toLowerCase().includes(h.toLowerCase())});return c?i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-50",children:i.jsx("div",{className:"w-12 h-12 border-4 border-green-500 border-t-transparent rounded-full animate-spin"})}):i.jsxs("div",{className:"flex h-[calc(100vh-64px)] bg-gray-50",children:[i.jsxs("div",{className:`w-full md:w-96 bg-white border-r border-gray-200 flex flex-col ${s?"hidden md:flex":"flex"}`,children:[i.jsxs("div",{className:"p-4 bg-green-600 text-white",children:[i.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Messages"}),i.jsxs("div",{className:"relative",children:[i.jsx(pc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"Search conversations...",value:h,onChange:R=>d(R.target.value),className:"w-full pl-10 pr-4 py-2 bg-white text-gray-900 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-300"})]})]}),i.jsx("div",{className:"flex-1 overflow-y-auto",children:O.length===0?i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 p-6",children:[i.jsx(zi,{className:"w-16 h-16 mb-4 text-gray-300"}),i.jsx("p",{className:"text-center",children:"No conversations yet"}),i.jsx("p",{className:"text-sm text-center mt-2",children:"Start chatting from a ride listing"})]}):O.map(R=>{const P=w(R),U=N(R),I=C(R);return i.jsx("button",{onClick:()=>a(R),className:`w-full p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors text-left ${s===R?"bg-green-50":""}`,children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center text-green-700 font-semibold text-lg flex-shrink-0",children:P==null?void 0:P.full_name.charAt(0).toUpperCase()}),I>0&&i.jsx("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-green-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:I})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex items-center justify-between mb-1",children:[i.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:P==null?void 0:P.full_name}),i.jsx("span",{className:"text-xs text-gray-500 flex-shrink-0 ml-2",children:U&&T(U.created_at)})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[(U==null?void 0:U.sender_id)===(e==null?void 0:e.id)&&i.jsx("span",{className:"flex-shrink-0",children:U.read?i.jsx(td,{className:"w-4 h-4 text-blue-500"}):i.jsx(rd,{className:"w-4 h-4 text-gray-400"})}),i.jsx("p",{className:`text-sm truncate ${I>0?"font-semibold text-gray-900":"text-gray-600"}`,children:U==null?void 0:U.content})]})]})]})},R)})})]}),i.jsx("div",{className:`flex-1 flex flex-col bg-gray-50 ${s?"flex":"hidden md:flex"}`,children:j?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white border-b border-gray-200 p-4 flex items-center justify-between shadow-sm",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:()=>a(null),className:"md:hidden p-2 hover:bg-gray-100 rounded-full transition-colors",children:i.jsx(ip,{className:"w-5 h-5 text-gray-600"})}),i.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-700 font-semibold",children:j.full_name.charAt(0).toUpperCase()}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:j.full_name}),i.jsx("p",{className:"text-xs text-gray-500",children:"Click to view profile"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[j.whatsapp_number&&i.jsx("button",{onClick:()=>E(j.whatsapp_number),className:"p-2 hover:bg-gray-100 rounded-full transition-colors",title:"Contact on WhatsApp",children:i.jsx(Sr,{className:"w-5 h-5 text-green-600"})}),i.jsx("button",{className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:i.jsx(Tv,{className:"w-5 h-5 text-gray-600"})})]})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[M.map((R,P)=>{const U=R.sender_id===(e==null?void 0:e.id),I=D(R,P>0?M[P-1]:void 0);return i.jsxs("div",{children:[I&&i.jsx("div",{className:"flex items-center justify-center my-4",children:i.jsx("div",{className:"bg-white px-3 py-1 rounded-full text-xs text-gray-600 shadow-sm",children:S(R.created_at)})}),i.jsx("div",{className:`flex ${U?"justify-end":"justify-start"}`,children:i.jsxs("div",{className:`max-w-[70%] rounded-lg px-4 py-2 ${U?"bg-green-500 text-white":"bg-white text-gray-900 shadow-sm"}`,children:[i.jsx("p",{className:"break-words",children:R.content}),i.jsxs("div",{className:`flex items-center justify-end gap-1 mt-1 ${U?"text-white":"text-gray-500"}`,children:[i.jsx("span",{className:"text-xs opacity-70",children:new Date(R.created_at).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})}),U&&i.jsx("span",{className:"flex-shrink-0",children:R.read?i.jsx(td,{className:"w-4 h-4"}):i.jsx(rd,{className:"w-4 h-4"})})]})]})})]},R.id)}),i.jsx("div",{ref:v})]}),i.jsx("div",{className:"bg-white border-t border-gray-200 p-4",children:i.jsxs("form",{onSubmit:m,className:"flex items-center gap-2",children:[i.jsx("input",{type:"text",value:o,onChange:y,placeholder:"Type a message...",className:"flex-1 px-4 py-3 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent"}),i.jsx("button",{type:"submit",disabled:!o.trim(),className:"p-3 bg-green-500 text-white rounded-full hover:bg-green-600 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:i.jsx(cp,{className:"w-5 h-5"})})]})})]}):i.jsx("div",{className:"flex-1 flex items-center justify-center text-gray-500",children:i.jsxs("div",{className:"text-center",children:[i.jsx(zi,{className:"w-24 h-24 mx-auto mb-4 text-gray-300"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Select a conversation"}),i.jsx("p",{className:"text-gray-400",children:"Choose a conversation from the list to start messaging"})]})})})]})}function Vv(){const t=Rr(),{userId:e,userName:r}=t.state||{};return i.jsx("div",{children:i.jsx(Wv,{initialUserId:e,initialUserName:r})})}function id(t,e=30){if(!t)return!1;const r=new Date(t),n=new Date,s=Math.floor((r.getTime()-n.getTime())/(1e3*60*60*24));return s<=e&&s>=0}function Js(t){return t?new Date(t)<new Date:!1}function Hv(){const{profile:t,updateProfile:e}=Oe(),[r,n]=b.useState(!1),[s,a]=b.useState(!1),[o,l]=b.useState([]),[c,u]=b.useState(""),[h,d]=b.useState(null),[f,x]=b.useState(null),[v,_]=b.useState(!1),[k,g]=b.useState(null),[p,m]=b.useState(!1),y=b.useRef(null),E=b.useRef({}),w=b.useRef(null),[N,C]=b.useState(!1),[T,S]=b.useState(""),[D,M]=b.useState(""),[j,O]=b.useState({full_name:"",phone:"",bio:"",whatsapp_number:"",preferred_contact_method:"both"});b.useEffect(()=>{t&&(R(),O({full_name:t.full_name||"",phone:t.phone||"",bio:t.bio||"",whatsapp_number:t.whatsapp_number||"",preferred_contact_method:t.preferred_contact_method||"both"}))},[t]);const R=async()=>{try{const{data:L,error:z}=await A.from("vehicles").select("*").eq("user_id",t==null?void 0:t.id).eq("is_active",!0).order("created_at",{ascending:!1});if(z)throw z;l(L||[])}catch(L){console.error("Error loading vehicles:",L)}},P=L=>{var de;const z=(de=L.target.files)==null?void 0:de[0];if(z){if(z.size>5*1024*1024){S("Image size should be less than 5MB");return}if(!z.type.startsWith("image/")){S("Please select an image file");return}d(z);const X=new FileReader;X.onloadend=()=>{x(X.result)},X.readAsDataURL(z)}},U=async L=>{if(!h)return null;try{_(!0);const z=h.name.split(".").pop(),X=`vehicles/${`${L}-${Date.now()}.${z}`}`,{error:_e}=await A.storage.from("vehicle-images").upload(X,h,{cacheControl:"3600",upsert:!1});if(_e)throw _e;const{data:{publicUrl:ht}}=A.storage.from("vehicle-images").getPublicUrl(X);return ht}catch(z){return console.error("Error uploading image:",z),null}finally{_(!1)}},I=async L=>{L.preventDefault(),S(""),M(""),C(!0);try{if(!c.trim()){S("Please enter a vehicle number"),C(!1);return}const z=c.trim().toUpperCase(),de="https://uqofmsreosfjflmgurzb.supabase.co/functions/v1/vehicle-lookup",{data:{session:X}}=await A.auth.getSession(),_e=await fetch(de,{method:"POST",headers:{Authorization:`Bearer ${X==null?void 0:X.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({registrationNumber:z})});if(!_e.ok)throw new Error("Failed to lookup vehicle details");const ht=await _e.json();if(!ht.success||!ht.data)throw new Error("Vehicle not found");const le=ht.data,{data:Ar,error:gc}=await A.from("vehicles").insert({user_id:t==null?void 0:t.id,make:le.make,model:le.model,year:le.year,color:le.color,license_plate:z,capacity:le.capacity,fuel_type:le.fuel_type,vehicle_type:le.vehicle_type,registration_year:le.registration_year,engine_capacity:le.engine_capacity,image_url:le.image_url,mot_status:le.mot_status,mot_expiry_date:le.mot_expiry_date,tax_status:le.tax_status,tax_due_date:le.tax_due_date,is_active:!0}).select().single();if(gc)throw gc;if(h&&Ar){const yc=await U(Ar.id);yc&&await A.from("vehicles").update({image_url:yc}).eq("id",Ar.id)}M(`Vehicle added successfully! ${le.make} ${le.model}`),u(""),d(null),x(null),n(!1),await R()}catch(z){S(z.message||"Failed to add vehicle")}finally{C(!1)}},F=async L=>{try{const{error:z}=await A.from("vehicles").update({is_active:!1}).eq("id",L);if(z)throw z;await R()}catch(z){S(z.message||"Failed to remove vehicle")}},W=async L=>{L.preventDefault(),S(""),M(""),C(!0);try{const{error:z}=await e(j);z?S(z.message):(M("Profile updated successfully!"),a(!1),setTimeout(()=>M(""),3e3))}catch(z){S(z.message||"Failed to update profile")}finally{C(!1)}},re=async(L,z)=>{S(""),M(""),g(L),_(!0);try{if(z.size>5*1024*1024){S("Image size should be less than 5MB");return}if(!z.type.startsWith("image/")){S("Please select an image file");return}const de=z.name.split(".").pop(),_e=`vehicles/${`${L}-${Date.now()}.${de}`}`,{error:ht}=await A.storage.from("vehicle-images").upload(_e,z,{cacheControl:"3600",upsert:!1});if(ht)throw ht;const{data:{publicUrl:le}}=A.storage.from("vehicle-images").getPublicUrl(_e),{error:Ar}=await A.from("vehicles").update({image_url:le}).eq("id",L);if(Ar)throw Ar;M("Vehicle image updated successfully!"),await R(),setTimeout(()=>M(""),3e3)}catch(de){S(de.message||"Failed to upload image")}finally{g(null),_(!1)}},ue=async L=>{S(""),M(""),m(!0);try{if(L.size>5*1024*1024){S("Image size should be less than 5MB");return}if(!L.type.startsWith("image/")){S("Please select an image file");return}if(!(t!=null&&t.id)){S("Profile not found");return}const z=L.name.split(".").pop(),X=`avatars/${`${t.id}-${Date.now()}.${z}`}`,{error:_e}=await A.storage.from("vehicle-images").upload(X,L,{cacheControl:"3600",upsert:!1});if(_e)throw _e;const{data:{publicUrl:ht}}=A.storage.from("vehicle-images").getPublicUrl(X),{error:le}=await e({avatar_url:ht});if(le)throw le;M("Profile image updated successfully!"),setTimeout(()=>M(""),3e3)}catch(z){S(z.message||"Failed to upload profile image")}finally{m(!1)}};return t?i.jsxs("div",{className:"space-y-6 max-w-6xl mx-auto px-4 py-6",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"My Profile"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account and preferences"})]}),i.jsxs("div",{className:"bg-white rounded-xl p-6 md:p-8 border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex flex-col md:flex-row items-start gap-6 mb-6",children:[i.jsxs("div",{className:"relative w-24 h-24 flex-shrink-0",children:[i.jsx("div",{className:"w-24 h-24 bg-blue-100 rounded-full flex items-center justify-center",children:t.avatar_url?i.jsx("img",{src:t.avatar_url,alt:t.full_name,className:"w-24 h-24 rounded-full object-cover"}):i.jsx("span",{className:"text-3xl font-bold text-blue-600",children:t.full_name.charAt(0).toUpperCase()})}),i.jsx("input",{type:"file",accept:"image/*",ref:w,onChange:L=>{var de;const z=(de=L.target.files)==null?void 0:de[0];z&&(ue(z),L.target.value="")},className:"hidden"}),i.jsx("button",{onClick:()=>{var L;return(L=w.current)==null?void 0:L.click()},disabled:p,className:"absolute bottom-0 right-0 p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors disabled:bg-blue-300 shadow-lg",title:"Upload profile photo",children:p?i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):i.jsx(jv,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-3 mb-2",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.full_name}),t.is_verified&&i.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:"Verified"})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4 text-sm md:text-base text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Er,{className:"w-4 h-4 md:w-5 md:h-5 text-yellow-400 fill-current"}),t.average_rating.toFixed(1)," rating"]}),i.jsx("span",{className:"hidden md:inline",children:""}),i.jsxs("span",{children:[t.total_rides_offered," rides offered"]}),i.jsx("span",{className:"hidden md:inline",children:""}),i.jsxs("span",{children:[t.total_rides_taken," rides taken"]})]})]}),i.jsxs("button",{onClick:()=>a(!0),className:"w-full md:w-auto px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-2",children:[i.jsx(Iv,{className:"w-4 h-4"}),"Edit Profile"]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-6 pt-6 border-t border-gray-200",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[i.jsx(lp,{className:"w-4 h-4"}),"Email"]}),i.jsx("p",{className:"text-gray-900",children:t.email})]}),t.phone&&i.jsxs("div",{children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[i.jsx(Sr,{className:"w-4 h-4"}),"Phone"]}),i.jsx("p",{className:"text-gray-900",children:t.phone})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[i.jsx(Ge,{className:"w-4 h-4"}),"Member Since"]}),i.jsx("p",{className:"text-gray-900",children:new Date(t.created_at).toLocaleDateString("en-US",{month:"long",year:"numeric"})})]}),t.bio&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:"About"}),i.jsx("p",{className:"text-gray-900",children:t.bio})]})]})]}),i.jsxs("div",{className:"bg-white rounded-xl p-6 md:p-8 border border-gray-200 shadow-sm",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[i.jsxs("h3",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[i.jsx(wt,{className:"w-6 h-6"}),"My Vehicles"]}),i.jsxs("button",{onClick:()=>n(!r),className:"w-full sm:w-auto px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[i.jsx(Av,{className:"w-4 h-4"}),"Add Vehicle"]})]}),T&&i.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800 text-sm",children:T}),D&&i.jsx("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg text-green-800 text-sm",children:D}),r&&i.jsxs("form",{onSubmit:I,className:"mb-6 p-6 bg-gray-50 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Add New Vehicle"}),i.jsx("button",{type:"button",onClick:()=>{n(!1),u(""),d(null),x(null),S("")},className:"text-gray-400 hover:text-gray-600",children:i.jsx(ci,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vehicle Number (License Plate)"}),i.jsx("input",{type:"text",value:c,onChange:L=>u(L.target.value),placeholder:"e.g., ABC-1234",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:N}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Enter your vehicle's license plate number"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Vehicle Photo (Optional)"}),i.jsx("input",{ref:y,type:"file",accept:"image/*",onChange:P,className:"hidden",disabled:N}),i.jsx("div",{className:"flex flex-col gap-3",children:f?i.jsxs("div",{className:"relative w-full h-48 rounded-lg overflow-hidden border-2 border-gray-300",children:[i.jsx("img",{src:f,alt:"Vehicle preview",className:"w-full h-full object-cover"}),i.jsx("button",{type:"button",onClick:()=>{d(null),x(null),y.current&&(y.current.value="")},className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600",children:i.jsx(ci,{className:"w-4 h-4"})})]}):i.jsxs("button",{type:"button",onClick:()=>{var L;return(L=y.current)==null?void 0:L.click()},className:"w-full px-4 py-8 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 transition-colors flex flex-col items-center gap-2 text-gray-600 hover:text-blue-600",disabled:N,children:[i.jsx($v,{className:"w-8 h-8"}),i.jsx("span",{className:"text-sm font-medium",children:"Upload Vehicle Photo"}),i.jsx("span",{className:"text-xs text-gray-500",children:"PNG, JPG up to 5MB"})]})})]}),i.jsx("button",{type:"submit",disabled:N||v,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-300 disabled:cursor-not-allowed",children:N?v?"Uploading image...":"Adding...":"Add Vehicle"})]})]}),o.length===0&&!r?i.jsxs("div",{className:"text-center py-12 text-gray-500",children:[i.jsx(wt,{className:"w-16 h-16 mx-auto mb-4 text-gray-400"}),i.jsx("p",{className:"font-medium mb-2",children:"No vehicles added yet"}),i.jsx("p",{className:"text-sm",children:"Add a vehicle to start offering rides"})]}):i.jsx("div",{className:"space-y-4",children:o.map(L=>i.jsxs("div",{className:"flex flex-col sm:flex-row items-start gap-4 p-4 border border-gray-200 rounded-lg hover:border-blue-300 transition-colors",children:[i.jsxs("div",{className:"relative w-full sm:w-32 h-48 sm:h-24 flex-shrink-0",children:[L.image_url?i.jsx("img",{src:L.image_url,alt:`${L.make} ${L.model}`,className:"w-full h-full object-cover rounded-lg"}):i.jsx("div",{className:"w-full h-full bg-blue-100 rounded-lg flex items-center justify-center",children:i.jsx(wt,{className:"w-12 h-12 sm:w-8 sm:h-8 text-blue-600"})}),i.jsx("input",{type:"file",accept:"image/*",ref:z=>E.current[L.id]=z,onChange:z=>{var X;const de=(X=z.target.files)==null?void 0:X[0];de&&(re(L.id,de),z.target.value="")},className:"hidden"}),i.jsx("button",{onClick:()=>{var z;return(z=E.current[L.id])==null?void 0:z.click()},disabled:k===L.id,className:"absolute bottom-2 right-2 p-1.5 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors disabled:bg-blue-300 shadow-lg",title:L.image_url?"Change image":"Upload image",children:k===L.id?i.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):i.jsx(Ev,{className:"w-4 h-4"})})]}),i.jsx("div",{className:"flex-1 min-w-0 w-full",children:i.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-3",children:[i.jsxs("div",{className:"flex-1 min-w-0 w-full",children:[i.jsxs("p",{className:"font-semibold text-gray-900 text-lg truncate",children:[L.make," ",L.model]}),i.jsx("p",{className:"text-sm text-gray-600 mb-2",children:L.license_plate}),i.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[L.mot_status&&i.jsxs("span",{className:`text-xs px-2 py-1 rounded flex items-center gap-1 font-medium ${L.mot_status.toLowerCase()==="valid"||L.mot_status.toLowerCase()==="not valid"?Js(L.mot_expiry_date)?"bg-red-100 text-red-700":id(L.mot_expiry_date)?"bg-amber-100 text-amber-700":"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:[L.mot_status.toLowerCase()==="valid"&&!Js(L.mot_expiry_date)?i.jsx(vn,{className:"w-3 h-3"}):i.jsx(Ye,{className:"w-3 h-3"}),"MOT: ",L.mot_status,L.mot_expiry_date&&` (${new Date(L.mot_expiry_date).toLocaleDateString("en-GB")})`]}),L.tax_status&&i.jsxs("span",{className:`text-xs px-2 py-1 rounded flex items-center gap-1 font-medium ${L.tax_status.toLowerCase()==="taxed"?Js(L.tax_due_date)?"bg-red-100 text-red-700":id(L.tax_due_date)?"bg-amber-100 text-amber-700":"bg-green-100 text-green-700":L.tax_status.toLowerCase()==="sorn"?"bg-gray-100 text-gray-700":"bg-red-100 text-red-700"}`,children:[L.tax_status.toLowerCase()==="taxed"&&!Js(L.tax_due_date)?i.jsx(vn,{className:"w-3 h-3"}):i.jsx(ws,{className:"w-3 h-3"}),"TAX: ",L.tax_status,L.tax_due_date&&` (${new Date(L.tax_due_date).toLocaleDateString("en-GB")})`]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[L.color&&i.jsxs("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded flex items-center gap-1",children:[i.jsx("span",{className:"w-3 h-3 rounded-full border border-gray-300",style:{backgroundColor:L.color.toLowerCase()}}),L.color]}),i.jsxs("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:[L.capacity," seats"]}),L.fuel_type&&i.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded capitalize",children:L.fuel_type}),L.year&&i.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:L.year}),L.engine_capacity&&i.jsxs("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-1 rounded",children:[L.engine_capacity,"cc"]})]})]}),i.jsx("button",{onClick:()=>F(L.id),className:"w-full sm:w-auto px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors border border-red-200",children:"Remove"})]})})]},L.id))})]}),i.jsxs("div",{className:"bg-white rounded-xl p-6 md:p-8 border border-gray-200 shadow-sm",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-6",children:"Ride Preferences"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-start sm:items-center justify-between gap-4 py-3 border-b border-gray-100",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Auto-accept ride requests"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Automatically accept matching ride requests"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer flex-shrink-0",children:[i.jsx("input",{type:"checkbox",className:"sr-only peer"}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),i.jsxs("div",{className:"flex items-start sm:items-center justify-between gap-4 py-3 border-b border-gray-100",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium text-gray-900",children:"Email notifications"}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Receive email updates about rides"})]}),i.jsxs("label",{className:"relative inline-flex items-center cursor-pointer flex-shrink-0",children:[i.jsx("input",{type:"checkbox",className:"sr-only peer",defaultChecked:!0}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]})]})]}),s&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:i.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Edit Profile"}),i.jsx("button",{onClick:()=>{a(!1),S(""),O({full_name:(t==null?void 0:t.full_name)||"",phone:(t==null?void 0:t.phone)||"",bio:(t==null?void 0:t.bio)||"",whatsapp_number:(t==null?void 0:t.whatsapp_number)||"",preferred_contact_method:(t==null?void 0:t.preferred_contact_method)||"both"})},className:"text-gray-400 hover:text-gray-600",children:i.jsx(ci,{className:"w-5 h-5"})})]}),T&&i.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-800 text-sm flex items-start gap-2",children:[i.jsx(Ye,{className:"w-5 h-5 flex-shrink-0"}),i.jsx("span",{children:T})]}),i.jsxs("form",{onSubmit:W,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),i.jsx("input",{type:"text",value:j.full_name,onChange:L=>O({...j,full_name:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,disabled:N})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),i.jsx("input",{type:"tel",value:j.phone,onChange:L=>O({...j,phone:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+44 1234 567890",disabled:N})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),i.jsx("textarea",{value:j.bio,onChange:L=>O({...j,bio:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:4,placeholder:"Tell us about yourself...",disabled:N})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"WhatsApp Number (Optional)"}),i.jsx("input",{type:"tel",value:j.whatsapp_number,onChange:L=>O({...j,whatsapp_number:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"+44 1234 567890",disabled:N}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Other users can contact you via WhatsApp if provided"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Contact Method"}),i.jsxs("select",{value:j.preferred_contact_method,onChange:L=>O({...j,preferred_contact_method:L.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:N,children:[i.jsx("option",{value:"both",children:"Both (In-app & WhatsApp)"}),i.jsx("option",{value:"in_app",children:"In-app Messages Only"}),i.jsx("option",{value:"whatsapp",children:"WhatsApp Only"})]})]}),i.jsxs("div",{className:"flex gap-3 pt-4",children:[i.jsx("button",{type:"button",onClick:()=>{a(!1),S(""),O({full_name:(t==null?void 0:t.full_name)||"",phone:(t==null?void 0:t.phone)||"",bio:(t==null?void 0:t.bio)||"",whatsapp_number:(t==null?void 0:t.whatsapp_number)||"",preferred_contact_method:(t==null?void 0:t.preferred_contact_method)||"both"})},className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",disabled:N,children:"Cancel"}),i.jsx("button",{type:"submit",disabled:N,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-300 disabled:cursor-not-allowed",children:N?"Saving...":"Save Changes"})]})]})]})})]}):i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full"})})}function fp({origin:t,destination:e,waypoints:r=[],showWeather:n=!0,showAirQuality:s=!0}){const a=b.useRef(null),o=b.useRef(null),l=b.useRef(null),[c,u]=b.useState(null),[h,d]=b.useState(null),[f,x]=b.useState(null),[v,_]=b.useState(!0),[k,g]=b.useState(!0);b.useEffect(()=>{p()},[t,e,r]);const p=async()=>{if(a.current)try{if(typeof google>"u"){const S=document.createElement("script");S.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDiqv8H6yGfUM5itzjpL1pU19I_veBIwHE&libraries=places,geometry",S.async=!0,S.defer=!0,document.head.appendChild(S),await new Promise(D=>{S.onload=D})}const w=new google.maps.Map(a.current,{zoom:10,center:t,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]});o.current=w;const N=new google.maps.TrafficLayer;N.setMap(w),l.current=N,new google.maps.Marker({position:t,map:w,title:t.name,label:"A",icon:{url:"http://maps.google.com/mapfiles/ms/icons/green-dot.png"}}),new google.maps.Marker({position:e,map:w,title:e.name,label:"B",icon:{url:"http://maps.google.com/mapfiles/ms/icons/red-dot.png"}}),r.forEach((S,D)=>{new google.maps.Marker({position:S,map:w,title:S.name,label:String.fromCharCode(67+D)})});const C=await Et.getDirections(t,e,r.map(S=>({location:new google.maps.LatLng(S.lat,S.lng),stopover:!0})));x({distance:C.distance,duration:C.duration}),new google.maps.Polyline({path:[t,e],geodesic:!0,strokeColor:"#3B82F6",strokeOpacity:.8,strokeWeight:5,map:w});const T=new google.maps.LatLngBounds;if(T.extend(t),T.extend(e),r.forEach(S=>T.extend(S)),w.fitBounds(T),n){const S=await Et.getWeather(t.lat,t.lng);u(S)}if(s){const S=await Et.getAirQuality(t.lat,t.lng);d(S)}_(!1)}catch(w){console.error("Error initializing map:",w),_(!1)}},m=w=>w<=50?"text-green-600 bg-green-50":w<=100?"text-yellow-600 bg-yellow-50":w<=150?"text-orange-600 bg-orange-50":w<=200?"text-red-600 bg-red-50":"text-purple-600 bg-purple-50",y=w=>w<=50?"Good":w<=100?"Moderate":w<=150?"Unhealthy for Sensitive":w<=200?"Unhealthy":"Very Unhealthy";b.useEffect(()=>{l.current&&o.current&&l.current.setMap(k?o.current:null)},[k]);const E=()=>{g(!k)};return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{ref:a,className:"w-full h-96 rounded-xl overflow-hidden"}),v&&i.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center rounded-xl",children:i.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full"})}),!v&&i.jsxs("button",{onClick:E,className:`absolute top-4 right-4 px-3 py-2 rounded-lg shadow-lg font-medium flex items-center gap-2 transition-colors text-sm z-10 ${k?"bg-blue-600 text-white hover:bg-blue-700":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-300"}`,children:[i.jsx(vs,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:k?"Hide Traffic":"Show Traffic"}),i.jsx("span",{className:"sm:hidden",children:k?"Hide":"Show"})]})]}),f&&i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Distance"}),i.jsx("p",{className:"text-2xl font-bold text-blue-900",children:f.distance})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"Duration"}),i.jsx("p",{className:"text-2xl font-bold text-blue-900",children:f.duration})]})]})}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[n&&c&&c.condition!=="Unavailable"&&i.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx(ma,{className:"w-5 h-5 text-gray-600"}),i.jsx("h3",{className:"font-semibold text-gray-900",children:"Weather at Origin"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Temperature"}),i.jsxs("span",{className:"font-semibold",children:[c.temperature,"C"]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Condition"}),i.jsx("span",{className:"font-semibold",children:c.condition})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ap,{className:"w-4 h-4 text-blue-500"}),i.jsxs("span",{className:"text-sm",children:[c.humidity,"%"]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(hp,{className:"w-4 h-4 text-gray-500"}),i.jsxs("span",{className:"text-sm",children:[c.windSpeed," km/h"]})]})]})]})]}),s&&h&&h.category!=="Unavailable"&&i.jsxs("div",{className:`border rounded-xl p-4 ${m(h.aqi)}`,children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx(dc,{className:"w-5 h-5"}),i.jsx("h3",{className:"font-semibold",children:"Air Quality"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:"AQI"}),i.jsx("span",{className:"font-bold text-2xl",children:h.aqi})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{children:"Status"}),i.jsx("span",{className:"font-semibold",children:y(h.aqi)})]}),h.dominantPollutant!=="Unknown"&&i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-medium",children:"Pollutant:"})," ",h.dominantPollutant]})]})]})]})]})}function Kv({origin:t,destination:e,departureTime:r,distance:n,duration:s,onRouteSelect:a}){const[o,l]=b.useState(null),[c,u]=b.useState(null),[h,d]=b.useState([]),[f,x]=b.useState([]),[v,_]=b.useState(""),[k,g]=b.useState(!0);b.useEffect(()=>{p()},[t.lat,t.lng,e.lat,e.lng]);const p=async()=>{g(!0);try{const[w,N,C,T]=await Promise.all([Et.getWeatherForecast(e.lat,e.lng,r),Et.getAirQuality(e.lat,e.lng),Et.getPollenData(e.lat,e.lng),Et.getMultipleRouteOptions(t,e)]);l(w),u(N),d(C),x(T),T.length>0&&_(T[0].name)}catch(w){console.error("Error loading insights:",w)}finally{g(!1)}},m=w=>{_(w.name),a&&a(w)},E=(()=>{if(!r)return null;const w=r.getHours();return w>=7&&w<=9?{message:"Rush hour traffic expected. Consider leaving 30 minutes earlier or later.",type:"warning"}:w>=17&&w<=19?{message:"Evening rush hour. Expect delays. Alternative: Leave after 19:30.",type:"warning"}:w>=22||w<=5?{message:"Quiet roads at this time. Great time for travel!",type:"success"}:{message:"Good time to travel with moderate traffic.",type:"info"}})();return k?i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Trip Insights"}),i.jsx("div",{className:"flex items-center justify-center py-8",children:i.jsx("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin"})})]}):i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 space-y-6",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[i.jsx(vs,{className:"w-5 h-5 text-blue-600"}),"Trip Insights & Route Options"]}),f.length>0&&i.jsxs("div",{className:"space-y-3",children:[i.jsxs("h4",{className:"font-medium text-gray-900 flex items-center gap-2",children:[i.jsx(vs,{className:"w-4 h-4"}),"Choose Your Route"]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:f.map(w=>i.jsxs("button",{onClick:()=>m(w),className:`p-4 rounded-lg border-2 text-left transition-all ${v===w.name?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-blue-300 bg-white"}`,children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"font-semibold text-gray-900",children:w.name}),i.jsx("p",{className:"text-sm text-gray-600",children:w.description})]}),w.optimizationType==="ECO_FRIENDLY"&&i.jsx(nd,{className:"w-5 h-5 text-green-600"}),w.optimizationType==="FASTEST"&&i.jsx(hc,{className:"w-5 h-5 text-blue-600"})]}),i.jsxs("div",{className:"flex gap-4 text-sm",children:[i.jsx("span",{className:"text-gray-700",children:i.jsx("span",{className:"font-medium",children:w.distance})}),i.jsx("span",{className:"text-gray-700",children:i.jsx("span",{className:"font-medium",children:w.duration})})]}),w.fuelEfficiency&&i.jsxs("div",{className:"mt-2 text-xs text-green-600 flex items-center gap-1",children:[i.jsx(nd,{className:"w-3 h-3"}),"Fuel efficient route"]})]},w.name))})]}),E&&i.jsxs("div",{className:`p-4 rounded-lg flex items-start gap-3 ${E.type==="warning"?"bg-amber-50 border border-amber-200":E.type==="success"?"bg-green-50 border border-green-200":"bg-blue-50 border border-blue-200"}`,children:[i.jsx(dc,{className:`w-5 h-5 flex-shrink-0 ${E.type==="warning"?"text-amber-600":E.type==="success"?"text-green-600":"text-blue-600"}`}),i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-gray-900 mb-1",children:"Departure Time Recommendation"}),i.jsx("p",{className:"text-sm text-gray-700",children:E.message})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o&&i.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx(ma,{className:"w-5 h-5 text-blue-600"}),i.jsxs("h4",{className:"font-medium text-gray-900",children:["Weather ",r?"Forecast":"Conditions"]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-700",children:"Temperature"}),i.jsxs("span",{className:"font-semibold text-gray-900",children:[o.temperature,"C"]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-700",children:"Condition"}),i.jsx("span",{className:"font-semibold text-gray-900",children:o.condition})]}),i.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(ap,{className:"w-4 h-4"}),o.humidity,"%"]}),i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(hp,{className:"w-4 h-4"}),o.windSpeed," km/h"]})]}),o.forecast&&o.forecast.length>0&&i.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[i.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"5-Day Forecast"}),i.jsx("div",{className:"space-y-1",children:o.forecast.slice(0,3).map((w,N)=>i.jsxs("div",{className:"flex justify-between text-xs text-gray-600",children:[i.jsx("span",{children:w.date}),i.jsxs("span",{children:[w.temperature,"C - ",w.condition]})]},N))})]})]})]}),c&&i.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx(Lv,{className:"w-5 h-5 text-green-600"}),i.jsx("h4",{className:"font-medium text-gray-900",children:"Air Quality"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-700",children:"AQI"}),i.jsx("span",{className:"font-bold px-3 py-1 rounded-full text-white text-sm",style:{backgroundColor:c.color},children:c.aqi})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-700",children:"Category"}),i.jsx("span",{className:"font-semibold text-gray-900",children:c.category})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-700",children:"Main Pollutant"}),i.jsx("span",{className:"font-semibold text-gray-900",children:c.dominantPollutant.toUpperCase()})]}),i.jsx("p",{className:"text-xs text-gray-600 mt-2 pt-2 border-t border-green-200",children:c.healthRecommendations})]})]})]}),h.length>0&&i.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx(Nv,{className:"w-5 h-5 text-purple-600"}),i.jsx("h4",{className:"font-medium text-gray-900",children:"Pollen Levels"})]}),i.jsx("div",{className:"grid grid-cols-3 gap-3",children:h.map((w,N)=>i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:w.plantType}),i.jsx("p",{className:"text-lg font-bold text-purple-600",children:w.index}),i.jsx("p",{className:"text-xs text-gray-600",children:w.category})]},N))}),h[0]&&i.jsx("p",{className:"text-xs text-gray-600 mt-3 pt-3 border-t border-purple-200",children:h[0].description})]})]})}function Gv(){const{rideId:t}=Cf(),{user:e}=Oe(),r=dt(),[n,s]=b.useState(null),[a,o]=b.useState(null),[l,c]=b.useState(!0),[u,h]=b.useState(!1),[d,f]=b.useState(!1),[x,v]=b.useState([]),[_,k]=b.useState(!1),[g,p]=b.useState(1);b.useEffect(()=>{t&&(y(),m())},[t]);const m=async()=>{if(!(!e||!t))try{const{data:D,error:M}=await A.from("ride_bookings").select("id, status, seats_requested, created_at").eq("ride_id",t).eq("passenger_id",e.id).maybeSingle();if(M)throw M;o(D)}catch(D){console.error("Error checking booking:",D)}},y=async()=>{try{const{data:D,error:M}=await A.from("rides").select(`
          *,
          driver:profiles!rides_driver_id_fkey(*),
          vehicle:vehicles(*)
        `).eq("id",t).single();if(M)throw M;s(D),D&&E(D.origin_lat,D.origin_lng)}catch(D){console.error("Error loading ride:",D),r("/find-rides")}finally{c(!1)}},E=async(D,M)=>{try{const j=await Et.searchNearbyPlaces(D,M,"gas_station",3e3);v(j.slice(0,3))}catch(j){console.error("Error loading nearby places:",j)}},w=async(D=1)=>{if(!(!e||!n)){h(!0),k(!1);try{const{data:M,error:j}=await A.rpc("request_booking",{p_ride_id:n.id,p_pickup_location:n.origin,p_pickup_lat:n.origin_lat,p_pickup_lng:n.origin_lng,p_dropoff_location:n.destination,p_dropoff_lat:n.destination_lat,p_dropoff_lng:n.destination_lng,p_seats_requested:D});if(j){const O=j.message.toLowerCase();O.includes("not enough seats")?alert("Sorry, not enough seats available. Please try a different number of seats or refresh the page."):O.includes("not active")?alert("This ride is no longer active."):O.includes("already requested")||j.code==="23505"?alert("You have already requested this ride."):alert(`Failed to request ride: ${j.message}`),await y()}else{const{data:O}=await A.from("profiles").select("total_bookings").eq("id",e.id).single();O&&await A.from("profiles").update({total_bookings:(O.total_bookings||0)+1}).eq("id",e.id),alert("Ride request sent successfully!"),await y(),await m()}}catch(M){console.error("Booking error:",M),alert("Failed to request ride. Please try again."),await y()}finally{h(!1)}}},N=async()=>{if(!a)return;const D=prompt("Please provide a reason for cancellation (optional):");if(D!==null&&confirm("Are you sure you want to cancel this booking?")){f(!0);try{const{error:M}=await A.rpc("cancel_booking",{p_booking_id:a.id,p_reason:D||"No reason provided"});if(M)throw M;alert("Booking cancelled successfully!"),await y(),await m()}catch(M){console.error("Error cancelling booking:",M),alert("Failed to cancel booking. Please try again.")}finally{f(!1)}}},C=()=>{r(`/messages?userId=${n==null?void 0:n.driver.id}`)},T=D=>{const M=new Date(D);return{date:M.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),time:M.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}};if(l)return i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full"})});if(!n)return i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-gray-600",children:"Ride not found"})});const S=T(n.departure_time);return i.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[i.jsxs("button",{onClick:()=>r("/find-rides"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors",children:[i.jsx(ip,{className:"w-5 h-5"}),"Back to Search"]}),i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[i.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-indigo-50",children:i.jsxs("div",{className:"flex items-start justify-between mb-4",children:[i.jsxs("div",{children:[i.jsxs("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:[n.origin,"  ",n.destination]}),i.jsxs("div",{className:"flex items-center gap-4 text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Ge,{className:"w-4 h-4"}),S.date]}),i.jsx("span",{className:"flex items-center gap-1",children:i.jsx("span",{className:"font-semibold",children:S.time})})]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-3xl font-bold text-blue-600",children:n.available_seats}),i.jsx("div",{className:"text-sm text-gray-600",children:"seats available"})]})]})}),i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 cursor-pointer hover:bg-blue-200 transition-colors",onClick:()=>{n.driver.id!==(e==null?void 0:e.id)&&r("/messages",{state:{userId:n.driver.id,userName:n.driver.full_name}})},title:"Click to message driver",children:i.jsx("span",{className:"text-3xl font-bold text-blue-600",children:n.driver.full_name.charAt(0)})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h2",{className:"text-xl font-bold text-gray-900 cursor-pointer hover:text-blue-600 transition-colors",onClick:()=>{n.driver.id!==(e==null?void 0:e.id)&&r("/messages",{state:{userId:n.driver.id,userName:n.driver.full_name}})},title:"Click to message driver",children:n.driver.full_name}),i.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[i.jsxs("span",{className:"flex items-center gap-1 text-gray-600",children:[i.jsx(Er,{className:"w-4 h-4 text-yellow-400 fill-current"}),i.jsx("span",{className:"font-semibold",children:n.driver.average_rating.toFixed(1)})]}),i.jsx("span",{className:"text-gray-400",children:""}),i.jsxs("span",{className:"text-gray-600",children:[n.driver.total_rides_offered," rides completed"]})]}),n.driver.bio&&i.jsx("p",{className:"mt-2 text-gray-600 text-sm",children:n.driver.bio})]}),n.driver.id!==(e==null?void 0:e.id)&&i.jsxs("div",{className:"flex gap-2",children:[(n.driver.preferred_contact_method==="in_app"||n.driver.preferred_contact_method==="both"||!n.driver.preferred_contact_method)&&i.jsxs("button",{onClick:C,className:"px-4 py-2 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors flex items-center gap-2",children:[i.jsx(fc,{className:"w-4 h-4"}),"Message"]}),n.driver.whatsapp_number&&(n.driver.preferred_contact_method==="whatsapp"||n.driver.preferred_contact_method==="both"||!n.driver.preferred_contact_method)&&i.jsxs("button",{onClick:()=>{const D=n.driver.whatsapp_number.replace(/[^0-9]/g,"");window.open(`https://wa.me/${D}`,"_blank")},className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors flex items-center gap-2",children:[i.jsx(Sr,{className:"w-4 h-4"}),"WhatsApp"]})]})]})}),n.vehicle&&i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[i.jsx(wt,{className:"w-5 h-5 text-blue-600"}),"Vehicle Information"]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Model:"}),i.jsxs("span",{className:"ml-2 font-medium",children:[n.vehicle.year," ",n.vehicle.make," ",n.vehicle.model]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Color:"}),i.jsx("span",{className:"ml-2 font-medium",children:n.vehicle.color})]}),n.vehicle.fuel_type&&i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Fuel Type:"}),i.jsx("span",{className:"ml-2 font-medium capitalize",children:n.vehicle.fuel_type})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Capacity:"}),i.jsxs("span",{className:"ml-2 font-medium",children:[n.vehicle.capacity-1," passengers"]}),i.jsxs("span",{className:"text-gray-500 text-sm ml-1",children:["(offering ",n.total_seats," seats for this ride)"]})]})]})]}),i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[i.jsx(yt,{className:"w-5 h-5 text-blue-600"}),"Route Information"]}),i.jsx(fp,{origin:{lat:n.origin_lat,lng:n.origin_lng,name:n.origin},destination:{lat:n.destination_lat,lng:n.destination_lng,name:n.destination},showWeather:!0,showAirQuality:!0})]}),i.jsx("div",{className:"p-6 border-b border-gray-200",children:i.jsx(Kv,{origin:{lat:n.origin_lat,lng:n.origin_lng},destination:{lat:n.destination_lat,lng:n.destination_lng},departureTime:new Date(n.departure_time),distance:n.estimated_distance||void 0,duration:n.estimated_duration||void 0})}),x.length>0&&i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[i.jsx(vs,{className:"w-5 h-5 text-blue-600"}),"Nearby Gas Stations"]}),i.jsx("div",{className:"space-y-2",children:x.map((D,M)=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-gray-900",children:D.name}),i.jsx("p",{className:"text-sm text-gray-600",children:D.address})]}),D.rating&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Er,{className:"w-4 h-4 text-yellow-400 fill-current"}),i.jsx("span",{className:"text-sm font-medium",children:D.rating.toFixed(1)})]})]},M))})]}),n.notes&&i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Additional Notes"}),i.jsx("p",{className:"text-gray-600",children:n.notes})]}),n.driver.id!==(e==null?void 0:e.id)&&i.jsx("div",{className:"p-6 bg-gray-50",children:a&&a.status!=="cancelled"?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-white border-2 border-green-500 rounded-xl p-6",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-green-600 text-xl",children:""})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Booking Confirmed"}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Status: ",i.jsx("span",{className:`font-medium ${a.status==="confirmed"?"text-green-600":a.status==="pending"?"text-yellow-600":"text-gray-600"}`,children:a.status})]})]})]}),i.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-3",children:[i.jsxs("span",{children:["Seats: ",a.seats_requested]}),i.jsxs("span",{children:["Booked: ",new Date(a.created_at).toLocaleDateString()]})]}),i.jsx("button",{onClick:()=>r(`/bookings/${a.id}`),className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors mb-2",children:"View Booking Details"})]}),(a.status==="pending"||a.status==="confirmed")&&i.jsx("button",{onClick:N,disabled:d,className:"w-full bg-red-600 text-white py-3 rounded-xl font-semibold hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Cancelling...":"Cancel Booking"})]}):a&&a.status==="cancelled"?i.jsxs("div",{className:"bg-white border-2 border-red-200 rounded-xl p-6",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx("span",{className:"text-red-600 text-xl",children:""})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-gray-900",children:"Booking Cancelled"}),i.jsx("p",{className:"text-sm text-gray-600",children:"You cancelled this booking"})]})]}),i.jsx("button",{onClick:()=>k(!0),disabled:u||n.available_seats===0,className:"w-full bg-blue-600 text-white py-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed mt-3",children:u?"Sending Request...":n.available_seats===0?"No Seats Available":"Request Again"})]}):i.jsx("button",{onClick:()=>k(!0),disabled:u||n.available_seats===0,className:"w-full bg-blue-600 text-white py-4 rounded-xl font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Sending Request...":n.available_seats===0?"No Seats Available":"Request This Ride"})})]}),_&&n&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[60] p-4",children:i.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-md w-full",children:[i.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"Select Number of Seats"}),i.jsx("p",{className:"text-gray-600 mb-6",children:"How many seats do you need?"}),i.jsx("div",{className:"grid grid-cols-4 gap-3 mb-6",children:[...Array(Math.min(n.available_seats,8))].map((D,M)=>i.jsx("button",{onClick:()=>p(M+1),className:`py-3 px-4 rounded-lg font-semibold transition-all ${g===M+1?"bg-blue-600 text-white ring-2 ring-blue-400":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:M+1},M+1))}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[i.jsxs("p",{className:"text-sm text-gray-700",children:[i.jsx("span",{className:"font-semibold",children:"Selected:"})," ",g," seat",g>1?"s":""]}),i.jsxs("p",{className:"text-sm text-gray-700",children:[i.jsx("span",{className:"font-semibold",children:"Available:"})," ",n.available_seats," seat",n.available_seats>1?"s":""]})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx("button",{onClick:()=>k(!1),className:"flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors",children:"Cancel"}),i.jsx("button",{onClick:()=>w(g),className:"flex-1 bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors",children:"Confirm Request"})]})]})})]})}function Qv(){const{bookingId:t}=Cf(),e=dt(),{user:r}=Oe(),[n,s]=b.useState(null),[a,o]=b.useState(!0),[l,c]=b.useState(null),[u,h]=b.useState(!1),[d,f]=b.useState(!1),[x,v]=b.useState(null);b.useEffect(()=>{t&&r?_():r||(v("Please sign in to view booking details"),o(!1))},[t,r]);const _=async()=>{try{const{data:S,error:D}=await A.from("ride_bookings").select(`
          *,
          ride:rides(
            *,
            driver:profiles!rides_driver_id_fkey(*),
            vehicle:vehicles(*)
          )
        `).eq("id",t).maybeSingle();if(D)throw D;if(!S){console.error("Booking not found"),v("Booking not found"),o(!1);return}s(S),v(null),S!=null&&S.ride&&k(S.ride.origin_lat,S.ride.origin_lng)}catch(S){console.error("Error loading booking:",S),console.error("Error details:",S==null?void 0:S.message,S==null?void 0:S.details),v((S==null?void 0:S.message)||"Failed to load booking details"),o(!1)}},k=async(S,D)=>{try{const j=await(await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${S}&longitude=${D}&current=temperature_2m,weather_code,wind_speed_10m`)).json();c(j.current)}catch(M){console.error("Error loading weather:",M)}},g=async()=>{const S=prompt("Please provide a reason for cancellation (optional):");if(S!==null&&confirm("Are you sure you want to cancel this booking?")){h(!0);try{const{error:D}=await A.rpc("cancel_booking",{p_booking_id:t,p_reason:S||"No reason provided"});if(D)throw D;alert("Booking cancelled successfully!"),e("/my-rides")}catch(D){console.error("Error cancelling booking:",D);const M=D.message||"Failed to cancel booking. Please try again.";M.includes("already cancelled")?alert("This booking is already cancelled."):alert(M)}finally{h(!1)}}},p=()=>{f(!0),navigator.geolocation&&navigator.geolocation.getCurrentPosition(S=>{const D=`EMERGENCY: I need help!

Booking ID: ${t}
Driver: ${n==null?void 0:n.ride.driver.full_name}
My Location: https://www.google.com/maps?q=${S.coords.latitude},${S.coords.longitude}

This is an automated emergency alert.`;alert(`SOS Activated!

`+D+`

In a real emergency:
1. Call emergency services (911)
2. Contact driver
3. Share your live location with trusted contacts`),f(!1)},S=>{console.error("Location error:",S),alert("Could not get your location. Please call emergency services immediately if you need help."),f(!1)})},m=()=>{if(n){const S=`https://www.google.com/maps/dir/?api=1&origin=${n.ride.origin_lat},${n.ride.origin_lng}&destination=${n.ride.destination_lat},${n.ride.destination_lng}`;window.open(S,"_blank")}},y=()=>{n!=null&&n.ride.driver.phone?window.location.href=`tel:${n.ride.driver.phone}`:alert("Driver phone number not available")},E=async()=>{n!=null&&n.ride.driver.id&&e(`/messages?userId=${n.ride.driver.id}`)},w=S=>new Date(S).toLocaleString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"}),N=()=>{if(!n)return"";const S=new Date,M=new Date(n.ride.departure_time).getTime()-S.getTime(),j=Math.floor(M/(1e3*60*60)),O=Math.floor(M%(1e3*60*60)/(1e3*60));return j<0?"Departed":j===0?`${O} minutes`:`${j}h ${O}m`};if(a)return i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx("div",{className:"animate-spin w-12 h-12 border-4 border-blue-600 border-t-transparent rounded-full"})});if(x)return i.jsx("div",{className:"max-w-2xl mx-auto",children:i.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-6 text-center",children:[i.jsx(Ye,{className:"w-12 h-12 text-red-600 mx-auto mb-4"}),i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error Loading Booking"}),i.jsx("p",{className:"text-gray-600 mb-4",children:x}),i.jsx("button",{onClick:()=>e("/my-rides"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Back to My Rides"})]})});if(!n)return i.jsxs("div",{className:"text-center py-12",children:[i.jsx("p",{className:"text-gray-600",children:"Booking not found"}),i.jsx("button",{onClick:()=>e("/my-rides"),className:"mt-4 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Back to My Rides"})]});const C=n.status==="pending"||n.status==="confirmed",T=new Date(n.ride.departure_time)>new Date;return i.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Your Booking"}),i.jsx("p",{className:"text-gray-600 mt-1",children:"Trip details and information"})]}),i.jsx("span",{className:`px-4 py-2 rounded-full text-sm font-medium ${n.status==="confirmed"?"bg-green-100 text-green-800":n.status==="pending"?"bg-yellow-100 text-yellow-800":n.status==="cancelled"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"}`,children:n.status})]}),T&&n.status==="confirmed"&&i.jsx("div",{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-xl p-6 shadow-lg",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"text-white",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(ws,{className:"w-6 h-6"}),i.jsx("h3",{className:"text-xl font-bold",children:"Emergency SOS"})]}),i.jsx("p",{className:"text-red-100 text-sm",children:"Press this button in case of emergency. Your location will be shared."})]}),i.jsx("button",{onClick:p,disabled:d,className:"bg-white text-red-600 px-8 py-4 rounded-xl font-bold text-lg hover:bg-red-50 transition-colors disabled:opacity-50 shadow-lg",children:d?i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"animate-spin w-5 h-5 border-3 border-red-600 border-t-transparent rounded-full"}),i.jsx("span",{children:"ACTIVATING..."})]}):i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(dc,{className:"w-6 h-6"}),i.jsx("span",{children:"SOS"})]})})]})}),i.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(hc,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Time Until Departure"}),i.jsx("p",{className:"text-xl font-bold text-gray-900",children:N()})]})]})}),i.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:i.jsx(ot,{className:"w-5 h-5 text-green-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Seats Booked"}),i.jsx("p",{className:"text-xl font-bold text-gray-900",children:n.seats_requested})]})]})}),l&&i.jsx("div",{className:"bg-sky-50 border border-sky-200 rounded-xl p-6",children:i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"p-2 bg-sky-100 rounded-lg",children:i.jsx(ma,{className:"w-5 h-5 text-sky-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Weather at Origin"}),i.jsxs("p",{className:"text-xl font-bold text-gray-900",children:[l.temperature_2m,"C"]})]})]})})]}),i.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[i.jsx(yt,{className:"w-5 h-5 text-blue-600"}),"Trip Route"]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Pick-up Location"}),i.jsx("p",{className:"font-medium text-gray-900",children:n.pickup_location})]}),i.jsxs("div",{className:"border-l-2 border-blue-200 pl-4 ml-2",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Drop-off Location"}),i.jsx("p",{className:"font-medium text-gray-900",children:n.dropoff_location})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Departure Time"}),i.jsx("p",{className:"font-medium text-gray-900",children:w(n.ride.departure_time)})]})]}),i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[i.jsx(ot,{className:"w-5 h-5 text-blue-600"}),"Driver Information"]}),i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center text-2xl font-bold text-blue-600",children:n.ride.driver.full_name.charAt(0)}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-semibold text-lg text-gray-900",children:n.ride.driver.full_name}),i.jsxs("div",{className:"flex items-center gap-3 mt-1 text-sm text-gray-600",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Er,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),n.ride.driver.average_rating.toFixed(1)]}),i.jsxs("span",{children:[n.ride.driver.total_rides," rides"]})]}),n.ride.driver.bio&&i.jsx("p",{className:"mt-2 text-sm text-gray-600",children:n.ride.driver.bio})]})]}),i.jsxs("div",{className:"flex gap-3 flex-wrap mt-4",children:[n.ride.driver.phone&&i.jsxs("button",{onClick:y,className:"flex items-center justify-center gap-2 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[i.jsx(Sr,{className:"w-4 h-4"}),"Call Driver"]}),(n.ride.driver.preferred_contact_method==="in_app"||n.ride.driver.preferred_contact_method==="both"||!n.ride.driver.preferred_contact_method)&&i.jsxs("button",{onClick:E,className:"flex items-center justify-center gap-2 px-4 py-3 border border-blue-600 text-blue-600 rounded-lg hover:bg-blue-50 transition-colors",children:[i.jsx(fc,{className:"w-4 h-4"}),"Message"]}),n.ride.driver.whatsapp_number&&(n.ride.driver.preferred_contact_method==="whatsapp"||n.ride.driver.preferred_contact_method==="both"||!n.ride.driver.preferred_contact_method)&&i.jsxs("button",{onClick:()=>{const S=n.ride.driver.whatsapp_number.replace(/[^0-9]/g,"");window.open(`https://wa.me/${S}`,"_blank")},className:"flex items-center justify-center gap-2 px-4 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[i.jsx(Sr,{className:"w-4 h-4"}),"WhatsApp"]})]})]}),n.ride.vehicle&&i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[i.jsx(wt,{className:"w-5 h-5 text-blue-600"}),"Vehicle Information"]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Model:"}),i.jsxs("span",{className:"ml-2 font-medium",children:[n.ride.vehicle.year," ",n.ride.vehicle.make," ",n.ride.vehicle.model]})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"Color:"}),i.jsx("span",{className:"ml-2 font-medium",children:n.ride.vehicle.color})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-600",children:"License Plate:"}),i.jsx("span",{className:"ml-2 font-medium font-mono",children:n.ride.vehicle.license_plate})]})]})]}),i.jsxs("div",{className:"p-6 border-b border-gray-200",children:[i.jsxs("h3",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[i.jsx(yt,{className:"w-5 h-5 text-blue-600"}),"Route Map"]}),i.jsx(fp,{origin:{lat:n.ride.origin_lat,lng:n.ride.origin_lng,name:n.ride.origin},destination:{lat:n.ride.destination_lat,lng:n.ride.destination_lng,name:n.ride.destination}}),i.jsxs("button",{onClick:m,className:"w-full mt-4 flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[i.jsx(vs,{className:"w-4 h-4"}),"Open in Google Maps"]})]}),i.jsxs("div",{className:"p-6 bg-gray-50",children:[i.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Booking Summary"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Seats"}),i.jsx("span",{className:"font-medium",children:n.seats_requested})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Price per seat"}),i.jsxs("span",{className:"font-medium",children:["$",n.ride.price_per_seat]})]}),i.jsxs("div",{className:"border-t border-gray-300 pt-2 mt-2 flex justify-between font-semibold",children:[i.jsx("span",{children:"Total Cost"}),i.jsxs("span",{className:"text-blue-600",children:["$",n.ride.price_per_seat*n.seats_requested]})]})]})]})]}),C&&T&&i.jsxs("div",{className:"bg-white rounded-xl border border-red-200 p-6",children:[i.jsxs("h3",{className:"font-semibold text-gray-900 mb-2 flex items-center gap-2",children:[i.jsx(al,{className:"w-5 h-5 text-red-600"}),"Cancel Booking"]}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"You can cancel this booking. Note: Cancellations within 24 hours of departure may affect your reliability score."}),i.jsx("button",{onClick:g,disabled:u,className:"px-6 py-3 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Cancelling...":"Cancel Booking"})]})]})}function Jv(){return i.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:i.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[i.jsx(kv,{className:"w-8 h-8 text-blue-600"}),i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Terms of Service"})]}),i.jsxs("div",{className:"prose prose-blue max-w-none space-y-6 text-gray-700",children:[i.jsxs("p",{className:"text-sm text-gray-500",children:["Last Updated: ",new Date().toLocaleDateString()]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"1. Acceptance of Terms"}),i.jsx("p",{children:"By accessing and using Carpool Network (carpoolnetwork.co.uk), you accept and agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use the service."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"2. Service Description"}),i.jsx("p",{children:"Our platform connects drivers and passengers for carpooling purposes. We are solely a technology platform that facilitates connections between users. We are not a transportation provider, taxi service, or payment processor. All arrangements between drivers and passengers, including any cost contributions, are made privately between users."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"3. User Requirements"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800 mt-4 mb-2",children:"For All Users:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Must be at least 18 years of age"}),i.jsx("li",{children:"Must provide accurate and complete information"}),i.jsx("li",{children:"Must maintain account security"}),i.jsx("li",{children:"Must not share account credentials"})]}),i.jsx("h3",{className:"text-lg font-medium text-gray-800 mt-4 mb-2",children:"For Drivers:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Must hold a valid UK full driving license or international license (within 12 months of UK arrival)"}),i.jsx("li",{children:"License must be verified and not banned or suspended"}),i.jsx("li",{children:"Must have appropriate vehicle insurance as required by UK law"}),i.jsx("li",{children:"Vehicle must be roadworthy and meet MOT/tax requirements"}),i.jsx("li",{children:"Must comply with all UK traffic laws and regulations"}),i.jsx("li",{children:"Responsible for ensuring insurance covers intended usage"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"4. License Verification"}),i.jsx("p",{children:"All drivers must provide valid driving license details for verification purposes:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Valid UK full driving license or international license"}),i.jsx("li",{children:"For international licenses: must be within 12 months of UK arrival"}),i.jsx("li",{children:"License must not be banned, suspended, or expired"})]}),i.jsx("p",{className:"mt-3",children:"We reserve the right to verify licenses with DVLA and suspend accounts with invalid or banned licenses."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"5. Private Arrangements"}),i.jsx("p",{children:"Important: The platform does not handle, process, or facilitate any payments."}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"All cost-sharing arrangements are private between driver and passengers"}),i.jsx("li",{children:"Users must arrange payment methods directly with each other"}),i.jsx("li",{children:"Platform is not involved in any financial transactions"}),i.jsx("li",{children:"Platform is not responsible for payment disputes"}),i.jsx("li",{children:"Any cost contributions must comply with UK ridesharing laws"}),i.jsx("li",{children:"Drivers must ensure they do not operate as a commercial taxi service"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"6. Safety and Conduct"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Users must treat each other with respect"}),i.jsx("li",{children:"No harassment, discrimination, or inappropriate behavior"}),i.jsx("li",{children:"Report safety concerns immediately"}),i.jsx("li",{children:"Emergency contacts should be provided and kept current"}),i.jsx("li",{children:"Users may be removed for violations"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"7. Cancellation Policy"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Users should provide reasonable notice for cancellations"}),i.jsx("li",{children:"Repeated last-minute cancellations may result in account restrictions"}),i.jsx("li",{children:"Any cost-related matters are between users only"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"8. Liability"}),i.jsx("p",{children:"The platform acts only as an intermediary:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"We are not responsible for user actions or behavior"}),i.jsx("li",{children:"We are not liable for accidents, injuries, or property damage"}),i.jsx("li",{children:"Users engage in ridesharing at their own risk"}),i.jsx("li",{children:"Driver insurance is primary coverage for incidents"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"9. Account Termination"}),i.jsx("p",{children:"We reserve the right to suspend or terminate accounts for:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Violation of terms"}),i.jsx("li",{children:"Fraudulent activity"}),i.jsx("li",{children:"Safety concerns"}),i.jsx("li",{children:"Invalid or expired licenses"}),i.jsx("li",{children:"Misuse of platform"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"10. Changes to Terms"}),i.jsx("p",{children:"We may update these terms periodically. Continued use of the service constitutes acceptance of modified terms."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"11. Contact Information"}),i.jsx("p",{children:"For questions about these terms, please contact us at support@carpoolnetwork.co.uk or through the platform's support system."})]})]})]})})})}function Yv(){return i.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:i.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[i.jsx(ws,{className:"w-8 h-8 text-blue-600"}),i.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Privacy Policy"})]}),i.jsxs("div",{className:"prose prose-blue max-w-none space-y-6 text-gray-700",children:[i.jsxs("p",{className:"text-sm text-gray-500",children:["Last Updated: ",new Date().toLocaleDateString()]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"1. Introduction"}),i.jsx("p",{children:"This Privacy Policy explains how Carpool Network (carpoolnetwork.co.uk) collects, uses, discloses, and safeguards your information when you use our carpooling platform. We are committed to protecting your privacy and complying with UK GDPR and Data Protection Act 2018."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"2. Information We Collect"}),i.jsx("h3",{className:"text-lg font-medium text-gray-800 mt-4 mb-2",children:"Personal Information:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Name, email address, phone number"}),i.jsx("li",{children:"Date of birth (for age verification)"}),i.jsx("li",{children:"Profile photo"}),i.jsx("li",{children:"Emergency contact information"})]}),i.jsx("h3",{className:"text-lg font-medium text-gray-800 mt-4 mb-2",children:"Driver Information:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Driving license number and details"}),i.jsx("li",{children:"License verification status"}),i.jsx("li",{children:"International arrival date (if applicable)"}),i.jsx("li",{children:"Vehicle information (make, model, registration)"})]}),i.jsx("h3",{className:"text-lg font-medium text-gray-800 mt-4 mb-2",children:"Usage Information:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Ride history (origins, destinations, times)"}),i.jsx("li",{children:"Messages between users"}),i.jsx("li",{children:"Reviews and ratings"}),i.jsx("li",{children:"Location data for ride matching"})]}),i.jsx("h3",{className:"text-lg font-medium text-gray-800 mt-4 mb-2",children:"Technical Information:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"IP address and device information"}),i.jsx("li",{children:"Browser type and version"}),i.jsx("li",{children:"Usage analytics"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"3. How We Use Your Information"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"To provide and maintain the connection platform"}),i.jsx("li",{children:"To verify driver licenses with DVLA"}),i.jsx("li",{children:"To check license ban status"}),i.jsx("li",{children:"To facilitate ride matching and connections"}),i.jsx("li",{children:"To enable communication between users"}),i.jsx("li",{children:"To ensure safety and security"}),i.jsx("li",{children:"To improve our service"}),i.jsx("li",{children:"To comply with legal obligations"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"4. Legal Basis for Processing (UK GDPR)"}),i.jsx("p",{children:"We process your data based on:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Contract:"})," To provide ridesharing services"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Legal Obligation:"})," To verify licenses and comply with transport regulations"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Legitimate Interest:"})," To ensure safety and prevent fraud"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Consent:"})," For optional features like location tracking"]})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"5. Information Sharing"}),i.jsx("p",{children:"We share information with:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Other Users:"})," Profile info, ratings, and ride details for matched connections"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"DVLA:"})," License verification queries"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Law Enforcement:"})," When required by law or for safety"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Service Providers:"})," Cloud hosting, analytics (with appropriate safeguards)"]})]}),i.jsx("p",{className:"mt-3",children:"We do not sell your personal information to third parties. We do not process any payments or financial transactions."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"6. Data Security"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"License numbers are encrypted in storage"}),i.jsx("li",{children:"Secure transmission using HTTPS"}),i.jsx("li",{children:"Regular security audits"}),i.jsx("li",{children:"Access controls and authentication"}),i.jsx("li",{children:"However, no method is 100% secure"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"7. Data Retention"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Active account data: Retained while account is active"}),i.jsx("li",{children:"Ride history: 7 years (for legal/insurance purposes)"}),i.jsx("li",{children:"Messages: 2 years after last activity"}),i.jsx("li",{children:"License verification: Until license expires or account closes"}),i.jsx("li",{children:"Deleted accounts: Anonymized after 30 days, except where legally required"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"8. Your Rights (UK GDPR)"}),i.jsx("p",{children:"You have the right to:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Access:"})," Request copies of your personal data"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Rectification:"})," Correct inaccurate information"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Erasure:"})," Request deletion (subject to legal requirements)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Restriction:"})," Limit processing of your data"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Portability:"})," Receive your data in machine-readable format"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Object:"})," Object to processing based on legitimate interests"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Withdraw Consent:"})," For consent-based processing"]})]}),i.jsx("p",{className:"mt-3",children:"To exercise these rights, contact us at privacy@carpoolnetwork.co.uk or through the platform."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"9. Cookies and Tracking"}),i.jsx("p",{children:"We use essential cookies for:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Authentication and security"}),i.jsx("li",{children:"Session management"}),i.jsx("li",{children:"User preferences"})]}),i.jsx("p",{className:"mt-3",children:"You can control cookies through browser settings."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"10. International Transfers"}),i.jsx("p",{children:"Your data is primarily stored in UK/EU servers. Any international transfers comply with UK GDPR requirements including appropriate safeguards."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"11. Children's Privacy"}),i.jsx("p",{children:"Our service is not intended for users under 18. We do not knowingly collect data from children."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"12. Changes to Privacy Policy"}),i.jsx("p",{children:"We may update this policy periodically. Material changes will be notified via email or platform notification."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"13. Contact Us"}),i.jsx("p",{children:"For privacy concerns or to exercise your rights:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"Use the platform's support system"}),i.jsx("li",{children:"You also have the right to lodge a complaint with the ICO (Information Commissioner's Office)"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-3",children:"14. DVLA License Verification"}),i.jsx("p",{children:"By using this service as a driver, you consent to us verifying your driving license with DVLA, including:"}),i.jsxs("ul",{className:"list-disc pl-6 space-y-2",children:[i.jsx("li",{children:"License validity checks"}),i.jsx("li",{children:"Ban and suspension status"}),i.jsx("li",{children:"Endorsement and penalty points"}),i.jsx("li",{children:"Regular automated checks for ongoing verification"})]})]})]})]})})})}class Br{static async postRide(e,r){try{let n=r.vehicleId;if(!n){const{data:o}=await A.from("vehicles").select("id").eq("user_id",e).eq("is_active",!0).limit(1).maybeSingle();if(!o)return{success:!1,message:"You need to add a vehicle first. Please go to your profile to add a vehicle."};n=o.id}const{data:s,error:a}=await A.from("rides").insert({driver_id:e,vehicle_id:n,origin:r.origin,origin_lat:r.originLat,origin_lng:r.originLng,destination:r.destination,destination_lat:r.destinationLat,destination_lng:r.destinationLng,departure_time:r.departureTime,available_seats:r.availableSeats,total_seats:r.availableSeats,notes:r.notes,status:"active"}).select().single();if(a)throw a;return{success:!0,message:`Ride posted successfully! Your ride from ${r.origin} to ${r.destination} is now available for booking.`,data:s}}catch(n){return console.error("Error posting ride:",n),{success:!1,message:"Failed to post ride. Please try again."}}}static async bookRide(e,r){try{const{data:n,error:s}=await A.from("rides").select("available_seats, driver_id").eq("id",r.rideId).single();if(s||!n)return{success:!1,message:"Ride not found."};if(n.driver_id===e)return{success:!1,message:"You cannot book your own ride."};const a=r.seatsRequested||1;if(n.available_seats<a)return{success:!1,message:`Not enough seats available. Only ${n.available_seats} seat(s) remaining.`};const{data:o,error:l}=await A.from("ride_bookings").insert({ride_id:r.rideId,passenger_id:e,pickup_location:r.pickupLocation,pickup_lat:r.pickupLat,pickup_lng:r.pickupLng,dropoff_location:r.dropoffLocation,dropoff_lat:r.dropoffLat,dropoff_lng:r.dropoffLng,seats_requested:a,status:"pending"}).select().single();if(l)throw l;return{success:!0,message:`Booking request sent! Your booking ID is ${o.id}. The driver will review your request soon.`,data:o}}catch(n){return console.error("Error booking ride:",n),{success:!1,message:"Failed to book ride. Please try again."}}}static async cancelRide(e,r,n){try{const{data:s,error:a}=await A.from("rides").select("*").eq("id",r).eq("driver_id",e).single();if(a||!s)return{success:!1,message:"Ride not found or you do not have permission to cancel it."};if(s.status==="cancelled")return{success:!1,message:"This ride is already cancelled."};const{error:o}=await A.from("rides").update({status:"cancelled"}).eq("id",r);if(o)throw o;return await A.from("ride_bookings").update({status:"cancelled",cancellation_reason:n||"Ride cancelled by driver"}).eq("ride_id",r),{success:!0,message:"Ride cancelled successfully. All bookings have been notified."}}catch(s){return console.error("Error cancelling ride:",s),{success:!1,message:"Failed to cancel ride. Please try again."}}}static async cancelBooking(e,r,n){try{const{error:s}=await A.rpc("cancel_booking",{p_booking_id:r,p_reason:n||"Cancelled by passenger"});if(s){if(s.message.includes("already cancelled"))return{success:!1,message:"This booking is already cancelled."};if(s.message.includes("not found"))return{success:!1,message:"Booking not found or you do not have permission to cancel it."};throw s}return{success:!0,message:"Booking cancelled successfully."}}catch(s){return console.error("Error cancelling booking:",s),{success:!1,message:s.message||"Failed to cancel booking. Please try again."}}}static async updateProfile(e,r){try{const{data:n,error:s}=await A.from("profiles").update({...r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw s;return{success:!0,message:"Profile updated successfully!",data:n}}catch(n){return console.error("Error updating profile:",n),{success:!1,message:"Failed to update profile. Please try again."}}}static async addVehicle(e,r){try{const{data:n,error:s}=await A.from("vehicles").insert({user_id:e,...r,is_active:!0}).select().single();if(s)throw s;return{success:!0,message:`Vehicle ${r.make} ${r.model} added successfully!`,data:n}}catch(n){return console.error("Error adding vehicle:",n),{success:!1,message:"Failed to add vehicle. Please try again."}}}static async updateVehicle(e,r,n){try{const{data:s,error:a}=await A.from("vehicles").update({...n,updated_at:new Date().toISOString()}).eq("id",r).eq("user_id",e).select().single();if(a)throw a;return{success:!0,message:"Vehicle updated successfully!",data:s}}catch(s){return console.error("Error updating vehicle:",s),{success:!1,message:"Failed to update vehicle. Please try again."}}}static async updatePreferences(e,r){try{const{data:n}=await A.from("user_preferences").select("*").eq("user_id",e).maybeSingle();let s,a;if(n){const o=await A.from("user_preferences").update({...r,updated_at:new Date().toISOString()}).eq("user_id",e).select().single();s=o.data,a=o.error}else{const o=await A.from("user_preferences").insert({user_id:e,...r}).select().single();s=o.data,a=o.error}if(a)throw a;return{success:!0,message:"Preferences updated successfully!",data:s}}catch(n){return console.error("Error updating preferences:",n),{success:!1,message:"Failed to update preferences. Please try again."}}}}const Xv="https://uqofmsreosfjflmgurzb.supabase.co",Zv=`${Xv}/functions/v1/gemini-proxy`;class Za{static async fetchUserBookings(e){const{data:r,error:n}=await A.from("ride_bookings").select(`
        *,
        ride:rides(
          origin,
          destination,
          departure_time,
          driver:profiles!rides_driver_id_fkey(full_name)
        )
      `).eq("passenger_id",e).order("created_at",{ascending:!1});return n?(console.error("Error fetching bookings:",n),[]):r||[]}static async fetchUserOfferedRides(e){const{data:r,error:n}=await A.from("rides").select("*").eq("driver_id",e).order("departure_time",{ascending:!1});return n?(console.error("Error fetching rides:",n),[]):r||[]}static formatBookingContext(e){if(e.length===0)return"The user has no bookings yet.";const r=e.filter(o=>o.status==="pending"),n=e.filter(o=>o.status==="confirmed"),s=e.filter(o=>o.status==="cancelled");let a=`The user has ${e.length} total booking(s):

`;return r.length>0&&(a+=`PENDING REQUESTS (${r.length}):
`,r.forEach((o,l)=>{a+=`${l+1}. Booking ID: ${o.id}
`,a+=`   Route: ${o.ride.origin}  ${o.ride.destination}
`,a+=`   Pickup: ${o.pickup_location}
`,a+=`   Dropoff: ${o.dropoff_location}
`,a+=`   Seats: ${o.seats_requested}
`,a+=`   Driver: ${o.ride.driver.full_name}
`,a+=`   Departure: ${new Date(o.ride.departure_time).toLocaleString()}
`,a+=`   Requested: ${new Date(o.created_at).toLocaleString()}

`})),n.length>0&&(a+=`CONFIRMED BOOKINGS (${n.length}):
`,n.forEach((o,l)=>{a+=`${l+1}. Booking ID: ${o.id}
`,a+=`   Route: ${o.ride.origin}  ${o.ride.destination}
`,a+=`   Pickup: ${o.pickup_location}
`,a+=`   Dropoff: ${o.dropoff_location}
`,a+=`   Seats: ${o.seats_requested}
`,a+=`   Driver: ${o.ride.driver.full_name}
`,a+=`   Departure: ${new Date(o.ride.departure_time).toLocaleString()}

`})),s.length>0&&(a+=`CANCELLED BOOKINGS (${s.length}):
`,s.forEach((o,l)=>{a+=`${l+1}. Route: ${o.ride.origin}  ${o.ride.destination}
`,a+=`   Cancelled on: ${new Date(o.created_at).toLocaleString()}

`})),a}static formatRideContext(e){if(e.length===0)return"The user has not offered any rides yet.";const r=e.filter(a=>a.status==="active"&&new Date(a.departure_time)>new Date),n=e.filter(a=>new Date(a.departure_time)<=new Date);let s=`The user has offered ${e.length} ride(s):

`;return r.length>0&&(s+=`ACTIVE RIDES (${r.length}):
`,r.forEach((a,o)=>{s+=`${o+1}. Ride ID: ${a.id}
`,s+=`   Route: ${a.origin}  ${a.destination}
`,s+=`   Departure: ${new Date(a.departure_time).toLocaleString()}
`,s+=`   Available Seats: ${a.available_seats}

`})),n.length>0&&(s+=`PAST RIDES (${n.length}):
`,n.forEach((a,o)=>{s+=`${o+1}. ${a.origin}  ${a.destination} on ${new Date(a.departure_time).toLocaleDateString()}
`})),s}static getSystemPrompt(e,r,n,s){const a=new Date,o=a.toISOString().split("T")[0],l=a.toISOString(),c=n||s?`

REAL-TIME TRIP CONDITIONS:
${n||""}
${s||""}
`:"";return`You are a helpful AI assistant for a carpooling platform called Carpool Network (carpoolnetwork.co.uk). Your role is to help users manage their rides and bookings with real-time insights.

CURRENT DATE AND TIME: ${l} (${o})

CURRENT USER'S BOOKINGS:
${e}

CURRENT USER'S OFFERED RIDES:
${r}
${c}

Your capabilities:
1. Show users their current bookings and rides
2. Help users understand booking statuses (pending, confirmed, cancelled)
3. PERFORM ACTIONS: You can actually execute actions for users by responding with special action codes
4. POST RIDES: You can post rides if user provides: origin, destination, date/time, seats available
5. ADD VEHICLES: You can add vehicles if user provides: make, model, year, color, license plate, capacity
6. CANCEL bookings and rides
7. UPDATE user profile and preferences
8. Answer questions about the platform features
9. Explain platform policies and safety features
10. Provide real-time weather and traffic insights for trips
11. Suggest optimal departure times based on traffic patterns
12. Estimate trip costs and fuel consumption
13. Warn about adverse weather or air quality conditions

IMPORTANT - ACTION EXECUTION:
When a user asks you to perform an action, you can execute it by including a special action code in your response.
Available actions:

[ACTION:POST_RIDE:origin,originLat,originLng,destination,destinationLat,destinationLng,departureTime,availableSeats,notes] - Post a new ride
[ACTION:CANCEL_BOOKING:booking_id:reason] - Cancel a booking
[ACTION:CANCEL_RIDE:ride_id:reason] - Cancel a ride they're offering
[ACTION:UPDATE_PROFILE:field1=value1,field2=value2] - Update profile fields
[ACTION:UPDATE_PREFERENCES:field1=value1,field2=value2] - Update ride preferences
[ACTION:ADD_VEHICLE:make,model,year,color,license_plate,capacity,fuel_type,vehicle_type] - Add a vehicle

Examples:
- User: "Post a ride from London to Manchester tomorrow at 9am with 3 seats"  Include [ACTION:POST_RIDE:London,51.5074,-0.1278,Manchester,53.4808,-2.2426,2025-11-18T09:00:00,3,]
- User: "Cancel my booking abc-123"  Include [ACTION:CANCEL_BOOKING:abc-123:User requested] in response
- User: "Update my phone to 07123456789"  Include [ACTION:UPDATE_PROFILE:phone=07123456789]
- User: "Set my music preference to quiet"  Include [ACTION:UPDATE_PREFERENCES:music_preference=quiet]
- User: "Add my car, a 2020 red Toyota Corolla"  Include [ACTION:ADD_VEHICLE:Toyota,Corolla,2020,red,ABC123,4,petrol,sedan]

When including actions:
1. Put the action code on its own line
2. Explain what you're doing in natural language before/after the action
3. The action will be executed automatically
4. Always confirm what was done after the action
5. For POST_RIDE, you MUST get coordinates for origin and destination (use your knowledge or ask user for specific locations)
6. For POST_RIDE, dates should be in ISO 8601 format (YYYY-MM-DDTHH:mm:ss)
7. If user doesn't have a vehicle, inform them they need to add one first or suggest using ADD_VEHICLE action

When discussing trips:
- Consider weather conditions (temperature, rain, wind)
- Factor in traffic patterns and rush hours
- Provide cost estimates based on distance
- Suggest best departure times to avoid delays
- Warn about poor air quality or severe weather

When discussing cancellations:
- Pending requests can be cancelled anytime
- Confirmed bookings can be cancelled, but last-minute cancellations affect reliability score
- Be clear and helpful about the cancellation process

Important guidelines for POSTING RIDES:
- BEFORE posting a ride, you MUST collect ALL required information:
  * Origin location (city/town name)
  * Destination location (city/town name)
  * Departure date and time (be specific - "tomorrow 9am" needs to be converted to full ISO date)
  * Number of available seats
  * Optional: Notes about the trip
- You MUST use realistic coordinates for UK locations. Common examples:
  * London: 51.5074, -0.1278
  * Manchester: 53.4808, -2.2426
  * Birmingham: 52.4862, -1.8904
  * Leeds: 53.8008, -1.5491
  * Glasgow: 55.8642, -4.2518
  * Edinburgh: 55.9533, -3.1883
  * Liverpool: 53.4084, -2.9916
  * Bristol: 51.4545, -2.5879
- If user hasn't provided ALL information, ask for missing details
- ONLY execute POST_RIDE action when you have ALL required information
- Check if user has a vehicle first - if they don't, inform them to add one via Profile page or ask if they want you to add one
- Dates must be in future and in ISO format: YYYY-MM-DDTHH:mm:ss
- "Tomorrow at 9am" = calculate tomorrow's date + 09:00:00
- "Next Monday at 2pm" = calculate next Monday's date + 14:00:00

Important guidelines for general usage:
- Always use the booking/ride data provided above to give accurate, personalized responses
- Use real-time weather and traffic data when available
- If a user asks about trip conditions, provide detailed insights
- If a user wants to cancel, provide the booking ID and ask for confirmation
- Be conversational, friendly, and helpful
- Format responses clearly with proper spacing and bullet points when listing items
- Use proper date/time formatting when showing times
- Proactively mention weather warnings or traffic delays for upcoming trips
- When taking actions, be transparent about what you're doing
- NEVER claim to have done something unless you've included the action code

Remember: You can see their data AND real-time conditions, so be specific and reference actual booking IDs, routes, dates, weather, and traffic.`}static async chat(e,r,n,s,a){try{const{data:{session:o}}=await A.auth.getSession();if(!(o!=null&&o.access_token))return"Please sign in to use the AI assistant.";const[l,c]=await Promise.all([this.fetchUserBookings(n),this.fetchUserOfferedRides(n)]),u=this.formatBookingContext(l),h=this.formatRideContext(c),f=[{role:"user",parts:[{text:this.getSystemPrompt(u,h,s,a)}]},...r.map(_=>({role:_.role==="assistant"?"model":"user",parts:[{text:_.content}]})),{role:"user",parts:[{text:e}]}],x=await fetch(Zv,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.access_token}`},body:JSON.stringify({contents:f,model:"gemini-2.0-flash",generationConfig:{temperature:.7,topK:40,topP:.95,maxOutputTokens:1024}})});if(!x.ok){const _=await x.json().catch(()=>({}));if(console.error("Gemini proxy error:",x.status,_),x.status===401)return"Your session has expired. Please sign in again.";throw new Error(`API request failed: ${x.status}`)}const v=await x.json();if(!v.text)throw new Error("Invalid response format from Gemini proxy");return v.text}catch(o){return console.error("Error calling Gemini proxy:",o),"Sorry, I encountered an error processing your request. Please try again."}}static async cancelBooking(e,r,n){try{const{error:s}=await A.rpc("cancel_booking",{p_booking_id:e,p_reason:n||"Cancelled by passenger"});if(s){if(s.message.includes("already cancelled"))return{success:!1,message:"This booking is already cancelled."};if(s.message.includes("not found"))return{success:!1,message:"Booking not found or you do not have permission to cancel it."};throw s}return{success:!0,message:"Booking cancelled successfully."}}catch(s){return console.error("Error cancelling booking:",s),{success:!1,message:"An error occurred while cancelling. Please try again."}}}static async parseAndExecuteActions(e,r){const n=/\[ACTION:([A-Z_]+):([^\]]+)\]/g;let s=e,a=0;const o=[...e.matchAll(n)];for(const l of o){const[c,u,h]=l,d=h.split(":");try{let f;switch(u){case"CANCEL_BOOKING":{const[x,v]=d;f=await Br.cancelBooking(r,x,v);break}case"CANCEL_RIDE":{const[x,v]=d;f=await Br.cancelRide(r,x,v);break}case"UPDATE_PROFILE":{const x={};d[0].split(",").forEach(v=>{const[_,k]=v.split("=");x[_.trim()]=k.trim()}),f=await Br.updateProfile(r,x);break}case"UPDATE_PREFERENCES":{const x={};d[0].split(",").forEach(v=>{const[_,k]=v.split("=");let g=k.trim();g==="true"&&(g=!0),g==="false"&&(g=!1),isNaN(Number(g))||(g=Number(g)),x[_.trim()]=g}),f=await Br.updatePreferences(r,x);break}case"POST_RIDE":{const[x,v,_,k,g,p,m,y,E]=d[0].split(",");f=await Br.postRide(r,{origin:x.trim(),originLat:parseFloat(v.trim()),originLng:parseFloat(_.trim()),destination:k.trim(),destinationLat:parseFloat(g.trim()),destinationLng:parseFloat(p.trim()),departureTime:m.trim(),availableSeats:parseInt(y.trim()),notes:(E==null?void 0:E.trim())||void 0});break}case"ADD_VEHICLE":{const[x,v,_,k,g,p,m,y]=d[0].split(",");f=await Br.addVehicle(r,{make:x.trim(),model:v.trim(),year:parseInt(_.trim()),color:k.trim(),license_plate:g.trim(),capacity:parseInt(p.trim()),fuel_type:(m==null?void 0:m.trim())||void 0,vehicle_type:(y==null?void 0:y.trim())||void 0});break}default:console.log(`Unknown action type: ${u}`);continue}f&&(s=s.replace(c,`

 ${f.message}
`),a++)}catch(f){console.error(`Error executing action ${u}:`,f),s=s.replace(c,`

 Failed to execute action. Please try again.
`)}}return{modifiedResponse:s,actionsExecuted:a}}}function ew(){const{user:t}=Oe(),[e,r]=b.useState(!1),[n,s]=b.useState([{id:"1",role:"assistant",content:`Hi! I'm your AI assistant for Carpool Network. I can help you:

 View your bookings and rides
 Cancel bookings or rides
 Update your profile
 Change your preferences
 Answer any questions

Just tell me what you'd like to do!`,timestamp:new Date}]),[a,o]=b.useState(""),[l,c]=b.useState(!1),[u,h]=b.useState(null),[d,f]=b.useState(Date.now().toString()),x=b.useRef(null),v=dt(),_=()=>{var w;(w=x.current)==null||w.scrollIntoView({behavior:"smooth"})};b.useEffect(()=>{_()},[n]),b.useEffect(()=>{t&&e&&k()},[t,e]);const k=async()=>{if(t)try{const{data:w,error:N}=await A.from("ai_chat_history").select("*").eq("user_id",t.id).eq("session_id",d).order("created_at",{ascending:!0});if(N)throw N;if(w&&w.length>0){const C=w.map(T=>({id:T.id,role:T.role,content:T.message,timestamp:new Date(T.created_at)}));s(C)}}catch(w){console.error("Error loading chat history:",w)}},g=async w=>{if(t)try{await A.from("ai_chat_history").insert({user_id:t.id,message:w.content,role:w.role,session_id:d})}catch(N){console.error("Error saving chat message:",N)}},p=async()=>{if(t)try{await A.from("ai_chat_history").delete().eq("user_id",t.id).eq("session_id",d),s([{id:"1",role:"assistant",content:"Chat history cleared. How can I help you today?",timestamp:new Date}]),f(Date.now().toString())}catch(w){console.error("Error clearing chat history:",w)}},m=async w=>{if(!t){h("Please sign in to use the AI assistant.");return}const N=w||a.trim();if(!N)return;const C={id:Date.now().toString(),role:"user",content:N,timestamp:new Date};s(T=>[...T,C]),o(""),c(!0),h(null),await g(C);try{const T=n.map(O=>({role:O.role,content:O.content}));let S=await Za.chat(N,T,t.id);const{modifiedResponse:D,actionsExecuted:M}=await Za.parseAndExecuteActions(S,t.id);M>0&&(S=D);const j={id:(Date.now()+1).toString(),role:"assistant",content:S,timestamp:new Date};if(s(O=>[...O,j]),await g(j),S.includes("Booking ID:")){const O=S.match(/Booking ID: ([a-f0-9-]+)/i);if(O){const R=O[1];N.toLowerCase().includes("cancel")&&setTimeout(()=>{const P=`Would you like me to cancel booking ${R}? Reply "yes" to confirm.`,U={id:(Date.now()+2).toString(),role:"assistant",content:P,timestamp:new Date};s(I=>[...I,U])},500)}}if(N.toLowerCase()==="yes"&&n.length>0){const O=n[n.length-1];if(O.role==="assistant"&&O.content.includes("cancel booking")){const R=O.content.match(/booking ([a-f0-9-]+)/i);R&&await y(R[1])}}}catch(T){console.error("Error getting AI response:",T),h("Failed to get response. Please try again.")}finally{c(!1)}},y=async w=>{if(t){c(!0);try{const N=await Za.cancelBooking(w,t.id),C={id:Date.now().toString(),role:"assistant",content:N.message,timestamp:new Date};s(T=>[...T,C])}catch(N){console.error("Error cancelling booking:",N);const C={id:Date.now().toString(),role:"assistant",content:"Sorry, I encountered an error cancelling your booking. Please try again or visit the My Rides page.",timestamp:new Date};s(T=>[...T,C])}finally{c(!1)}}},E=[{label:"Show my bookings",action:()=>m("Show me all my current bookings")},{label:"View my rides",action:()=>m("Show me the rides I'm offering")},{label:"Find a ride",action:()=>{v("/find-rides"),r(!1)}}];return i.jsxs(i.Fragment,{children:[!e&&i.jsxs("button",{onClick:()=>r(!0),className:"fixed bottom-20 md:bottom-6 right-4 md:right-6 z-[100] p-4 bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-full shadow-2xl hover:shadow-blue-500/50 hover:scale-110 transition-all duration-300 group","aria-label":"Open chat",children:[i.jsx(fc,{className:"w-6 h-6"}),i.jsx("span",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-500 rounded-full border-2 border-white animate-pulse"})]}),e&&i.jsxs("div",{className:"fixed bottom-20 md:bottom-6 right-4 md:right-6 z-[100] w-96 max-w-[calc(100vw-2rem)] h-[600px] max-h-[calc(100vh-10rem)] md:max-h-[calc(100vh-2rem)] bg-white rounded-2xl shadow-2xl flex flex-col overflow-hidden border border-gray-200",children:[i.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:i.jsx(Xa,{className:"w-6 h-6"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold",children:"AI Assistant"}),i.jsx("p",{className:"text-xs text-blue-100",children:"Powered by Gemini"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:p,disabled:!t,className:"p-1 hover:bg-white/10 rounded-lg transition-colors disabled:opacity-50",title:"Clear chat history",children:i.jsx(up,{className:"w-5 h-5"})}),i.jsx("button",{onClick:()=>r(!1),className:"p-1 hover:bg-white/10 rounded-lg transition-colors",children:i.jsx(ci,{className:"w-5 h-5"})})]})]}),!t&&i.jsxs("div",{className:"p-4 bg-yellow-50 border-b border-yellow-100 flex items-start gap-2",children:[i.jsx(Ye,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),i.jsx("p",{className:"text-sm text-yellow-800",children:"Please sign in to use the AI assistant with your booking data."})]}),u&&i.jsxs("div",{className:"p-4 bg-red-50 border-b border-red-100 flex items-start gap-2",children:[i.jsx(Ye,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),i.jsx("p",{className:"text-sm text-red-800",children:u})]}),i.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[n.map(w=>i.jsxs("div",{className:`flex gap-2 ${w.role==="assistant"?"justify-start":"justify-end"}`,children:[w.role==="assistant"&&i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(Xa,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{className:`max-w-[75%] rounded-2xl px-4 py-2 ${w.role==="assistant"?"bg-white text-gray-900 shadow-sm":"bg-blue-600 text-white"}`,children:[i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:w.content}),i.jsx("span",{className:"text-xs opacity-60 mt-1 block",children:w.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),w.role==="user"&&i.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(dp,{className:"w-5 h-5 text-white"})})]},w.id)),l&&i.jsxs("div",{className:"flex gap-2 justify-start",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0",children:i.jsx(Xa,{className:"w-5 h-5 text-blue-600"})}),i.jsx("div",{className:"bg-white rounded-2xl px-4 py-3 shadow-sm",children:i.jsxs("div",{className:"flex gap-1",children:[i.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),i.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),i.jsx("span",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})})]}),i.jsx("div",{ref:x})]}),i.jsxs("div",{className:"p-4 bg-white border-t border-gray-200",children:[i.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:E.map((w,N)=>i.jsx("button",{onClick:w.action,disabled:!t,className:"px-3 py-1.5 bg-blue-50 text-blue-700 rounded-full text-xs font-medium hover:bg-blue-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:w.label},N))}),i.jsxs("form",{onSubmit:w=>{w.preventDefault(),m()},className:"flex gap-2",children:[i.jsx("input",{type:"text",value:a,onChange:w=>o(w.target.value),placeholder:"Ask about your bookings...",disabled:!t||l,className:"flex-1 px-4 py-2 border border-gray-300 rounded-full focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none text-sm disabled:bg-gray-100 disabled:cursor-not-allowed"}),i.jsx("button",{type:"submit",disabled:!a.trim()||!t||l,className:"p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i.jsx(cp,{className:"w-5 h-5"})})]})]})]})]})}function tw(){return i.jsxs("div",{className:"bg-orange-600 text-white text-center py-1 text-xs font-semibold tracking-wide fixed top-0 left-0 right-0 z-[100]",children:["DEVELOPMENT"," ENVIRONMENT ","- Local Data"]})}function Ut({children:t}){var a;const{profile:e,signOut:r}=Oe(),n=async()=>{await r()},s=[{to:"/",icon:Sv,label:"Home"},{to:"/find-rides",icon:pc,label:"Find Rides"},{to:"/post-ride",icon:Ov,label:"Post Ride"},{to:"/my-rides",icon:Ge,label:"My Rides"},{to:"/messages",icon:zi,label:"Messages"},{to:"/profile",icon:dp,label:"Profile"}];return i.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[i.jsx(tw,{}),i.jsx("header",{className:"bg-white border-b border-gray-200 sticky z-50 top-6",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center justify-between h-16",children:[i.jsx(mc,{size:"sm"}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"text-right hidden sm:block",children:[i.jsx("p",{className:"text-sm font-medium text-gray-900",children:e==null?void 0:e.full_name}),i.jsxs("p",{className:"text-xs text-gray-500",children:[" ",((a=e==null?void 0:e.average_rating)==null?void 0:a.toFixed(1))||"0.0"]})]}),i.jsx("button",{onClick:n,className:"p-2 text-gray-600 hover:text-red-600 transition-colors",title:"Sign Out",children:i.jsx(Pv,{className:"w-5 h-5"})})]})]})})}),i.jsxs("div",{className:"flex-1 flex",children:[i.jsx("nav",{className:"w-64 bg-white border-r border-gray-200 hidden md:block",children:i.jsx("div",{className:"p-4 space-y-1",children:s.map(o=>i.jsxs(Ru,{to:o.to,className:({isActive:l})=>`flex items-center gap-3 px-4 py-3 rounded-lg transition-colors ${l?"bg-blue-50 text-blue-600 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[i.jsx(o.icon,{className:"w-5 h-5"}),i.jsx("span",{children:o.label})]},o.to))})}),i.jsx("main",{className:"flex-1 overflow-y-auto",children:i.jsx("div",{className:"max-w-7xl mx-auto p-6 pb-28 md:pb-6",children:t})})]}),i.jsx(ew,{}),i.jsx("nav",{className:"md:hidden bg-white border-t border-gray-200 fixed bottom-0 left-0 right-0 z-50",children:i.jsx("div",{className:"grid grid-cols-6 gap-1 p-2",children:s.map(o=>i.jsxs(Ru,{to:o.to,className:({isActive:l})=>`flex flex-col items-center gap-1 py-2 rounded-lg transition-colors ${l?"text-blue-600":"text-gray-600"}`,children:[i.jsx(o.icon,{className:"w-5 h-5"}),i.jsx("span",{className:"text-xs",children:o.label})]},o.to))})})]})}const rw=Mi.isNativePlatform()?M0:U0;function Mt({children:t}){const{user:e,loading:r}=Oe();return r?i.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):e?i.jsx(i.Fragment,{children:t}):i.jsx(Of,{to:"/signin",replace:!0})}function ad({children:t}){const{user:e,loading:r}=Oe();return r?i.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):e?i.jsx(Of,{to:"/",replace:!0}):i.jsx(i.Fragment,{children:t})}function nw(){return i.jsx(rw,{children:i.jsxs(T0,{children:[i.jsx(Me,{path:"/signin",element:i.jsx(ad,{children:i.jsx(Dv,{})})}),i.jsx(Me,{path:"/signup",element:i.jsx(ad,{children:i.jsx(Uv,{})})}),i.jsx(Me,{path:"/",element:i.jsx(Mt,{children:i.jsx(Ut,{children:i.jsx(Mv,{})})})}),i.jsx(Me,{path:"/find-rides",element:i.jsx(Mt,{children:i.jsx(Ut,{children:i.jsx(Bv,{})})})}),i.jsx(Me,{path:"/post-ride",element:i.jsx(Mt,{children:i.jsx(Ut,{children:i.jsx(zv,{})})})}),i.jsx(Me,{path:"/my-rides",element:i.jsx(Mt,{children:i.jsx(Ut,{children:i.jsx(qv,{})})})}),i.jsx(Me,{path:"/messages",element:i.jsx(Mt,{children:i.jsx(Ut,{children:i.jsx(Vv,{})})})}),i.jsx(Me,{path:"/profile",element:i.jsx(Mt,{children:i.jsx(Ut,{children:i.jsx(Hv,{})})})}),i.jsx(Me,{path:"/rides/:rideId",element:i.jsx(Mt,{children:i.jsx(Ut,{children:i.jsx(Gv,{})})})}),i.jsx(Me,{path:"/bookings/:bookingId",element:i.jsx(Mt,{children:i.jsx(Ut,{children:i.jsx(Qv,{})})})}),i.jsx(Me,{path:"/terms",element:i.jsx(Jv,{})}),i.jsx(Me,{path:"/privacy",element:i.jsx(Yv,{})})]})})}function sw(){return i.jsx(xv,{children:i.jsx(wv,{children:i.jsx(nw,{})})})}wf(document.getElementById("root")).render(i.jsx(b.StrictMode,{children:i.jsx(sw,{})}));
